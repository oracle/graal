/**
 * @license
 * Copyright (c) 2014, 2020, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["ojs/ojcore","jquery","ojs/ojcontext","ojs/ojconfig","ojs/ojtranslation","ojs/ojthemeutils","ojs/ojcomponentcore","ojs/ojdatacollection-common","ojs/ojanimation","ojs/ojmessaging","ojs/ojlogger","ojs/ojkeyset","ojs/ojvalidator-regexp","ojs/ojdomscroller","ojdnd","ojs/ojeditablevalue","ojs/ojinputnumber","ojs/ojmenu","ojs/ojpopup","ojs/ojbutton","ojs/ojdatasource-common","ojs/ojdataprovideradapter","ojs/ojlistdataproviderview","touchr","ojs/ojselector"],function(e,t,o,n,i,l,s,a,r,_,d,h,u,c){"use strict";var S={properties:{accessibility:{type:"object",properties:{rowHeader:{type:"string"}}},as:{type:"string",value:""},columns:{type:"Array<Object>",writeback:!0},columnsDefault:{type:"object",properties:{className:{type:"string"},field:{type:"string"},footerClassName:{type:"string"},footerRenderer:{type:"function"},footerStyle:{type:"string"},footerTemplate:{type:"string"},headerClassName:{type:"string"},headerRenderer:{type:"function"},headerStyle:{type:"string"},headerTemplate:{type:"string"},headerText:{type:"string"},renderer:{type:"function"},resizable:{type:"string",enumValues:["disabled","enabled"],value:"disabled"},sortProperty:{type:"string"},sortable:{type:"string",enumValues:["auto","disabled","enabled"],value:"auto"},style:{type:"string"},template:{type:"string"},width:{type:"number"}}},currentRow:{type:"object",writeback:!0},data:{type:"object"},display:{type:"string",enumValues:["grid","list"],value:"list"},dnd:{type:"object",properties:{drag:{type:"object",properties:{rows:{type:"object",properties:{dataTypes:{type:"string|Array<string>"},dragStart:{type:"function"},drag:{type:"function"},dragEnd:{type:"function"}}}}},drop:{type:"object",properties:{columns:{type:"object",properties:{dataTypes:{type:"string|Array<string>"},dragEnter:{type:"function"},dragOver:{type:"function"},dragLeave:{type:"function"},drop:{type:"function"}}},rows:{type:"object",properties:{dataTypes:{type:"string|Array<string>"},dragEnter:{type:"function"},dragOver:{type:"function"},dragLeave:{type:"function"},drop:{type:"function"}}}}},reorder:{type:"object",properties:{columns:{type:"string",enumValues:["disabled","enabled"],value:"disabled"}}}}},editMode:{type:"string",enumValues:["none","rowEdit"],value:"none"},editRow:{type:"object",writeback:!0,value:{rowKey:null,rowIndex:-1}},firstSelectedRow:{type:"object",writeback:!0,readOnly:!0,value:{key:null,data:null},properties:{key:{type:"any"},data:{type:"any"}}},horizontalGridVisible:{type:"string",enumValues:["auto","disabled","enabled"],value:"auto"},rowRenderer:{type:"function"},scrollPolicy:{type:"string",enumValues:["auto","loadAll","loadMoreOnScroll"],value:"auto"},scrollPolicyOptions:{type:"object",properties:{fetchSize:{type:"number",value:25},maxCount:{type:"number",value:500}}},scrollPosition:{type:"object",writeback:!0,value:{x:0,y:0},properties:{x:{type:"number"},y:{type:"number"},columnIndex:{type:"number"},rowIndex:{type:"number"},columnKey:{type:"any"},rowKey:{type:"any"},offsetX:{type:"number"},offsetY:{type:"number"}}},selected:{type:"object",writeback:!0,properties:{column:{type:"KeySet",writeback:!0},row:{type:"KeySet",writeback:!0}}},selection:{type:"Array<Object>",writeback:!0,value:[]},selectionMode:{type:"Object<string, string>",properties:{column:{type:"string",enumValues:["multiple","none","single"]},row:{type:"string",enumValues:["multiple","none","single"]}}},selectionRequired:{type:"boolean",value:!1},translations:{type:"object",value:{},properties:{accessibleColumnContext:{type:"string"},accessibleColumnHeaderContext:{type:"string"},accessibleRowContext:{type:"string"},accessibleSortAscending:{type:"string"},accessibleSortDescending:{type:"string"},accessibleStateSelected:{type:"string"},labelAccSelectionAffordanceBottom:{type:"string"},labelAccSelectionAffordanceTop:{type:"string"},labelDisableNonContiguousSelection:{type:"string"},labelEditRow:{type:"string"},labelEnableNonContiguousSelection:{type:"string"},labelResize:{type:"string"},labelResizePopupCancel:{type:"string"},labelResizePopupSpinner:{type:"string"},labelResizePopupSubmit:{type:"string"},labelSelectAndEditRow:{type:"string"},labelSelectColum:{type:"string"},labelSelectRow:{type:"string"},labelSort:{type:"string"},labelSortAsc:{type:"string"},labelSortDsc:{type:"string"},msgColumnResizeWidthValidation:{type:"string"},msgFetchingData:{type:"string"},msgInitializing:{type:"string"},msgNoData:{type:"string"},msgScrollPolicyMaxCountDetail:{type:"string"},msgScrollPolicyMaxCountSummary:{type:"string"},msgStatusSortAscending:{type:"string"},msgStatusSortDescending:{type:"string"}}},verticalGridVisible:{type:"string",enumValues:["auto","disabled","enabled"],value:"auto"}},methods:{getContextByNode:{},getDataForVisibleRow:{},refresh:{},refreshRow:{},setProperty:{},getProperty:{},setProperties:{},getNodeBySubId:{},getSubIdByNode:{}},events:{ojAnimateStart:{},ojAnimateEnd:{},ojBeforeCurrentRow:{},ojBeforeRowEdit:{},ojBeforeRowEditEnd:{},ojRowAction:{},ojSort:{}},extension:{}},C=function(){this._cacheDomDimensions={}};C._BUNDLE_KEY={_MSG_FETCHING_DATA:"msgFetchingData",_MSG_NO_DATA:"msgNoData",_MSG_INITIALIZING:"msgInitializing",_MSG_STATUS_SORT_ASC:"msgStatusSortAscending",_MSG_STATUS_SORT_DSC:"msgStatusSortDescending",_LABEL_SELECT_COLUMN:"labelSelectColumn",_LABEL_SELECT_ROW:"labelSelectRow",_LABEL_EDIT_ROW:"labelEditRow",_LABEL_SELECT_AND_EDIT_ROW:"labelSelectAndEditRow"},C._LOGGER_MSG={_ERR_PRECURRENTROW_ERROR_SUMMARY:"Did not change current row due to error.",_ERR_PRECURRENTROW_ERROR_DETAIL:"Error detail: {error}.",_ERR_CURRENTROW_UNAVAILABLE_INDEX_SUMMARY:"Did not change current row due to unavailable row index.",_ERR_CURRENTROW_UNAVAILABLE_INDEX_DETAIL:"Unavailable row index: {rowIdx}.",_ERR_REFRESHROW_INVALID_INDEX_SUMMARY:"Invalid row index value.",_ERR_REFRESHROW_INVALID_INDEX_DETAIL:"Row index: {rowIdx}.",_ERR_DATA_INVALID_TYPE_SUMMARY:"Invalid data type.",_ERR_DATA_INVALID_TYPE_DETAIL:"Please specify the appropriate data type.",_ERR_ELEMENT_INVALID_TYPE_SUMMARY:"Invalid element type.",_ERR_ELEMENT_INVALID_TYPE_DETAIL:"Only a <table> element can be specified for ojTable.",_ERR_WIDTH_INVALID_TYPE_SUMMARY:"Invalid data type for column width.",_ERR_WIDTH_INVALID_TYPE_DETAIL:"Please specify a valid number (not a string)."},C._FIELD_ID="id",C._CONST_ATTRIBUTE="attribute",C._CONST_DATA="data",C._CONST_METADATA="metadata",C._CONST_INDEXES="indexes",C._CONST_INDEX="index",C._CONST_KEY="key",C._CONST_KEYS="keys",C._CONST_AFTERKEYS="afterKeys",C._CONST_ADDBEFOREKEYS="addBeforeKeys",C._CONST_CLIENTID="clientId",C._CONST_STARTINDEX="startIndex",C._CONST_ENDINDEX="endIndex",C._CONST_PAGESIZE="size",C._CONST_OFFSET="offset",C._CONST_SILENT="silent",C._CONST_COLUMN="column",C._CONST_ROW="row",C._CONST_VALUE="value",C._CONST_SORTCRITERIA="sortCriteria",C._COLUMN_HEADER_ID="_headerColumn",C._COLUMN_HEADER_TEXT_ID="_headerColumnText",C._COLUMN_HEADER_ASC_ID="_headerColumnAsc",C._COLUMN_HEADER_DSC_ID="_headerColumnDsc",C._COLUMN_HEADER_ID_PREFIX="_hdrCol",C._COLUMN_HEADER_ROW_SELECT_ID="_hdrColRowSel",C._FOCUS_CALLED="_focusedCalled",C._ROW_TEMPLATE="rowTemplate",C._CELL_TEMPLATE="template",C._HEADER_TEMPLATE="headerTemplate",C._FOOTER_TEMPLATE="footerTemplate",C._OPTION_AUTO="auto",C._OPTION_ENABLED="enabled",C._OPTION_DISABLED="disabled",C._OPTION_DISPLAY={_LIST:"list",_GRID:"grid"},C._OPTION_EDIT_MODE={_NONE:"none",_ROW_EDIT:"rowEdit"},C._OPTION_SELECTION_MODES={_SINGLE:"single",_MULTIPLE:"multiple",_NONE:"none"},C._OPTION_SCROLL_POLICY={_AUTO:"auto",_LOADMORE_ON_SCROLL:"loadMoreOnScroll",_LOAD_ALL:"loadAll"},C._COLUMN_SORT_ORDER={_ASCENDING:"ascending",_DESCENDING:"descending"},C._DND_REORDER_TABLE_ID_DATA_KEY="oj-table-dnd-reorder-table-id",C._CURRENT_ROW_STATUS={_UPDATED:"updated",_IGNORED:"ignored",_VETOED:"vetoed",_ERROR:"error"},C._BATCH_PROCESS_SIZE_WHEN_IDLE=5,C.prototype._isNodeEditable=function(e){return this._isNodeType(e,/^INPUT|TEXTAREA/)},C.prototype._isNodeClickable=function(e){return this._isNodeType(e,/SELECT|OPTION|BUTTON|^A\b/)},C.prototype._isNodeDraggable=function(e){return null!=this._getFirstAncestor(e,"[draggable='true']",!0)},C.prototype._isNodeType=function(e,t){for(var o=this._getTable();null!=e&&e!==o;){var n=e.nodeName;if(n===C.DOM_ELEMENT._TD||n===C.DOM_ELEMENT._TH)break;if(3!==e.nodeType)if(n.match(t))if(-1!==e.getAttribute(C.DOM_ATTR._TABINDEX))return!0;e=e.parentNode}return!1},C.prototype._handleDataFetchStart=function(){this._setDataWaitingState()},C.prototype._setDataWaitingState=function(e){!1!==e&&(this._showStatusMessage(),this._hideNoDataMessage()),this._dataFetching=!0,this._dataResolveFunc||(this._dataResolveFunc=this._addComponentBusyState("is waiting for data."))},C.prototype._clearDataWaitingState=function(){this._pendingFetchStale?(this._pendingFetchStale=!1,this._queueTask(function(){return this._beforeDataRefresh(),this._invokeDataFetchRows()}.bind(this))):(this._hideStatusMessage(),this._dataFetching=!1,this._pendingFetchStale=!1,this._dataResolveFunc&&(this._dataResolveFunc(),this._dataResolveFunc=null))},C.prototype._setComponentNotReady=function(){this._readyResolveFunc||(this._readyResolveFunc=this._addComponentBusyState("is being loaded."))},C.prototype._setComponentReady=function(){this._readyResolveFunc&&(this._readyResolveFunc(),this._readyResolveFunc=null)},C.prototype._addComponentBusyState=function(e){var t=o.getContext(this.element[0]).getBusyContext(),n={description:"The component identified by '"+this._getTableId()+"' "+e};return t.addBusyState(n)},C.prototype._createComponentBusyState=function(e){var t=this._addComponentBusyState(e);return null==this._busyStateStack&&(this._busyStateStack=[]),this._busyStateStack.push(t),t},C.prototype._clearComponentBusyState=function(e){if(e(),this._busyStateStack){var t=this._busyStateStack.indexOf(e);-1!==t&&this._busyStateStack.splice(t,1)}},C.prototype._clearBusyStateStack=function(){if(this._busyStateStack){for(var e=0;e<this._busyStateStack.length;e++)this._busyStateStack[e]();this._busyStateStack=null}},C.prototype._setDelayRefreshTableDimensionsBusyState=function(){this._delayRefreshTableDimensionsResolveFunc||(this._delayRefreshTableDimensionsResolveFunc=this._addComponentBusyState("is waiting to refresh dimensions."))},C.prototype._clearDelayRefreshTableDimensionsBusyState=function(){this._delayRefreshTableDimensionsResolveFunc&&(this._delayRefreshTableDimensionsResolveFunc(),this._delayRefreshTableDimensionsResolveFunc=null)},C.prototype._setFocusoutBusyState=function(){this._focusoutResolveFunc||(this._focusoutResolveFunc=this._addComponentBusyState("is handling focusout."))},C.prototype._clearFocusoutBusyState=function(){this._focusoutResolveFunc&&(this._focusoutResolveFunc(),this._focusoutResolveFunc=null)},C.prototype._setIdleRenderBusyState=function(){this._idleRenderResolveFunc||(this._idleRenderResolveFunc=this._addComponentBusyState("is waiting for idle rendering."))},C.prototype._clearIdleRenderBusyState=function(){this._idleRenderResolveFunc&&(this._idleRenderResolveFunc(),this._idleRenderResolveFunc=null)},C.prototype._setScrollPosBusyState=function(){this._scrollPosResolveFunc||(this._scrollPosResolveFunc=this._addComponentBusyState("is handling scroll position."))},C.prototype._clearScrollPosBusyState=function(){this._scrollPosResolveFunc&&(this._scrollPosResolveFunc(),this._scrollPosResolveFunc=null)},C.prototype._clearAllComponentBusyStates=function(){this._clearBusyStateStack(),this._pendingFetchStale=!1,this._clearDataWaitingState(),this._clearDelayRefreshTableDimensionsBusyState(),this._clearFocusoutBusyState(),this._clearIdleRenderBusyState(),this._clearScrollPosBusyState(),this._setComponentReady()},C.prototype._cleanComponent=function(o){this._clearAllComponentTimeouts(),this._clearAllComponentBusyStates(),this._clearIdleCallback(),this._unregisterDomScroller(),o?(t(this._getTableBody()).removeAttr(s._OJ_CONTAINER_ATTR),this.element.children().remove("."+C.CSS_CLASSES._TABLE_HEADER_CLASS),this.element.children().remove("."+C.CSS_CLASSES._TABLE_BODY_CLASS),this.element.children().remove("."+C.CSS_CLASSES._TABLE_FOOTER_CLASS),this.element.children().remove("."+C.CSS_CLASSES._TABLE_STATUS_MESSAGE_CLASS),this.element.children().remove("."+C.CSS_CLASSES._TABLE_BODY_MESSAGE_ROW_CLASS),e.DomUtils.unwrap(this.element,t(this._getTableContainer())),this.element[0].classList.remove(C.CSS_CLASSES._TABLE_CLASS),this._data instanceof e.TableDataSourceAdapter&&this._data.destroy(),(this._hasHeaderTemplate||this._hasCellTemplate||this._hasFooterTemplate||this._hasRowTemplate)&&this._cleanTemplateNodes(this.element[0]),this._componentDestroyed=!0):(this._unregisterDataSourceEventListeners(),this._unregisterResizeListener())},C.prototype._clearAllComponentTimeouts=function(){this._clearFocusoutTimeout(),this._clearShowStatusTimeout()},C.prototype._clearFocusoutTimeout=function(){this._focusoutTimeout&&(clearTimeout(this._focusoutTimeout),this._focusoutTimeout=null)},C.prototype._clearShowStatusTimeout=function(){this._showStatusTimeout&&(clearTimeout(this._showStatusTimeout),this._showStatusTimeout=null)},C.prototype._setFinalTask=function(e){this._finalTask=e?e.bind(this):void 0},C.prototype._hasPendingTasks=function(){return this._taskCount>1},C.prototype._queueTask=function(e){return this._pendingTasks||(this._taskCount=0,this._pendingTasks=Promise.resolve(),this._setComponentNotReady()),this._taskCount+=1,this._pendingTasks=this._pendingTasks.then(function(){if(!this._componentDestroyed)return e.bind(this)()}.bind(this)).then(function(e){if(this._taskCount-=1,0===this._taskCount){this._pendingTasks=void 0;try{this._componentDestroyed||(this._finalTask&&this._finalTask(),this._trigger("ready"))}catch(e){d.error(e)}this._setComponentReady()}return e}.bind(this),function(e){return this._taskCount-=1,0===this._taskCount&&(this._pendingTasks=void 0,d.error(e),this._setComponentReady()),Promise.reject(e)}.bind(this)),this._pendingTasks},C.prototype._draw=function(){if(this._setFinalTask(function(){this._skipRefreshTableDimension&&this._tableDimensionsInitialized||this._syncTableSizing(),this._initialSelectionStateValidated?this._syncSelectionState():this._validateInitialSelectionState(),this._skipRefreshTableDimension=!1}.bind(this)),!this.element.is("table")){var e=C._LOGGER_MSG._ERR_ELEMENT_INVALID_TYPE_SUMMARY,t=C._LOGGER_MSG._ERR_ELEMENT_INVALID_TYPE_DETAIL;throw new RangeError(e+"\n"+t)}this.element[0].classList.add(C.CSS_CLASSES._TABLE_ELEMENT_CLASS),this.element[0].setAttribute(C.DOM_ATTR._ROLE,"application"),this._createInitialTable(this._isTableHeaderless(),this._isTableFooterless()),this._styleInitialTable(),this._queueTask(function(){this._refreshTableHeader(),this._refreshTableFooter(),this._refreshTableBody(),this._processSlottedChildren()}.bind(this)),this.options.disabled&&this.disable()},C.prototype._refresh=function(){var e=!1;this._dataOption!==this.options[C._CONST_DATA]&&(this._clearCachedDataMetadata(),null==this._data&&(e=!0));var t=this._GetContextMenu();return null!=t&&t!==this._getContextMenuElement()&&this._createContextMenu(this._handleContextMenuSelect.bind(this)),this._clearCachedDom(),this._refreshContextMenu(),this._refreshTableStatusMessage(),this._clearIdleCallback(),e?this._initFetch():this._queueTask(function(){return this._invokeDataFetchRows()}.bind(this))},C.prototype._refreshAll=function(t,o){var n=[];if((this._isColumnMetadataUpdated()||!this._isTableHeaderColumnsRendered()&&!this._isTableHeaderless())&&(this._clearCachedMetadata(),n.push(this._refreshTableHeader()),null!=this._sortColumn)){var i=!1,l=this._getColumnDefs();if(null!=l){for(var s=l.length,a=0;a<s;a++){var r=l[a];if(e.Object.compareValues(r,this._sortColumn)){i=!0;break}}i||this._initFetch(null,!0)}}return n.push(this._refreshTableFooter()),n.push(this._refreshTableBody(t,o)),Promise.all(n)},C.prototype._refreshTableHeader=function(){var e=this,o=this._getColumnDefs(),n=this._getTableHeader();if(!n){if(this._isTableHeaderless())return Promise.resolve();n=this._createTableHeader(),this._styleTableHeader(n)}var i=this._getTableHeaderRow();if(this._unregisterChildStateListeners(i),this._hasHeaderTemplate&&(this._cleanTemplateNodes(i),this._hasHeaderTemplate=!1),t(i).empty(),o&&o.length>0){if(this._isDefaultSelectorEnabled()){var l=this._createTableHeaderSelectorColumn();i.appendChild(l)}for(var s=this._isDefaultHeaderTemplateSlotValid(),a=o.length,r=0;r<a;r++){var _=o[r],d=this._getColumnRenderer(r,"header"),h=this._createTableHeaderColumn(r);if(d){var u=this._getRendererContextObject(h,{}),c={headerContext:u,columnIndex:r,data:_.headerText,componentElement:u.componentElement,parentElement:u.parentElement};_.sortable===C._OPTION_ENABLED?c.columnHeaderSortableIconRenderer=function(t,o){e._columnHeaderSortableIconRenderer(this,o)}:c.columnHeaderDefaultRenderer=function(t,o){e._columnHeaderDefaultRenderer(this,o)};var S=d(c);null!=S?(t(h).empty(),t(h).append(S)):(h=t(i).children()[r],this._setTableHeaderColumnAttributes(r,h),this._styleTableHeaderColumn(r,h,!1))}else{var E=this._getSlotTemplate(_[C._HEADER_TEMPLATE]);if(null==E&&s&&(E=this._getSlotTemplate("headerTemplate")),E){var T=this._getRootElement(),p=this._getTemplateEngine();if(null!=p){h&&t(h).empty();var g=this._getHeaderSlotTemplateContextObject(_.headerText,r),f=p.execute(T,E,g,this.options.as);f instanceof Array||(f=[f]),f.map(function(e){h.appendChild(e)}),this._hasHeaderTemplate=!0}}}}this._renderedTableHeaderColumns=!0}return this._finalizeRowRendering([i])},C.prototype._refreshTableFooter=function(){var e=this._getColumnDefs(),o=this._getTableFooter();if(!o){if(this._isTableFooterless())return Promise.resolve();o=this._createTableFooter(),this._styleTableFooter(o)}o.style[C.CSS_PROP._VISIBILITY]=C.CSS_VAL._HIDDEN;var n=this._getTableFooterRow();if(this._hasFooterTemplate&&(this._cleanTemplateNodes(n),this._hasFooterTemplate=!1),t(n).empty(),e&&e.length>0){for(var i=this._isDefaultFooterTemplateSlotValid(),l=e.length,s=0;s<l;s++){var a=e[s],r=this._getColumnRenderer(s,"footer"),_=this._createTableFooterCell();if(this._styleTableFooterCell(s,_),this._insertTableFooterCell(s,_),r){var d=this._getRendererContextObject(_,{}),h=r({footerContext:d,columnIndex:s,componentElement:d.componentElement,parentElement:d.parentElement});null!=h?(t(_).empty(),t(_).append(h)):(_=t(n).children()[s],this._styleTableFooterCell(s,_))}else{var u=this._getSlotTemplate(a[C._FOOTER_TEMPLATE]);if(null==u&&i&&(u=this._getSlotTemplate("footerTemplate")),u){var c=this._getRootElement(),S=this._getTemplateEngine();if(null!=S){var E=this._getSlotTemplateContextObject(),T=S.execute(c,u,E,this.options.as);T instanceof Array||(T=[T]),T.map(function(e){_.appendChild(e)}),this._hasFooterTemplate=!0}}}}if(this._isDefaultSelectorEnabled()){var p=this._createTableFooterCell();n.insertBefore(p,n.firstChild)}}return this._finalizeRowRendering([n])},C.prototype._refreshTableBody=function(e,o){var n=this._getTableBody();if(null==n)return Promise.resolve();var i,l,s,a=this._getRowIdxRowArray(e,o),r=t.contains(n,document.activeElement),_=!1;if(this._scrollLeft=void 0===this._scrollLeft?0:this._scrollLeft,this._scrollTop=void 0===this._scrollTop?0:this._scrollTop,0===o)r&&(_=!0),this._removeAllTableBodyRows();else if((i=this._getTableBodyRows()).length>0)for(s=i.length-1;s>=o;s--)r&&null!=(l=this._getTableBodyRow(s))&&t.contains(l,document.activeElement)&&(_=!0,r=!1),this._removeTableBodyRow(s);if(_&&this._getTable().focus(),this._clearCachedDomRowData(),this._hideNoDataMessage(),i=n.children,0!==a.length||0!==i.length){var d;if(o>0&&this._isOverflow()&&!this._fetchBySyncScroll)return new Promise(function(t,i){this._setIdleRenderBusyState(),this._renderRowsWhenIdle(a.slice(0),n,o,t,i,e.isMouseWheel)}.bind(this));n.style[C.CSS_PROP._VISIBILITY]=C.CSS_VAL._HIDDEN,this._cacheDomDimensions={},this._skipRefreshTableDimension=!1,d=document.createDocumentFragment();var h=a.length;for(s=0;s<h;s++)this._renderRow(a[s],d,o);return n.appendChild(d),this._afterRowsRendered(n)}return this._showNoDataMessage(),Promise.resolve()},C.prototype._isDefaultSelectorEnabled=function(){return null==this._defaultOptions&&(this._defaultOptions=l.parseJSONFromFontFamily("oj-table-option-defaults")),!0===this._defaultOptions.enableSelector&&this._getRowSelectionMode()===C._OPTION_SELECTION_MODES._MULTIPLE},C.prototype._refreshTableBodyRow=function(e,o,n,i,l){var s=this._getRowRenderer(),a=this._getTableBody();(isNaN(e)||e<0)&&d.error("Error: Invalid rowIdx value: "+e);var r=this._hashCode(o[C._CONST_KEY]);if(null==n){if(!(n=this._getTableBodyRow(e)))return null;(this._hasCellTemplate||this._hasRowTemplate)&&this._cleanTemplateNodes(n),t(n).empty()}this._hideNoDataMessage();var _=this._getCurrentRow();_=_||{};var h=this._getRendererContextObject(n,{row:o,isCurrentRow:_.rowIndex===e}),u={rowContext:h,row:o[C._CONST_DATA],componentElement:h.componentElement,parentElement:h.parentElement,data:o[C._CONST_DATA]};if(null!=s||this._isDefaultRowTemplateSlotValid()&&null!==this._getSlotTemplate("rowTemplate")){if(null!=s){var c=s(u);null!=c?n.appendChild(c):null==i?n=a.children[e]:(l=null==l?0:l,n=i.children?i.children[e-l]:t(i).children()[e-l])}else{var S=this._getSlotTemplate("rowTemplate"),E=this._getRootElement(),T=this._getTemplateEngine();if(null!=T){var p=this._getRowSlotTemplateContextObject(u),g=T.execute(E,S,p,this.options.as);for(let e=0;e<g.length;e++){if("TR"===g[e].tagName){n.parentNode.replaceChild(g[e],n);break}n.appendChild(g[e])}null==i?n=a.children[e]:(l=null==l?0:l,n=i.children?i.children[e-l]:t(i).children()[e-l]),this._hasRowTemplate=!0}}this._clearCachedDomRowData(),this._setTableBodyRowAttributes(o,n),this._styleTableBodyRow(n,!1);var f,m=this._getTableElementsByTagName(n,C.DOM_ELEMENT._TD),A=m.length;for(let t=0;t<A;t++)f=m[t],this._setTableBodyCellAttributes(e,o[C._CONST_KEY],r,t,f),this._styleTableBodyCell(t,f,!1);if(null!=this._columnsDestMap)for(let e=0;e<this._columnsDestMap.length;e++)if(this._columnsDestMap[e]>e){var R=m[this._columnsDestMap[e]],b=m[e];R.parentNode.insertBefore(R,b),m=this._getTableElementsByTagName(n,C.DOM_ELEMENT._TD)}this._isDefaultSelectorEnabled()&&this._createTableBodyDefaultSelector(o.key,n)}else this._isDefaultSelectorEnabled()&&this._createTableBodyDefaultSelector(o.key,n),this._tableBodyRowDefaultRenderer(e,o,u);return this._hasEditableRow()&&this._getEditableRowIdx()===e?n.classList.add(C.CSS_CLASSES._TABLE_DATA_ROW_EDIT_CLASS):n.classList.remove(C.CSS_CLASSES._TABLE_DATA_ROW_EDIT_CLASS),n},C.prototype._finalizeBodyRowRendering=function(t){return this._waitForAllBodyElementsToResolve(t).then(function(){var o=this._hasEditableRow()?this._getEditableRowKey():null;return t.forEach(function(t){var n=this._getRowKey(t);null!=o&&e.KeyUtils.equals(n,o)||a.disableAllFocusableElements(t)}.bind(this)),Promise.resolve(!0)}.bind(this))},C.prototype._finalizeRowRendering=function(e){return this._waitForAllElementsToResolve(e).then(function(){return e.forEach(function(e){a.disableAllFocusableElements(e)}),Promise.resolve(!0)})},C.prototype._waitForAllBodyElementsToResolve=function(e){return e.length>0&&this._hasRowOrCellRendererOrTemplate()?this._waitForAllElementsToResolve(e):Promise.resolve()},C.prototype._waitForAllElementsToResolve=function(e){var t=[];return e.forEach(function(e){e&&t.push(o.getContext(e).getBusyContext().whenReady())}),Promise.all(t)},C.prototype._refreshRow=function(e,o){var n=this._getData();if(!n)return Promise.resolve(!1);var l=this._getTableBodyRows();if(isNaN(e)||e<0||e>=l.length||0===l.length){var s=C._LOGGER_MSG._ERR_REFRESHROW_INVALID_INDEX_SUMMARY,a=i.applyParameters(C._LOGGER_MSG._ERR_REFRESHROW_INVALID_INDEX_DETAIL,{rowIdx:e.toString()});throw new RangeError(s+"\n"+a)}var r=this._getRowKeyForRowIdx(e);return this._queueTask(function(){return n.fetchByKeys({keys:new Set([r])}).then(function(n){if(null==n||null==n.results||0===n.results.size)return Promise.resolve(!1);var i=this._getTableBodyRow(e);o=o&&t.contains(i,document.activeElement);var l=n.results.get(r);return this._refreshTableBodyRow(e,{data:l.data,metadata:l.metadata,index:e,key:r}),o&&this._getTable().focus(),(i=this._getTableBodyRow(e))?this._finalizeBodyRowRendering([i]):Promise.resolve(!0)}.bind(this))}.bind(this))},C.prototype._refreshTableStatusMessage=function(){var e=this._getTableStatusMessage();null!=e&&t(e).remove(),this._createTableStatusMessage()},C.prototype._showStatusMessage=function(){this._showStatusTimeout||this._statusMessageShown||this._tempSkeletonRow||(this._showStatusTimeout=setTimeout(function(){this._refreshTableStatusPosition(!0),this._showStatusTimeout=null}.bind(this),this._getShowStatusDelay()),this._isSkeletonSupport()&&this._removeAllTableBodyRows())},C.prototype._showProgressiveLoading=function(){if(this._isSkeletonSupport()){var e=this._getTableBodyRows();if(null!=e&&e.length>0&&!this._tempSkeletonRow){this._tempSkeletonRow=this._createTableBodyRow();var t=this._createTableBodyCell();t.colSpan=this._getColumnDefs().length;for(var o=0;o<3;o++)t.appendChild(this._createSkeletonRow());this._tempSkeletonRow.appendChild(t),this._getTableBody().appendChild(this._tempSkeletonRow),this._skeletonHWMSFadeInEndListener=function(){this._tempSkeletonRow.classList.remove("oj-animation-skeleton-fade-in"),this._tempSkeletonRow.querySelectorAll(".oj-table-skeleton-row").forEach(function(e){e.classList.add("oj-animation-skeleton")}),this._tempSkeletonRow.removeEventListener("animationend",this._skeletonHWMSFadeInEndListener)}.bind(this),this._tempSkeletonRow.addEventListener("animationend",this._skeletonHWMSFadeInEndListener),this._tempSkeletonRow.classList.add("oj-animation-skeleton-fade-in")}}},C.prototype._hideStatusMessage=function(){if(this._clearShowStatusTimeout(),this._statusMessageShown||this._tempSkeletonRow){var e=this._getTableStatusMessage();if(e.style[C.CSS_PROP._DISPLAY]=C.CSS_VAL._NONE,this._isSkeletonSupport())if(null!=this._tempSkeletonRow)this._getTableBody().removeChild(this._tempSkeletonRow),this._tempSkeletonRow=null;else for(var t=e.childNodes,o=t.length;o>0;o--)e.removeChild(t[o-1]);this._statusMessageShown=!1}},C.prototype._isStatusMessageShown=function(){return this._statusMessageShown},C.prototype._getDefaultOptions=function(){return null==this._defaultOptions&&(this._defaultOptions=l.parseJSONFromFontFamily("oj-table-option-defaults")||{}),this._defaultOptions},C.prototype._getShowStatusDelay=function(){var e=parseInt(this._getDefaultOptions().showIndicatorDelay,10);return isNaN(e)?0:e},C.prototype._isSkeletonSupport=function(){return"skeleton"===this._getDefaultOptions().loadIndicator},C.prototype._showNoDataMessage=function(){if(!this._noDataMessageShown){var e=this._getTableBodyMessageRow(),t=this._getData(),o=this._getSlotTemplate("noData");if(this._isDefaultTemplateSlotValid("noData")&&null!==o){var n=this._getTable(),i=this._getTableBody();n.classList.add(C.CSS_CLASSES._TABLE_NO_DATA_CONTAINER_CLASS);var l=document.createElement(C.DOM_ELEMENT._TR);l.classList.add(C.CSS_CLASSES._TABLE_NO_DATA_CONTAINER_CLASS),this._getTableContainer().classList.contains(C.CSS_CLASSES._TABLE_SCROLL_VERTICAL_CLASS)&&l.classList.add(C.CSS_CLASSES._TABLE_NO_DATA_ROW_CLASS),i.appendChild(l);var s=document.createElement(C.DOM_ELEMENT._TD),a=this._getColumnDefs().length;this._isDefaultSelectorEnabled()&&(a+=1),s.setAttribute(C.DOM_ATTR._COLSPAN,a),l.appendChild(s);var r=this._getTemplateEngine();if(null!=r)r.execute(this._getRootElement(),o,{},null).forEach(function(e){s.appendChild(e)})}else{var _=null;_=null!=this.options.emptyText?this.options.emptyText:this.getTranslatedString(C._BUNDLE_KEY._MSG_NO_DATA);var d=null!=t?_:this.getTranslatedString(C._BUNDLE_KEY._MSG_INITIALIZING);null==e?this._createTableBodyMessageRow(this._getColumnDefs().length,d):this._setTableBodyMessage(d)}this._noDataMessageShown=!0}},C.prototype._hideNoDataMessage=function(){if(this._noDataMessageShown){var e=this._getTableBodyMessageRow();if(null!=e)t(e).remove();else{var o=this._getTable();if(o.classList.contains(C.CSS_CLASSES._TABLE_NO_DATA_CONTAINER_CLASS)){o.classList.remove(C.CSS_CLASSES._TABLE_NO_DATA_CONTAINER_CLASS);var n=o.querySelector("tr."+C.CSS_CLASSES._TABLE_NO_DATA_CONTAINER_CLASS);null!=n&&(this._cleanTemplateNodes(n),t(n).remove())}}this._noDataMessageShown=!1}},C.prototype._handleContextMenuResizePopup=function(){var e,o=document.getElementById(this._getTableId()+"_resize_popup_spinner"),n=this._getContextMenuResizePopup(),i=parseInt(n.getAttribute("data-oj-columnIdx"),10);this._IsCustomElement()?(e=o.value,n.close()):(e=t(o).ojInputNumber("option","value"),t(n).ojPopup("close"));for(var l=[],s=this.options.columns.length,a=0;a<s;a++)l[a]=t.extend({},{},this.options.columns[a]);l[i].width=e,this.option("columns",l,{_context:{writeback:!0,internalSet:!0}}),this._clearCachedMetadata(),this._queueTask(function(){setTimeout(function(){this._getTable().focus()}.bind(this),0)}.bind(this))},C.prototype._handleContextMenuSelect=function(e,o){var n,i=(n=o?o.item:t(e.target)).attr("data-oj-command"),l=this._getFirstAncestor(this._contextMenuEvent.target,"."+C.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS,!0);l=null==l?this._contextMenuEventHeaderColumn:l;var s=this._getFirstAncestor(this._contextMenuEvent.target,"."+C.CSS_CLASSES._TABLE_DATA_CELL_CLASS,!0),a=null;if(null!=l&&(a=this._getElementColumnIdx(l)),null!=s&&(a=this._getElementColumnIdx(s)),null!==a)if("oj-table-sortAsc"===i)this._handleSortTableHeaderColumn(a,!0,e);else if("oj-table-sortDsc"===i)this._handleSortTableHeaderColumn(a,!1,e);else if("oj-table-enableNonContiguousSelection"===i)this._nonContiguousSelection=!0,this._removeTableBodyRowTouchSelectionAffordance(),n.attr("data-oj-command","oj-table-disableNonContiguousSelection"),n.children().first().text(this.getTranslatedString("labelDisableNonContiguousSelection"));else if("oj-table-disableNonContiguousSelection"===i)this._nonContiguousSelection=!1,n.attr("data-oj-command","oj-table-enableNonContiguousSelection"),n.children().first().text(this.getTranslatedString("labelEnableNonContiguousSelection"));else if("oj-table-resize"===i){var r=this._getContextMenuResizePopup();r.setAttribute("data-oj-columnIdx",a);var _,d=l||s,h=this._getColumnWidthProperty(d);_=null!=l?l:null!=s?s:this._getTable();var u=document.getElementById(this._getTableId()+"_resize_popup_spinner");this._IsCustomElement()?(u.value=Math.round(h),r.open(_)):(t(u).ojInputNumber("option","value",Math.round(h)),t(r).ojPopup("open",_))}},C.prototype._registerResizeListener=function(){var t=this._getTableContainer();this._resizeListener||(this._resizeListener=function(){var e=this._getTableContainer();this._isSizingRefreshRequired(e.offsetWidth,e.offsetHeight)&&(this._hasPendingTasks()||this._syncTableSizing(!0))}.bind(this)),this._isResizeListenerAdded||(e.DomUtils.addResizeListener(t,this._resizeListener,50),this._isResizeListenerAdded=!0)},C.prototype._unregisterResizeListener=function(){var t=this._getTableContainer();e.DomUtils.removeResizeListener(t,this._resizeListener),this._isResizeListenerAdded=!1},C.prototype._unregisterChildStateListeners=function(e){for(var t=e.querySelectorAll("*"),o=0;o<t.length;o++)this._UnregisterChildNode(t[o])},C.prototype._isLoadMoreOnScroll=function(){return this.options.scrollPolicy===C._OPTION_SCROLL_POLICY._AUTO?!(this._data instanceof e.TableDataSourceAdapter):this.options.scrollPolicy!==C._OPTION_SCROLL_POLICY._LOAD_ALL},C.prototype._isTableHeaderless=function(){for(var e=this._getColumnDefs(),t=e.length,o=0;o<t;o++){var n=this._getSlotTemplate(e[o][C._HEADER_TEMPLATE]);if(null!=e[o].headerText||null!=e[o].headerStyle||null!=e[o].sortable&&e[o].sortable!==C._OPTION_DISABLED||null!=e[o].sortProperty||null!=e[o].headerRenderer||null!=n)return!1}if(this._isDefaultHeaderTemplateSlotValid()&&null!=this._getSlotTemplate("headerTemplate"))return!1;return!0},C.prototype._isTableFooterless=function(){for(var e=this._getColumnDefs(),t=e.length,o=0;o<t;o++){var n=this._getColumnRenderer(o,"footer"),i=this._getSlotTemplate(e[o][C._FOOTER_TEMPLATE]);if(null!=n)return!1;if(null!=i)return!1}if(this._isDefaultFooterTemplateSlotValid()&&null!=this._getSlotTemplate("footerTemplate"))return!1;return!0},C.prototype._isTableHeaderColumnsRendered=function(){return!0===this._renderedTableHeaderColumns},C.prototype._isTableRefreshNeeded=function(o,n){var i=this._cachedOptions,l=!1;return"contextMenu"===o&&n==="#"+this._getTableId()+"_contextmenu"?l=!1:"columns"!==o||this._isColumnMetadataUpdated()?"selection"===o||"currentRow"===o||e.Object.compareValues(n,i[o])||(l=!0):l=!1,this._cachedOptions=t.extend(!0,{},this.options),l},C.prototype._isTableSortable=function(){for(var e=this._getColumnDefs(),t=e.length,o=0;o<t;o++)if(e[o].sortable===C._OPTION_ENABLED)return!0;return!1},C.prototype._isTableColumnsResizable=function(){for(var e=this._getColumnDefs(),t=e.length,o=0;o<t;o++)if(e[o].resizable===C._OPTION_ENABLED)return!0;return!1},C.prototype._isTouchDevice=function(){if(null==this._isTouch){var e=navigator.userAgent.toLowerCase();-1!==e.indexOf("mobile")||-1!==e.indexOf("android")?this._isTouch=!0:this._isTouch=!1}return this._isTouch},C.prototype._getLayout=function(){return"initContents"},C.prototype._processSlottedChildren=function(){var o=this._getTableBottomSlot();null!=o&&t(o).remove();for(var n=e.BaseCustomElementBridge.getSlotMap(this._getRootElement()),i=Object.keys(n),l=0;l<i.length;l++){var s=i[l];if("bottom"===s){var a=n[s];if(null!=a){o=this._createTableBottomSlot();for(var r=0;r<a.length;r++)o.appendChild(a[r])}}}},C.prototype._delayRefreshTableDimensions=function(){this._setDelayRefreshTableDimensionsBusyState();var e=this._scrollTop;this._refreshTableDimensionsTimer=setTimeout(function(){var t=this._scrollTop;e!==t?this._delayRefreshTableDimensions():(this._queueTask(function(){this._refreshTableDimensionsTimer=null,"initContents"===this._getLayout()?this._skipRefreshTableDimension=!0:this._skipRefreshTableDimension=!1}.bind(this)),this._clearDelayRefreshTableDimensionsBusyState())}.bind(this),250)},C.prototype._handleSortTableHeaderColumn=function(e,t,o){this._clearSortedHeaderColumn(e);var n=this._getColumnDefs()[e],i=null==n.sortProperty?n.field:n.sortProperty;this._invokeDataSort(i,t,o),this._sortColumn=n,this._refreshSortTableHeaderColumn(i,t)},C.prototype._processFetchSort=function(e){try{var t=e.fetchParameters,o=this._getColumnDefs(),n=t[C._CONST_SORTCRITERIA];if(null!=n&&n.length>0){var i=n[0].attribute,l=n[0].direction===C._COLUMN_SORT_ORDER._ASCENDING;this._refreshSortTableHeaderColumn(i,l),this._setCurrentRow(this.options.currentRow,null,!1);for(var s=null,a=o.length,r=0;r<a;r++){var _=o[r];if(i===(null==_.sortProperty?_.field:_.sortProperty)){s=r;break}}null!=s&&setTimeout(function(){this._scrollColumnIntoViewport(s)}.bind(this),0)}else this._clearSortedHeaderColumn()}catch(e){d.error(e)}},C.prototype._handleMouseEnterColumnHeader=function(e){if(e){e.classList.add(C.MARKER_STYLE_CLASSES._HOVER);var t=this._getElementColumnIdx(e);(e.classList.contains(C.CSS_CLASSES._COLUMN_HEADER_ASC_ICON_CLASS)||e.classList.contains(C.CSS_CLASSES._COLUMN_HEADER_DSC_ICON_CLASS)||e.classList.contains(C.CSS_CLASSES._COLUMN_HEADER_DEFAULT_SORT_ICON_CLASS))&&e.classList.add(C.MARKER_STYLE_CLASSES._HOVER),this._showTableHeaderColumnSortIcon(t)}},C.prototype._handleMouseLeaveColumnHeader=function(e){if(e){e.classList.remove(C.MARKER_STYLE_CLASSES._HOVER);var t=this._getElementColumnIdx(e);this._hideTableHeaderColumnSortIcon(t)}},C.prototype._showTableHeaderColumnSortIcon=function(e){if(this._getColumnDefs()[e].sortable===C._OPTION_ENABLED){var o=this._getTableHeaderColumn(e);if(!o)return;if(null==t(o).data("sorted")){var n=this._getSortIconContainer(o),i=this._getSortIcon(o);null!=n&&null!=i&&(i.classList.remove(C.MARKER_STYLE_CLASSES._DISABLED),i.classList.add(C.MARKER_STYLE_CLASSES._ENABLED),i.classList.add(C.MARKER_STYLE_CLASSES._DEFAULT))}}},C.prototype._hideTableHeaderColumnSortIcon=function(e){if(this._getColumnDefs()[e].sortable===C._OPTION_ENABLED){var o=this._getTableHeaderColumn(e);if(null==t(o).data("sorted")){var n=this._getSortIcon(o);null!=n&&(n.classList.remove(C.CSS_CLASSES._COLUMN_HEADER_DSC_ICON_CLASS),n.classList.remove(C.CSS_CLASSES._COLUMN_HEADER_ASC_ICON_CLASS),n.classList.add(C.CSS_CLASSES._COLUMN_HEADER_DEFAULT_SORT_ICON_CLASS),n.classList.add(C.MARKER_STYLE_CLASSES._DISABLED),n.classList.remove(C.MARKER_STYLE_CLASSES._ENABLED),n.classList.remove(C.MARKER_STYLE_CLASSES._DEFAULT))}}},C.prototype._refreshSortTableHeaderColumn=function(e,o){for(var n,i=this._getColumnDefs(),l=null,s=i.length,a=0;a<s;a++){var r=i[a];if(e===(null==r.sortProperty?r.field:r.sortProperty)){l=a;break}}if(null!=l){this._clearSortedHeaderColumn(l);var _=this._getTableHeaderColumn(l);if(null!=_){var d=t(_).data("sorted");null!=(n=this._getSortIcon(_))&&(n.classList.add(C.MARKER_STYLE_CLASSES._DEFAULT),n.classList.remove(C.MARKER_STYLE_CLASSES._DISABLED)),o&&d!==C._COLUMN_SORT_ORDER._ASCENDING?(t(_).data("sorted",C._COLUMN_SORT_ORDER._ASCENDING),null!=n&&(n.classList.remove(C.CSS_CLASSES._COLUMN_HEADER_DEFAULT_SORT_ICON_CLASS),n.classList.remove(C.CSS_CLASSES._COLUMN_HEADER_DSC_ICON_CLASS),n.classList.add(C.CSS_CLASSES._COLUMN_HEADER_ASC_ICON_CLASS))):o||d===C._COLUMN_SORT_ORDER._DESCENDING||(t(_).data("sorted",C._COLUMN_SORT_ORDER._DESCENDING),null!=n&&(n.classList.remove(C.CSS_CLASSES._COLUMN_HEADER_DEFAULT_SORT_ICON_CLASS),n.classList.remove(C.CSS_CLASSES._COLUMN_HEADER_ASC_ICON_CLASS),n.classList.add(C.CSS_CLASSES._COLUMN_HEADER_DSC_ICON_CLASS)))}}},C.prototype._getSortedTableHeaderColumnIdx=function(){for(var e=this._getTableHeaderColumns(),o=e?e.length:0,n=0;n<o;n++){if(null!=t(e[n]).data("sorted"))return n}return null},C.prototype._clearSortedHeaderColumn=function(e){var o=this._getSortedTableHeaderColumnIdx();if(null!=o){var n=this._getTableHeaderColumn(o);if(t(n).data("sorted",null),null==e||o!==e)this._hideTableHeaderColumnSortIcon(o);else{var i=this._getSortIcon(n);null!=i&&i.classList.remove(C.MARKER_STYLE_CLASSES._SELECTED)}}},C.prototype._getColumnDefs=function(){return this._columnDefArray||(this._columnDefArray=this._getColumnMetadata()),this._columnDefArray},C.prototype._getColumnMetadata=function(){var e,o=this.options.columns,n=this.options.columnsDefault;if((0===o.length||1===o.length&&null==o[0].id&&null==o[0].headerText&&null==o[0].field)&&null==n.headerText&&null==n.field)return[];var i=[],l=o.length;for(e=0;e<l;e++)i[e]=t.extend({},n,o[e]);var s=[],a=i.length;for(e=0;e<a;e++)s.push(i[e]);var r=this._getData(),_=!1;for(null!=r&&null!=r.getCapability("sort")&&(_=!0),e=0;e<a;e++)null==s[e][C._FIELD_ID]&&(s[e][C._FIELD_ID]=C._COLUMN_HEADER_ID_PREFIX+e),!_||null!=s[e].sortable&&s[e].sortable!==C._OPTION_AUTO||(s[e].sortable=C._OPTION_ENABLED);return s},C.prototype._getColumnRenderer=function(e,t){var o=this._getColumnDefs()[e],n=null;return"cell"===t?n=o.renderer:"footer"===t?n=o.footerRenderer:"header"===t&&(n=o.headerRenderer),this._WrapCustomElementRenderer(n)},C.prototype._getRowRenderer=function(){return this._WrapCustomElementRenderer(this.options.rowRenderer)},C.prototype._isOverflow=function(){return this._isLoadMoreOnScroll()&&this._domScroller&&this._domScroller.isOverflow()},C.prototype._registerDomScroller=function(){this._unregisterDomScroller(),this._domScrollerSuccessFunc=function(e){if(this._clearDataWaitingState(),null!=e)if(this._noMoreData=!1,e.maxCountLimit)this._noMoreData=!0,this._handleScrollerMaxRowCount(),this._syncScrollPosition();else{var t,o=e[C._CONST_VALUE],n=o[C._CONST_DATA],i=o.metadata.map(function(e){return e[C._CONST_KEY]}),l=o[C._CONST_METADATA];for(t=i.length-1;t>=0;t--)null!==this._getRowIdxForRowKey(i[t])&&(n.splice(t,1),i.splice(t,1));this._queueTask(function(){this._skipRefreshTableDimension=!0;var o=this._getTableBodyRows().length,s=[];for(t=0;t<n.length;t++)s[t]=o+t;return this._refreshAll({isMouseWheel:e.isMouseWheel,data:n,keys:i,metadata:l,indexes:s},o).then(function(){e.done&&(this._noMoreData=!0,this._syncScrollPosition())}.bind(this))}.bind(this))}else this._syncScrollPosition()}.bind(this);var e=this._getTableBodyRows().length;this._requiresDomScrollerRefresh=!1,this._domScroller=new c(this._getScroller(),this._getData(),{asyncIterator:this._dataProviderAsyncIterator,fetchSize:this.options.scrollPolicyOptions.fetchSize,maxCount:this.options.scrollPolicyOptions.maxCount,initialRowCount:e,success:this._domScrollerSuccessFunc.bind(this),request:this._handleDataFetchStart.bind(this),localKeyValidator:function(e){return null!==this._findRowElementByKey(e)}.bind(this),beforeFetch:function(e){return null==this._idleCallback&&(this._fetchBySyncScroll=Math.abs(this._scrollY-e)<=1,this._setDataWaitingState(!1),this._showProgressiveLoading(),!0)}.bind(this),onScrollTop:this._clearScrollPosBusyState.bind(this),fetchTrigger:2})},C.prototype._unregisterDomScroller=function(){null!=this._domScroller&&(this._domScroller.destroy(),this._domScroller=null)},C.prototype._handleScrollerMaxRowCount=function(){var e=this.getTranslatedString("msgScrollPolicyMaxCountSummary"),t=this.getTranslatedString("msgScrollPolicyMaxCountDetail");d.warn(e+"\n"+t)},C.prototype._clearIdleCallback=function(){null!=this._idleCallback&&(window.requestIdleCallback&&window.cancelIdleCallback?(window.cancelIdleCallback(this._idleCallback),window.cancelAnimationFrame(this._idleCallback)):window.cancelAnimationFrame(this._idleCallback),this._idleCallback=null)},C.prototype._requestIdleCallback=function(e,t){if(!e&&window.requestIdleCallback&&window.cancelIdleCallback){var o=window.setTimeout(function(){this._idleCallback=window.requestAnimationFrame(function(){t()}),o=null},250);this._idleCallback=window.requestIdleCallback(function(e){null!=o&&(window.clearTimeout(o),t(e))})}else this._idleCallback=window.requestAnimationFrame(function(){t()})},C.prototype._renderRowsWhenIdle=function(t,o,n,i,l,s){if(0===t.length)return this._idleCallback=null,void this._afterRowsRendered(o,!0).then(function(e){i(e)},function(e){l(e)});var a,r=this,_=0;function d(){window.requestAnimationFrame(function(){r._freezeColumnWidths(a),o.appendChild(a),r._renderRowsWhenIdle(t,o,n+_,i,l,s),s&&e.AgentUtils.getAgentInfo().browser===e.AgentUtils.BROWSER.FIREFOX&&o.scrollTop!==r._scrollTop&&(o.scrollTop=r._scrollTop)})}this._requestIdleCallback(s,function(e){void 0===e?function(){a=document.createDocumentFragment();for(var e=0;e<C._BATCH_PROCESS_SIZE_WHEN_IDLE&&0!==t.length;e++)0!==_||r._tableWidthConstrained||(o.style[C.CSS_PROP._OVERFLOW_X]="hidden"),r._renderRow(t.shift(),a,n),_+=1;d()}():function(e){var i=e.timeRemaining(),l=0;for(a=document.createDocumentFragment();i>l&&0!==t.length;)0!==_||r._tableWidthConstrained||(o.style[C.CSS_PROP._OVERFLOW_X]="hidden"),r._renderRow(t.shift(),a,n),_+=1,l=i-e.timeRemaining(),i=e.timeRemaining();d()}(e)})},C.prototype._renderRow=function(e,t,o){var n=e.row,i=e.rowIdx;if(null!=n){var l=this._createTableBodyRow();this._styleTableBodyRow(l,!0),this._insertTableBodyRow(i,l,n,t),this._refreshTableBodyRow(i,n,l,t,o)}},C.prototype._afterRowsRendered=function(e,t){this._clearCachedDomRowData(),t&&null==this._refreshTableDimensionsTimer&&this._delayRefreshTableDimensions(),this._clearIdleRenderBusyState(),this._hasRowOrCellRendererOrTemplate()&&s.subtreeAttached(e);var o=this._getTableBodyRows();return o.length>0?this._finalizeBodyRowRendering(o).then(function(){return isNaN(this._rowHeight)&&e.rows.length>1&&(this._rowHeight=e.rows[1].offsetHeight),Promise.resolve(!0)}.bind(this)):Promise.resolve(!0)},C.prototype._getRowIdxsForElementsWithStyleClass=function(e){var t=this._tableQuerySelectorAll(this._getTable(),e),o=[];if(t&&t.length>0)for(var n=t.length,i=0;i<n;i++){for(var l=this._getElementRowIdx(t[i]),s=!1,a=o.length,r=0;r<a;r++)o[r]===l&&(s=!0);s||o.push(l)}return o},C.prototype._getColumnIdxsForElementsWithStyleClass=function(e){var t=this._tableQuerySelectorAll(this._getTable(),e),o=[];if(t&&t.length>0)for(var n=t.length,i=0;i<n;i++){var l=this._getElementColumnIdx(t[i]),s=!1;null===l&&t[i].classList.contains(C.CSS_CLASSES._COLUMN_HEADER_SELECTOR_CELL_CLASS)&&(l=-1);for(var a=o.length,r=0;r<a;r++)o[r]===l&&(s=!0);s||o.push(l)}return o},C.prototype._syncTableSizing=function(e){this._refreshTableDimensions(null,null,e),this._isLoadMoreOnScroll()&&!this._dataFetching&&this._domScroller?(this._setDataWaitingState(!1),this._domScroller.checkViewport().then(this._domScrollerSuccessFunc,this._clearDataWaitingState.bind(this))):this._syncScrollPosition()},C.prototype._addSingleTableBodyRow=function(e,t,o,n){var i=this._createTableBodyRow();return this._styleTableBodyRow(i,!0),this._insertTableBodyRow(e,i,t,o),i=this._refreshTableBodyRow(e,t,i,o,n),o||s.subtreeAttached(i),i},C.prototype._animateVisibleRows=function(e,t,o){if(o=null==this._animationActionOverride?o:this._animationActionOverride,!this._hasPendingTasks()){this._animationActionOverride=null;var n,i=this._getVisibleRowIdxs(),l=[];for(n=0;n<t.length;n++)-1===i.indexOf(t[n])&&l.push(t[n]);for(l.sort(function(e,t){return e-t}),n=l.length-1;n>=0;n--)e.splice(l[n],1);return this._unregisterResizeListener(),this._animateTableBodyRows(e,o).then(function(){this._registerResizeListener()}.bind(this))}return this._animationActionOverride="update",Promise.resolve()},C.prototype._cleanTemplateNodes=function(e){var t=this._getTemplateEngine();null!=t&&t.clean(e)},C.prototype._clearCachedMetadata=function(){this._columnDefArray=null,this._columnOffsets=null,this._setTableActionableMode(!1)},C.prototype._clearCachedDimensions=function(){this._clientWidth=null,this._clientHeight=null,this._scrollWidth=null,this._scrollHeight=null},C.prototype._getSlotTemplate=function(t){if(this._IsCustomElement()&&t){var o=e.BaseCustomElementBridge.getSlotMap(this._getRootElement())[t];if(o&&o.length>0&&"template"===o[0].tagName.toLowerCase())return o[0]}return null},C.prototype._isDefaultCellTemplateSlotValid=function(){return this._isDefaultTemplateSlotValid("cellTemplate")},C.prototype._isDefaultRowTemplateSlotValid=function(){return this._isDefaultTemplateSlotValid("rowTemplate")},C.prototype._isDefaultHeaderTemplateSlotValid=function(){return this._isDefaultTemplateSlotValid("headerTemplate")},C.prototype._isDefaultFooterTemplateSlotValid=function(){return this._isDefaultTemplateSlotValid("footerTemplate")},C.prototype._isDefaultTemplateSlotValid=function(e){for(var t=this._getColumnDefs(),o=t.length,n=0;n<o;n++){var i=t[n][C._CELL_TEMPLATE],l=t[n][C._HEADER_TEMPLATE],s=t[n][C._FOOTER_TEMPLATE];if(e===i||e===l||e===s)return!1}return!0},C.prototype._getTemplateEngine=function(){return this._templateEngine},C.prototype._getVisibleRowIdxs=function(){var e=[],o=this._getTableBody(),n=this._getTableBodyRows();if(n.length>0&&o.offsetHeight>0){var i=t(window).height(),l=o.getBoundingClientRect();if(l.top>i)return e;var s=l.left>=0?l.left+1:l.right-1,a=l.top>=0?l.top:0,r=document.elementFromPoint(s,a),_=null;null!=r&&(_=this._getElementRowIdx(r));var d,h,u=null!=_?_:0;if(l.bottom>i)_=null,null!=(h=document.elementFromPoint(s,i-1))&&(d=this._getElementRowIdx(h));else{var c=parseInt(window.getComputedStyle(o).borderBottomWidth,10)||0,S=l.bottom>=0?l.bottom-c-1:0;null!=(h=document.elementFromPoint(s,S))&&(d=this._getElementRowIdx(h))}null==d&&(d=n.length-1);for(var C=u;C<=d;C++)e.push(C)}return e},C.prototype._hasRowOrCellRendererOrTemplate=function(e){if(null!=this._getRowRenderer())return!0;var t=null,o=null,n=this._getColumnDefs();if(null!=e)t=this._getColumnRenderer(e,"cell"),o=this._getSlotTemplate(n[e][C._CELL_TEMPLATE]);else for(var i=n.length,l=0;l<i&&null==(t=this._getColumnRenderer(l,"cell"))&&null==(o=this._getSlotTemplate(n[l][C._CELL_TEMPLATE]));l++);if(null!=t||null!=o)return!0;if(this._isDefaultRowTemplateSlotValid()&&null!=this._getSlotTemplate("rowTemplate"))return!0;if(this._isDefaultCellTemplateSlotValid()&&null!=this._getSlotTemplate("cellTemplate"))return!0;return!1},C.prototype._initFetch=function(t,o){var n=t||{},i=this._getData();return null==i||!e.DataProviderFeatureChecker.isDataProvider(i)||this._isPagingModelDataProvider()&&!o?null==i?this._queueTask(function(){return Promise.resolve()}):void 0:this._queueTask(function(){return this._scrollTop=0,this._getScroller().scrollTop=0,i instanceof e.TableDataSourceAdapter&&(n.fetchType="init",this._isLoadMoreOnScroll()&&(n[C._CONST_OFFSET]=0)),this._invokeDataFetchRows(n)}.bind(this))},C.prototype._initTemplateEngine=function(){this._queueTask(function(){var e;try{e=n.__getTemplateEngine().then(function(e){this._templateEngine=e}.bind(this),function(e){d.warn(e)})}catch(t){d.warn(t),e=Promise.resolve(null)}return e}.bind(this))},C.prototype._initializeFetchFirstOptions=function(e){var t=e||{};return this._clientId=this._clientId||Symbol(),t[C._CONST_CLIENTID]=this._clientId,!t[C._CONST_PAGESIZE]&&this._isLoadMoreOnScroll()?t[C._CONST_PAGESIZE]=this.options.scrollPolicyOptions.fetchSize:t[C._CONST_PAGESIZE]=-1,t[C._CONST_SILENT]=!0,t},C.prototype._invokeDataFetchRows=function(t){this._tableDimensionsInitialized=!1;var o=this._initializeFetchFirstOptions(t),n=this._getData();return null!=n?new Promise(function(t){this._noMoreData=!1,this._setDataWaitingState(),this._dataProviderAsyncIterator=n.fetchFirst(o)[Symbol.asyncIterator](),this._dataProviderAsyncIterator.next().then(function(o){var i=o[C._CONST_VALUE],l=i[C._CONST_DATA],s=i.metadata.map(function(e){return e[C._CONST_KEY]}),a=0;n instanceof e.TableDataSourceAdapter&&(a=n[C._CONST_OFFSET]);var r=0;this._isPagingModelDataProvider()&&(r=n.getStartItemIndex());for(var _=[],d=l.length,h=0;h<d;h++)_[h]=a+r+h;var u=i[C._CONST_METADATA];this._unregisterDomScroller(),o.maxCountLimit?(this._noMoreData=!0,this._handleScrollerMaxRowCount()):o.done&&(this._noMoreData=!0),this._refreshAll({data:l,metadata:u,keys:s,indexes:_},a).then(function(){this._clearDataWaitingState(),this._processFetchSort(i),this._isLoadMoreOnScroll()&&this._registerDomScroller(),t(o)}.bind(this))}.bind(this),function(){this._clearDataWaitingState(),0===this._getTableBodyRows().length&&this._showNoDataMessage(),t(null)}.bind(this))}.bind(this)):Promise.resolve(null)},C.prototype._invokeDataSort=function(e,t,o){if(this._getData()){this._showStatusMessage();var n=[],i={};i[C._CONST_ATTRIBUTE]=e,i.direction=t?C._COLUMN_SORT_ORDER._ASCENDING:C._COLUMN_SORT_ORDER._DESCENDING,n.push(i),this._trigger("sort",o,{header:n[0][C._CONST_ATTRIBUTE],direction:n[0].direction}),this._beforeDataRefresh(),this._initFetch({sortCriteria:n},!0)}},C.prototype._isColumnMetadataUpdated=function(){if(null!=this._columnDefArray){var e=this._getColumnMetadata();if(this._columnDefArray.length!==e.length)return!0;for(var t=e.length,o=0;o<t;o++)for(var n=Object.keys(e[o]),i=0;i<n.length;i++){var l=n[i];if(e[o][l]!==this._columnDefArray[o][l]&&("id"!==l||null==e[o][l]||0!==e[o][l].indexOf(C._COLUMN_HEADER_ID_PREFIX)||null==this._columnDefArray[o][l]||0!==this._columnDefArray[o][l].indexOf(C._COLUMN_HEADER_ID_PREFIX)))return!0}return!1}return!0},C.prototype._handleDataRefresh=function(){try{if(this._dataFetching)return void(this._pendingFetchStale=!0);this._queueTask(function(){return this._beforeDataRefresh(),this._invokeDataFetchRows()}.bind(this))}catch(e){d.error(e)}},C.prototype._beforeDataRefresh=function(){this._clearIdleCallback(),this._adjustScrollPositionOnRefresh(),this._invalidateRangeSelection(),null!=this._lastSelectedRowIdxArray&&(this._lastSelectedRowIdxArray=[]),this._initialSelectionStateValidated=!1},C.prototype._getColumnKeys=function(){var e=[],t=this._getColumnDefs();if(null!=t)for(var o=0;o<t.length;o++)e.push(t[o][C._FIELD_ID]);return e},C.prototype._getLocalRowKeys=function(){for(var e=[],o=this._getTableBodyRows(),n=0;n<o.length;n++)e.push(t(o[n]).data("rowKey"));return e},C.prototype._hasMoreToFetch=function(){return!!this._isLoadMoreOnScroll()&&!this._noMoreData},C.prototype._clearCachedDataMetadata=function(){null!=this._data&&this._unregisterDataSourceEventListeners(),this._data=null},C.prototype._executeTableBodyRowsAdd=function(e){var t=e[C._CONST_KEYS];t&&t.size>0&&this._queueTask(function(){var t=this._getRowsFromEventDetailAdd(e);if(0!==t.length){var o,n,i=!1,l=[],a=[];if(t.length>1){n=t.length;var r=!0;for(o=0;o<n;o++)0!==o&&t[o-1].rowIdx!==t[o].rowIdx-1&&(r=!1),a.push(t[o].rowIdx);if(r){var _=this._getTableBody(),d=document.createDocumentFragment();for(n=t.length,o=0;o<n;o++)l.push(this._addSingleTableBodyRow(t[o].rowIdx,t[o].row,d,t[0].rowIdx));if(0===t[0].rowIdx)_.insertBefore(d,_.firstChild);else{var h=this._getTableBodyRow(t[0].rowIdx);null!=h?_.insertBefore(d,h):_.appendChild(d,null)}this._clearCachedDomRowData(),s.subtreeAttached(_),i=!0}}if(!i)for(n=t.length,o=0;o<n;o++)l.push(this._addSingleTableBodyRow(t[o].rowIdx,t[o].row));return this._clearCachedDomRowData(),this._refreshTableFooter(),this._requiresDomScrollerRefresh&&this._registerDomScroller(),this._IsCustomElement()?this._animateVisibleRows(l,a,"add").then(function(){return this._finalizeBodyRowRendering(l)}.bind(this)):this._finalizeBodyRowRendering(l)}this._requiresDomScrollerRefresh&&this._registerDomScroller()}.bind(this))},C.prototype._executeTableBodyRowsChange=function(e,t){this._queueTask(function(){var t=this._getRowsFromEventDetailChange(e);if(0!==t.length){for(var o=t.length,n=[],i=[],l=0;l<o;l++){var s=this._refreshTableBodyRow(t[l].rowIdx,t[l].row);s&&(n.push(s),i.push(t[l].rowIdx))}return this._refreshTableFooter(),this._IsCustomElement()?this._animateVisibleRows(n,i,"update").then(function(){return this._finalizeBodyRowRendering(n)}.bind(this)):this._finalizeBodyRowRendering(n)}}.bind(this))},C.prototype._executeTableBodyRowsRemove=function(e,o){var n=this,i=e[C._CONST_KEYS];i&&i.size>0&&this._queueTask(function(){var i=n._getRowsFromEventDetailRemove(e);if(0!==i.length){i.sort(function(e,t){return t.rowIdx-e.rowIdx});var l,s,a,r=n._getCurrentRow(),_=null!=r?r.rowIndex:0,d=null!=r?r.rowKey:null,h=[],u=[],c=[],S=i.length,C=!1,E=n._getTableBodyRows();if(E.length>0){for(a=0;a<E.length;a++)h.push(a);for(a=0;a<S;a++){s=i[a].rowIdx,u.push(s);for(var T=0;T<h.length;T++)if(h[T]===s){l=n._getTableBodyRow(s),c.push(l),h.splice(T,1);break}}0===h.length&&(C=!0)}var p=n._getTableBody(),g=t.contains(p,document.activeElement),f=!1;if(C)g&&(f=!0),n._clearSelectionState();else for(a=0;a<S;a++)if(s=i[a].rowIdx,l=n._getTableBodyRow(s),g&&null!=l&&t.contains(l,document.activeElement)){f=!0,g=!1;break}if(!C)return new Promise(function(e){n._IsCustomElement()?n._animateVisibleRows(c,u,"remove").then(function(){m(),A(),e(!0)}):(m(),A(),e(!0))});n._removeAllTableBodyRows(),A()}else n._updateSelectionStateFromEventDetailRemove(e,o);function m(){for(var e=0;e<S;e++){var t=i[e].rowIdx;n._removeTableBodyRow(t)}}function A(){n._updateSelectionStateFromEventDetailRemove(e,o),n._refreshTableFooter(),0===(E=n._getTableBodyRows()).length&&n._showNoDataMessage(),null!=d&&(0===E.length||C||_>=E.length?n._setCurrentRow(null,null,!1):n._setCurrentRow({rowIndex:_,rowKey:null},null,!1)),f&&n._getTable().focus()}})},C.prototype._getColumnIdxForColumnKey=function(t){var o=this._getColumnDefs();if(null!=o)for(var n=o.length,i=0;i<n;i++){var l=o[i];if(e.KeyUtils.equals(l.id,t))return i}return null},C.prototype._getColumnKeyForColumnIdx=function(e){var t=this._getColumnDefs();return null!=t&&e<t.length?t[e][C._FIELD_ID]:null},C.prototype._getData=function(){if(!this._data&&null!=this.options.data){var t=this.options.data;if(e.TableDataSource&&t instanceof e.TableDataSource||e.PagingTableDataSource&&t instanceof e.PagingTableDataSource)this._data=new e.TableDataSourceAdapter(t);else{if(!e.DataProviderFeatureChecker.isDataProvider(t)){var o=C._LOGGER_MSG._ERR_DATA_INVALID_TYPE_SUMMARY,n=C._LOGGER_MSG._ERR_DATA_INVALID_TYPE_DETAIL;throw new Error(o+"\n"+n)}t instanceof e.ListDataProviderView||e.DataProviderFeatureChecker.isTreeDataProvider(t)?this._data=t:this._data=new e.ListDataProviderView(t)}this._dataOption=this.options.data,this._registerDataSourceEventListeners()}return this._data},C.prototype._getRowIdxRowArray=function(e,t){var o=[];if(null!=e)for(var n=e[C._CONST_INDEXES].length,i=0;i<n;i++)o.push({row:{data:e[C._CONST_DATA][i],metadata:e[C._CONST_METADATA]?e[C._CONST_METADATA][i]:null,key:e[C._CONST_KEYS][i],index:e[C._CONST_INDEXES][i]},rowIdx:t+i});return o},C.prototype._getRowIdxForRowKey=function(o){var n=this._getTableBodyRows();if(n.length>0)for(var i=n.length,l=0;l<i;l++)if(e.KeyUtils.equals(t(n[l]).data("rowKey"),o))return l;return null},C.prototype._getDataSourceRowIndexForRowKey=function(o){var n=this._getTableBodyRows();if(n.length>0)for(var i=n.length,l=0;l<i;l++)if(e.KeyUtils.equals(t(n[l]).data("rowKey"),o)){var s=this._getData(),a=0;return this._isPagingModelDataProvider()&&(a=s.getStartItemIndex()),l+a}return null},C.prototype._getRowKeyForDataSourceRowIndex=function(e){var o=this._getTableBodyRows();if(o.length>0){var n=this._getData(),i=0;this._isPagingModelDataProvider()&&(i=n.getStartItemIndex());for(var l=o.length,s=0;s<l;s++)if(i+s===e)return t(o[s]).data("rowKey")}return null},C.prototype._getRowKeyForRowIdx=function(e){var o=this._getTableBodyRow(e);return null!=o?t(o).data("rowKey"):null},C.prototype._getRowKey=function(e,o){return null==e&&(e=this._getTableBodyRow(o)),null!=e?t(e).data("rowKey"):null},C.prototype._getRowsFromEventDetailAdd=function(t){var o=this._getData(),n=t[C._CONST_DATA],i=t[C._CONST_METADATA],l=t[C._CONST_INDEXES],s=[];t[C._CONST_KEYS].forEach(function(e){s.push(e)});var a=[],r=t[C._CONST_ADDBEFOREKEYS]?t[C._CONST_ADDBEFOREKEYS]:t[C._CONST_AFTERKEYS];null!=r&&r.forEach(function(e){a.push(e)}),n instanceof Array||(n=[n]),i instanceof Array||(i=[i]);var _,d=0;this._isPagingModelDataProvider()&&(d=o.getStartItemIndex()),o instanceof e.TableDataSourceAdapter&&(e.FlattenedTreeTableDataSource&&o.tableDataSource instanceof e.FlattenedTreeTableDataSource?_=o.tableDataSource:e.PagingTableDataSource&&o.tableDataSource instanceof e.PagingTableDataSource&&e.FlattenedTreeTableDataSource&&o.tableDataSource.dataSource instanceof e.FlattenedTreeTableDataSource&&(_=o.tableDataSource.dataSource));for(var h,u,c,S=[],E=null,T=this._getTableBodyRows().length,p=n.length,g=T-1,f=0;f<p;f++)if(c=null!=a?a[f]:"",null!=(h=this._getRowIdxForRowKey(c))&&h>=0?u=h+d:l&&f<l.length&&l[f]>=0?u=l[f]:0===f?u=T:isNaN(u)||(u+=1),!isNaN(u)){if(h=u-d,this._isLoadMoreOnScroll()){if(!(h<=g)){this._noMoreData&&(this._requiresDomScrollerRefresh=!0),this._noMoreData=!1;continue}g+=1}E=_&&_._getMetadata?_._getMetadata(h):i[f];var m={data:n[f],metadata:E,key:s[f],index:u};S.push({row:m,rowIdx:h})}return S},C.prototype._handleDataRowMutate=function(e){this._dataFetching?this._pendingFetchStale=!0:(null!=e.detail.remove&&this._handleDataRowRemove(e.detail.remove,e.detail.add),null!=e.detail.add&&this._handleDataRowAdd(e.detail.add),null!=e.detail.update&&this._handleDataRowChange(e.detail.update))},C.prototype._handleDataRowAdd=function(e){try{this._executeTableBodyRowsAdd(e)}catch(e){d.error(e)}finally{this._clearDataWaitingState()}},C.prototype._handleDataRowChange=function(e){try{this._executeTableBodyRowsChange(e)}catch(e){d.error(e)}finally{this._clearDataWaitingState()}},C.prototype._getRowsFromEventDetailChange=function(e){var t=e[C._CONST_DATA],o=e[C._CONST_METADATA],n=[];e[C._CONST_KEYS].forEach(function(e){n.push(e)}),t instanceof Array||(t=[t]),o instanceof Array||(o=[o]);for(var i=[],l=t.length,s=0;s<l;s++){var a=this._getRowIdxForRowKey(n[s]);if(void 0!==a){var r={data:t[s],key:n[s],index:a,metadata:o[s]};i.push({row:r,rowIdx:a})}}return i},C.prototype._handleDataRowRemove=function(e,t){try{this._executeTableBodyRowsRemove(e,t)}catch(e){d.error(e)}finally{this._clearDataWaitingState()}},C.prototype._getRowsFromEventDetailRemove=function(e){var t=[];return e[C._CONST_KEYS].forEach(function(e){var o=this._getRowIdxForRowKey(e);if(void 0!==o){var n={key:e,index:o};t.push({row:n,rowIdx:o})}}.bind(this)),t},C.prototype._isPagingModelDataProvider=function(){var e=this._getData();return null!=e.getStartItemIndex&&null!==e.getStartItemIndex()&&e.getStartItemIndex()>=0},C.prototype._registerDataSourceEventListeners=function(){var e=this._getData();if(null!=e){this._unregisterDataSourceEventListeners(),this._dataProviderEventHandlers=[],this._dataProviderEventHandlers.push({eventType:"mutate",eventHandler:this._handleDataRowMutate.bind(this)}),this._dataProviderEventHandlers.push({eventType:"refresh",eventHandler:this._handleDataRefresh.bind(this)});for(var t=this._dataProviderEventHandlers.length,o=0;o<t;o++){var n=e.addEventListener(this._dataProviderEventHandlers[o].eventType,this._dataProviderEventHandlers[o].eventHandler);n&&(this._dataProviderEventHandlers[o].eventHandler=n)}}},C.prototype._unregisterDataSourceEventListeners=function(){var e=this._getData();if(null!=this._dataProviderEventHandlers&&null!=e)for(var t=this._dataProviderEventHandlers.length,o=0;o<t;o++)e.removeEventListener(this._dataProviderEventHandlers[o].eventType,this._dataProviderEventHandlers[o].eventHandler)},C.prototype._animateTableBodyRow=function(e,t){return this._isAnimationDisabled(t)?Promise.resolve(!1):new Promise(function(o){this._startAnimation(e,t).then(function(){o(!0)})}.bind(this))},C.prototype._animateTableBodyRows=function(e,t){if(this._isAnimationDisabled(t))return Promise.resolve(!1);for(var o=[],n=0;n<e.length;n++){var i=e[n];o.push(function(e){return this._animateTableBodyRow(e,t)}.bind(this)(i))}return o.length>0?Promise.all(o):Promise.resolve(!1)},C.prototype._getAnimationEffect=function(e){return null==this.defaultAnimations&&(this.defaultAnimations=this._getDefaultOptions().animation||{}),this.defaultAnimations[e]},C.prototype._isAnimationDisabled=function(e){var t=this._getAnimationEffect(e);return null==t||0===t.length},C.prototype._startAnimation=function(e,t,o){return null==o&&(o=this._getAnimationEffect(t)),r.startAnimation(e,t,o,this)},C.prototype._createContextInfo=function(){var e=document.createElement(C.DOM_ELEMENT._DIV);return e.id=this.createSubId("context"),e.classList.add(C.CSS_CLASSES._TABLE_ACC_CONTEXT_INFO_CLASS),e.classList.add(C.CSS_CLASSES._HIDDEN_CONTENT_ACC_CLASS),this._getTableContainer().appendChild(e),this._contextInfo=e,e},C.prototype._createStateInfo=function(){var e=document.createElement(C.DOM_ELEMENT._DIV);return e.id=this.createSubId("state"),e.classList.add(C.CSS_CLASSES._TABLE_ACC_STATE_INFO_CLASS),e.classList.add(C.CSS_CLASSES._HIDDEN_CONTENT_ACC_CLASS),this._getTableContainer().appendChild(e),this._stateInfo=e,e},C.prototype._createTableStatusAccNotification=function(){var e=this._getTableContainer(),t=document.createElement(C.DOM_ELEMENT._DIV);return t.setAttribute(C.DOM_ATTR._ROLE,"status"),t.classList.add(C.CSS_CLASSES._TABLE_STATUS_ACC_NOTIFICATION_CLASS),t.classList.add(C.CSS_CLASSES._HIDDEN_CONTENT_ACC_CLASS),e.appendChild(t),this._cacheDomElement(C.CSS_CLASSES._TABLE_STATUS_ACC_NOTIFICATION_CLASS,t),this._accStatus=t,t},C.prototype._updateAccStatusInfo=function(e,o){var n,i,l="",s="";if(!1!==this._accFirstFocus&&(l+=this._getTableContainer().id+" "),-1===e){if(this._contextInfo.textContent=this.getTranslatedString("accessibleColumnHeaderContext",{index:o+1}),l+=this._contextInfo.id+" ",-1===o)i=this._getTableSelectorColumn(),this._stateInfo.textContent="";else{i=this._getTableHeaderColumn(o);var a=this._getSelectedHeaderColumnIdxs();for(n=0;n<a.length;n++)if(a[n]===o){s+=this.getTranslatedString("accessibleStateSelected")+" ";break}var r=t(i).data("sorted");if(null!=r){var _=this._getColumnDefs()[o],d=null==_.sortProperty?_.field:_.sortProperty;r===C._COLUMN_SORT_ORDER._ASCENDING?s+=this.getTranslatedString("accessibleSortAscending",{id:d})+" ":s+=this.getTranslatedString("accessibleSortDescending",{id:d})+" "}this._stateInfo.textContent=s}l+=i.id+" "+this._stateInfo.id,this._applyAccStatusLabel(l)}else{this._contextInfo.textContent="",e!==this._accRowIndex&&(this._contextInfo.textContent+=this.getTranslatedString("accessibleRowContext",{index:e+1})+" "),o!==this._accColumnIndex&&(this._contextInfo.textContent+=this.getTranslatedString("accessibleColumnContext",{index:o+1})),l+=this._contextInfo.id+" ";var h=this._getTableElementsByClassName(this._getTableBodyRow(e),C.CSS_CLASSES._TABLE_DATA_CELL_CLASS);null!=(i=this._getTableHeaderColumn(o))&&(l+=i.id+" "+h[o].id+" ");var u=this._getSelectedRowIdxs();for(n=0;n<u.length;n++)if(u[n]===e){s+=this.getTranslatedString("accessibleStateSelected")+" ";break}this._stateInfo.textContent=s,l+=this._stateInfo.id,this._applyAccStatusLabel(l)}this._accRowIndex=e,this._accColumnIndex=o},C.prototype._applyAccStatusLabel=function(e){!1!==this._accFirstFocus?this._accFirstFocus=!1:this._accStatus.setAttribute(C.DOM_ATTR._ARIA_LABELLEDBY,e),this._getTable().setAttribute(C.DOM_ATTR._ARIA_LABELLEDBY,e)},C.prototype._setRowLabelledBy=function(e,t){var o;this._contextInfo.textContent=this.getTranslatedString("accessibleRowContext",{index:e+1});var n=this._getTableElementsByClassName(t,C.CSS_CLASSES._TABLE_DATA_CELL_CLASS),i="";for(!1!==this._accFirstFocus&&(i+=this._getTableContainer().id+" "),i+=this._contextInfo.id+" ",o=0;o<n.length;o++)i+=this._getTableHeaderColumn(o).id+" "+n[o].id+" ";i+=this._stateInfo.id;var l="",s=this._getSelectedRowIdxs();for(o=0;o<s.length;o++)if(s[o]===e){l+=this.getTranslatedString("accessibleStateSelected")+" ";break}this._stateInfo.textContent=l,this._applyAccStatusLabel(i)},C.prototype._setHeaderColumnLabelledBy=function(e){var o;this._contextInfo.textContent=this.getTranslatedString("accessibleColumnHeaderContext",{index:e+1});var n="";if(-1===e)o=this._getTableSelectorColumn(),this._stateInfo.textContent="";else{o=this._getTableHeaderColumn(e);for(var i=this._getSelectedHeaderColumnIdxs(),l=0;l<i.length;l++)if(i[l]===e){n+=this.getTranslatedString("accessibleStateSelected")+" ";break}var s=t(o).data("sorted");if(null!=s){var a=this._getColumnDefs()[e],r=null==a.sortProperty?a.field:a.sortProperty;s===C._COLUMN_SORT_ORDER._ASCENDING?n+=this.getTranslatedString("accessibleSortAscending",{id:r})+" ":n+=this.getTranslatedString("accessibleSortDescending",{id:r})+" "}this._stateInfo.textContent=n}var _="";!1!==this._accFirstFocus&&(_+=this._getTableContainer().id+" "),_+=this._contextInfo.id+" "+o.id+" "+this._stateInfo.id,this._applyAccStatusLabel(_)},C.prototype._clearCachedDom=function(){this._clearCachedDomRowData(),this._clearDomCache()},C.prototype._clearCachedDomRowData=function(){this._cachedDomTableBodyRows=null},C.prototype._createContextMenu=function(e){var o=this._GetContextMenu(),n=!!this._isTouchDevice()&&this._getRowSelectionMode()===C._OPTION_SELECTION_MODES._MULTIPLE;if(o){var i=o.querySelectorAll("[data-oj-command]");if(i.length>0){var l,s,a;for(s=0;s<i.length;s++)"OJ-OPTION"!==i[s].tagName&&0!==i[s].getElementsByTagName(C.DOM_ELEMENT._A).length||(l=i[s].getAttribute("data-oj-command").split("-"),a=this._createContextMenuItem(l[l.length-1],this._IsCustomElement()),"OJ-OPTION"===i[s].tagName?i[s].innerHTML=a.innerHTML:t(i[s]).replaceWith(a));this._menuContainer=o,t(o).data("oj-ojMenu")&&(this._IsCustomElement()?o.refresh():t(o).ojMenu("refresh")),this._IsCustomElement()?o.addEventListener("ojAction",e):t(o).on("ojselect",e)}}else if(this._isTableSortable()||n||this._isTableColumnsResizable()){if(this._IsCustomElement()?(o=document.createElement("oj-menu")).setAttribute("data-oj-binding-provider","none"):o=document.createElement(C.DOM_ELEMENT._UL),o.style[C.CSS_PROP._DISPLAY]=C.CSS_VAL._NONE,o.setAttribute(C.DOM_ATTR._ID,this._getTableId()+"_contextmenu"),this._getTableContainer().appendChild(o),this._isTableSortable()){var r=this._createContextMenuItem("sort",this._IsCustomElement());o.appendChild(r)}if(n){var _=this._createContextMenuItem("enableNonContiguousSelection",this._IsCustomElement());o.appendChild(_)}if(this._isTableColumnsResizable()){var d=this._createContextMenuItem("resize",this._IsCustomElement());o.appendChild(d)}this._menuContainer=o,this._IsCustomElement()?o.addEventListener("ojAction",e):(t(o).ojMenu(),t(o).on("ojselect",e)),this.option("contextMenu","#"+o.getAttribute(C.DOM_ATTR._ID),{_context:{internalSet:!0}}),this._defaultContextMenu=o}return o},C.prototype._createContextMenuItem=function(e,t){if("sort"===e){var o,n=this._createContextMenuListItem(e,t);return o=this._IsCustomElement()?document.createElement("oj-menu"):document.createElement(C.DOM_ELEMENT._UL),n.appendChild(o),o.appendChild(this._createContextMenuListItem("sortAsc",t)),o.appendChild(this._createContextMenuListItem("sortDsc",t)),n}return"sortAsc"===e?this._createContextMenuListItem(e,t):"sortDsc"===e?this._createContextMenuListItem(e,t):"enableNonContiguousSelection"===e?this._createContextMenuListItem(e,t):"disableNonContiguousSelection"===e?this._createContextMenuListItem(e,t):"resize"===e?(this._createContextMenuResizePopup(0),this._createContextMenuListItem(e,t)):null},C.prototype._createContextMenuListItem=function(e,t){var o=document.createElement(t?"oj-option":"li");return o.setAttribute("data-oj-command","oj-table-"+e),o.appendChild(this._createContextMenuLabel(e,t)),o},C.prototype._createContextMenuLabel=function(e,t){var o=null;"sort"===e?o=this.getTranslatedString("labelSort"):"sortAsc"===e?o=this.getTranslatedString("labelSortAsc"):"sortDsc"===e?o=this.getTranslatedString("labelSortDsc"):"enableNonContiguousSelection"===e?o=this.getTranslatedString("labelEnableNonContiguousSelection"):"disableNonContiguousSelection"===e?o=this.getTranslatedString("labelDisableNonContiguousSelection"):"resize"===e&&(o=this.getTranslatedString("labelResize"));var n=document.createTextNode(o);if(t)return n;var i=document.createElement(C.DOM_ELEMENT._A);return i.setAttribute(C.DOM_ATTR._HREF,"#"),i.appendChild(n),i},C.prototype._createContextMenuResizePopup=function(e){e=Math.round(e);var o,n,i,l,s,a,r,_,d,h,c=this._getContextMenuResizePopup();return this._IsCustomElement()?null==c?(i=this._getTableContainer(),(c=document.createElement("oj-popup")).setAttribute("id",this._getTableId()+"_resize_popup"),c.setAttribute("data-oj-binding-provider","none"),i.appendChild(c),l=document.createElement(C.DOM_ELEMENT._DIV),s=document.createElement(C.DOM_ELEMENT._DIV),(a=document.createElement(C.DOM_ELEMENT._DIV)).classList.add(C.CSS_CLASSES._TEXT_ALIGN_END),c.appendChild(l),c.appendChild(s),c.appendChild(a),(d=document.createElement("h6")).textContent=this.getTranslatedString("labelResizePopupSpinner"),l.appendChild(d),(o=document.createElement("oj-input-number")).setAttribute("id",this._getTableId()+"_resize_popup_spinner"),(r=document.createElement("oj-button")).setAttribute("id",this._getTableId()+"_resize_popup_popupcancel"),r.style.margin="5px",r.textContent=this.getTranslatedString("labelResizePopupCancel"),(_=document.createElement("oj-button")).setAttribute("id",this._getTableId()+"_resize_popup_popupsubmit"),_.style.margin="5px",_.textContent=this.getTranslatedString("labelResizePopupSubmit"),s.appendChild(o),a.appendChild(_),a.appendChild(r),n=function(){_.disabled=!1,o.value=0,c.close()},r.addEventListener("click",n),_.addEventListener("click",this._handleContextMenuResizePopup.bind(this)),o.max=1e3,o.min=10,o.step=1,o.value=e,o.displayOptions={messages:["notewindow"]},o.userAssistanceDensity="compact",o.validators=[new u({pattern:"^[1-9][0-9]*$",messageDetail:this.getTranslatedString("msgColumnResizeWidthValidation")})],o.addEventListener("validChanged",function(e){"valid"===e.detail.value?_.disabled=!1:_.disabled=!0}),h={my:"start top",at:"start bottom",collision:"flipfit"},c.setAttribute("position",JSON.stringify(h)),this._cacheDomElement(this._getTableId()+"_resize_popup",c)):(o=document.getElementById(this._getTableId()+"_resize_popup_spinner")).value=e:(i=this._getTableContainer(),null==c?((c=document.createElement(C.DOM_ELEMENT._DIV)).setAttribute("id",this._getTableId()+"_resize_popup"),c.setAttribute("data-oj-context",""),i.appendChild(c),l=document.createElement(C.DOM_ELEMENT._DIV),s=document.createElement(C.DOM_ELEMENT._DIV),(a=document.createElement(C.DOM_ELEMENT._DIV)).classList.add(C.CSS_CLASSES._TEXT_ALIGN_END),c.appendChild(l),c.appendChild(s),c.appendChild(a),(d=document.createElement("h6")).textContent=this.getTranslatedString("labelResizePopupSpinner"),l.appendChild(d),(o=document.createElement(C.DOM_ELEMENT._INPUT)).setAttribute("id",this._getTableId()+"_resize_popup_spinner"),(r=document.createElement(C.DOM_ELEMENT._BUTTON)).setAttribute("id",this._getTableId()+"_resize_popup_popupcancel"),r.style.margin="5px",(_=document.createElement(C.DOM_ELEMENT._BUTTON)).setAttribute("id",this._getTableId()+"_resize_popup_popupsubmit"),_.style.margin="5px",s.appendChild(o),a.appendChild(_),a.appendChild(r),t(_).ojButton({component:"ojButton",label:this.getTranslatedString("labelResizePopupSubmit")}),t(r).ojButton({component:"ojButton",label:this.getTranslatedString("labelResizePopupCancel")}),n=function(){t(_).ojButton({disabled:!1}),t(o).ojInputNumber({value:0}),t(c).ojPopup("close")},t(_).on("click",this._handleContextMenuResizePopup.bind(this)),t(r).on("click",n),t(o).ojInputNumber({component:"ojInputNumber",max:1e4,min:10,step:1,value:e,displayOptions:{messages:["notewindow"]},userAssistanceDensity:"compact",validators:[new u({pattern:"^[1-9][0-9]*$",messageDetail:this.getTranslatedString("msgColumnResizeWidthValidation")})]}),t(c).ojPopup({modality:"modal",position:{my:"start top",at:"start bottom",collision:"flipfit"}}),t(o).on("change",function(){t(_).ojButton({disabled:!t(o).ojInputNumber("validate")})}),this._cacheDomElement(this._getTableId()+"_resize_popup",c)):(o=document.getElementById(this._getTableId()+"_resize_popup_spinner"),t(o).ojInputNumber("option","value",e))),c},C.prototype._createInitialTable=function(e,t){var o=this._getTable();return this._createTableContainer(),e||this._createTableHeader(),t||this._createTableFooter(),this._createTableBody(),this._createTableStatusMessage(),this._createTableStatusAccNotification(),this._createContextInfo(),this._createStateInfo(),o},C.prototype._createTableBody=function(){var e=this._getTable(),t=document.createElement(C.DOM_ELEMENT._TBODY);return e.appendChild(t),this._cacheDomElement(C.CSS_CLASSES._TABLE_BODY_CLASS,t),t},C.prototype._createTableBodyCell=function(){return document.createElement(C.DOM_ELEMENT._TD)},C.prototype._createTableBodyDefaultSelector=function(t,o){var n=null;(n=document.createElement(C.DOM_ELEMENT._TD)).classList.add(C.CSS_CLASSES._TABLE_SELECTOR_CELL),this._isVerticalGridEnabled()&&n.classList.add(C.CSS_CLASSES._TABLE_VGRID_LINES_CLASS);var i=document.createElement("oj-selector");return i.id="table_selector"+t,i.selectedKeys=this.options.selected.row,i.setAttribute("data-oj-binding-provider","none"),i.classList.add(C.CSS_CLASSES._TABLE_DATA_ROW_SELECTOR_CLASS),i.setAttribute("selection-mode","multiple"),i.rowKey=t,i.addEventListener("selectedKeysChanged",function(t){"internal"===t.detail.updatedFrom&&this._setSelected({row:t.detail.value,column:new e.KeySetImpl},!1,!0)}.bind(this)),n.appendChild(i),o.insertBefore(n,o.firstChild),n},C.prototype._createTableHeaderSelectorColumn=function(){var t=document.createElement(C.DOM_ELEMENT._TH);t.classList.add(C.CSS_CLASSES._COLUMN_HEADER_SELECTOR_CELL_CLASS),this._isVerticalGridEnabled()&&t.classList.add(C.CSS_CLASSES._TABLE_VGRID_LINES_CLASS);var o=document.createElement("oj-selector");return o.selectedKeys=this.options.selected.row,o.setAttribute("data-oj-binding-provider","none"),o.classList.add(C.CSS_CLASSES._TABLE_HEADER_SELECTOR_CLASS),o.setAttribute("selection-mode","all"),o.addEventListener("selectedKeysChanged",function(t){"internal"===t.detail.updatedFrom&&this._setSelected({row:t.detail.value,column:new e.KeySetImpl},!1,!0)}.bind(this)),t.appendChild(o),t},C.prototype._createTableBodyMessageCell=function(e,t,o){var n=document.createElement(C.DOM_ELEMENT._TD);return this._isDefaultSelectorEnabled()&&(t+=1),n.setAttribute(C.DOM_ATTR._COLSPAN,t),n.classList.add(C.CSS_CLASSES._TABLE_BODY_MESSAGE_CLASS),n.appendChild(document.createTextNode(o)),e.appendChild(n),n},C.prototype._createTableBodyMessageRow=function(e,t){var o=this._getTableBody(),n=document.createElement(C.DOM_ELEMENT._TR);return n.classList.add(C.CSS_CLASSES._TABLE_BODY_MESSAGE_ROW_CLASS),this._createTableBodyMessageCell(n,e,t),o.appendChild(n),n},C.prototype._createTableBodyRow=function(){return document.createElement(C.DOM_ELEMENT._TR)},C.prototype._getTouchAffordanceGlassPane=function(){var e=this._getTableContainer(),t=this._getTableElementsByClassName(e,C.CSS_CLASSES._TABLE_TOUCH_AFFORDANCE_GLASS_PANE_CLASS);return t.length>0?t[0]:null},C.prototype._createTouchAffordanceGlassPane=function(){var e=this._getTouchAffordanceGlassPane();if(!e){var t=this._getTableContainer();(e=document.createElement(C.DOM_ELEMENT._DIV)).classList.add(C.CSS_CLASSES._TABLE_TOUCH_AFFORDANCE_GLASS_PANE_CLASS),t.appendChild(e),this._refreshTouchAffordanceGlassPanePosition()}return e},C.prototype._createTableBodyRowTouchSelectionAffordance=function(e){var t=this._createTouchAffordanceGlassPane(),o=this._getTableBodyRowTouchSelectionAffordanceTop();if(!o){(o=document.createElement(C.DOM_ELEMENT._DIV)).classList.add(C.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOP_CLASS),o.classList.add(C.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOUCH_AREA_CLASS);var n=document.createElement(C.DOM_ELEMENT._DIV);n.classList.add(C.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOP_ICON_CLASS),n.setAttribute(C.DOM_ATTR._ROLE,"button"),n.setAttribute(C.DOM_ATTR._ARIA_LABEL,this.getTranslatedString("labelAccSelectionAffordanceTop")),o.appendChild(n),t.appendChild(o)}var i=this._getTableBodyRowTouchSelectionAffordanceBottom();if(!i){(i=document.createElement(C.DOM_ELEMENT._DIV)).classList.add(C.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_BOTTOM_CLASS),i.classList.add(C.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOUCH_AREA_CLASS);var l=document.createElement(C.DOM_ELEMENT._DIV);l.classList.add(C.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_BOTTOM_ICON_CLASS),l.setAttribute(C.DOM_ATTR._ROLE,"button"),l.setAttribute(C.DOM_ATTR._ARIA_LABEL,this.getTranslatedString("labelAccSelectionAffordanceBottom")),i.appendChild(l),t.appendChild(i)}this._moveTableBodyRowTouchSelectionAffordanceTop(e),this._moveTableBodyRowTouchSelectionAffordanceBottom(e)},C.prototype._createTableBottomSlot=function(){var e=this._getTableContainer(),t=document.createElement(C.DOM_ELEMENT._DIV);return t.classList.add(C.CSS_CLASSES._TABLE_BOTTOM_SLOT_CLASS),e.appendChild(t),this._cacheDomElement(C.CSS_CLASSES._TABLE_BOTTOM_SLOT_CLASS,t),t},C.prototype._createTableContainer=function(){var e=this.OuterWrapper;return e||(e=document.createElement(C.DOM_ELEMENT._DIV),this.element[0].parentNode.replaceChild(e,this.element[0]),e.insertBefore(this.element[0],e.firstChild)),this._cacheDomElement(C.CSS_CLASSES._TABLE_CONTAINER_CLASS,e),e.classList.add(C.CSS_CLASSES._TABLE_CLASS),e.classList.add(C.CSS_CLASSES._TABLE_CONTAINER_CLASS),e.classList.add(C.MARKER_STYLE_CLASSES._WIDGET),e},C.prototype._createTableFooter=function(){var e=this._getTable(),t=document.createElement(C.DOM_ELEMENT._TFOOT),o=document.createElement(C.DOM_ELEMENT._TR);t.appendChild(o);var n=this._getTableHeader();if(null!=n)n.parentNode.insertBefore(t,n.nextSibling);else{var i=this._getTableBody();null!=i?i.parentNode.insertBefore(t,i):e.appendChild(t)}return this._cacheDomElement(C.CSS_CLASSES._TABLE_FOOTER_CLASS,t),t},C.prototype._createTableFooterCell=function(){return document.createElement(C.DOM_ELEMENT._TD)},C.prototype._createTableHeader=function(){var e=this._getTable(),t=document.createElement(C.DOM_ELEMENT._THEAD),o=document.createElement(C.DOM_ELEMENT._TR);t.appendChild(o);var n=this._getTableFooter();if(null!=n)n.parentNode.insertBefore(t,n);else{var i=this._getTableBody();null!=i?i.parentNode.insertBefore(t,i):e.appendChild(t)}return this._cacheDomElement(C.CSS_CLASSES._TABLE_HEADER_ROW_CLASS,o),this._cacheDomElement(C.CSS_CLASSES._TABLE_HEADER_CLASS,t),t},C.prototype._createTableHeaderColumn=function(e){var t=this._getColumnDefs()[e],o=document.createElement(C.DOM_ELEMENT._TH);this._styleTableHeaderColumn(e,o,!0),o.setAttribute("abbr",t.headerText),o.setAttribute(C.DOM_ATTR._TITLE,t.headerText),this._insertTableHeaderColumn(e,o);var n={columnIndex:e,headerContext:{component:this,parentElement:o}};return t.resizable===C._OPTION_ENABLED&&o.setAttribute("data-oj-resizable",C._OPTION_ENABLED),t.sortable===C._OPTION_ENABLED?(o.setAttribute("data-oj-sortable",C._OPTION_ENABLED),this._columnHeaderSortableIconRenderer(n)):this._columnHeaderDefaultRenderer(n),o},C.prototype._createTableHeaderColumnDragImage=function(e){var t=this._getTableHeaderColumn(e).cloneNode(!0);return t.classList.remove(C.MARKER_STYLE_CLASSES._DRAG),t.classList.remove(C.MARKER_STYLE_CLASSES._FOCUS),t.classList.remove(C.MARKER_STYLE_CLASSES._FOCUS_HIGHLIGHT),t.classList.remove(C.MARKER_STYLE_CLASSES._HOVER),t.classList.add(C.CSS_CLASSES._COLUMN_HEADER_DRAG_IMAGE),t.style[C.CSS_PROP._POSITION]=C.CSS_VAL._ABSOLUTE,t.style[C.CSS_PROP._TOP]="0",t.style[C.CSS_PROP._LEFT]="-999em",t.style[C.CSS_PROP._ZINDEX]="-999",document.body.appendChild(t),t},C.prototype._createTableHeaderColumnResizeIndicator=function(){var e=this._getTableHeaderColumnResizeIndicator();if(!e){var t=this._getTableContainer();e=document.createElement(C.DOM_ELEMENT._DIV),t.appendChild(e),e.classList.add(C.CSS_CLASSES._COLUMN_HEADER_RESIZE_INDICATOR_CLASS),this._cacheDomElement(C.CSS_CLASSES._COLUMN_HEADER_RESIZE_INDICATOR_CLASS,e)}return e},C.prototype.createSubId=function(e){return[this._getRootElement().id,e].join(":")},C.prototype._createTableStatusMessage=function(){var e=this._getTableContainer(),t=document.createElement(C.DOM_ELEMENT._DIV);if(t.classList.add(C.CSS_CLASSES._TABLE_STATUS_MESSAGE_CLASS),t.style[C.CSS_PROP._DISPLAY]=C.CSS_VAL._NONE,!this._isSkeletonSupport()){var o=document.createElement(C.DOM_ELEMENT._DIV);o.classList.add(C.CSS_CLASSES._ICON_CLASS),o.classList.add(C.CSS_CLASSES._TABLE_LOADING_ICON_CLASS),o.setAttribute("aria-label",this.getTranslatedString(C._BUNDLE_KEY._MSG_FETCHING_DATA)),t.appendChild(o)}return e.appendChild(t),this._cacheDomElement(C.CSS_CLASSES._TABLE_STATUS_MESSAGE_CLASS,t),t},C.prototype._displayDragOverIndicatorColumn=function(e,t){this._removeDragOverIndicatorColumn();var o=this._getTableHeaderRow(),n=this._getTableHeaderColumn(e);if(null!=n)t?n.classList.add(C.CSS_CLASSES._COLUMN_HEADER_DRAG_INDICATOR_BEFORE_CLASS):n.classList.add(C.CSS_CLASSES._COLUMN_HEADER_DRAG_INDICATOR_AFTER_CLASS);else{var i=this._getColumnDefs();null!=i&&0!==i.length||(t?o.classList.add(C.CSS_CLASSES._COLUMN_HEADER_DRAG_INDICATOR_BEFORE_CLASS):o.classList.add(C.CSS_CLASSES._COLUMN_HEADER_DRAG_INDICATOR_AFTER_CLASS))}},C.prototype._displayDragOverIndicatorRow=function(e,o,n){this._removeDragOverIndicatorRow();var i=document.createElement(C.DOM_ELEMENT._TR);o?i.classList.add(C.CSS_CLASSES._TABLE_DATA_ROW_DRAG_INDICATOR_BEFORE_CLASS):i.classList.add(C.CSS_CLASSES._TABLE_DATA_ROW_DRAG_INDICATOR_AFTER_CLASS),n&&t(i).height(parseInt(t(n).height(),10));var l=document.createElement(C.DOM_ELEMENT._TD),s=this._getColumnDefs().length;this._isDefaultSelectorEnabled()&&(s+=1),l.setAttribute(C.DOM_ATTR._COLSPAN,s),i.appendChild(l);var a=this._getTableBodyRow(e);null!=a?o?a.parentNode.insertBefore(i,a):a.parentNode.insertBefore(i,a.nextSibling):(0===this._getTableBodyRows().length&&this._hideNoDataMessage(),this._getTableBody().appendChild(i))},C.prototype._getContextMenuElement=function(){return this._menuContainer},C.prototype._getContextMenuResizePopup=function(){var e=this._getTableId()+"_resize_popup";if(!this._isCachedDomElement(e)){var t=document.getElementById(e);this._cacheDomElement(e,t)}return this._getCachedDomElement(e)},C.prototype._getElementColumnIdx=function(e){var o=this._getFirstAncestor(e,"."+C.CSS_CLASSES._TABLE_DATA_CELL_CLASS,!0);if(null!=o)return t(o.parentNode).children("."+C.CSS_CLASSES._TABLE_DATA_CELL_CLASS).index(o);var n=this._getFirstAncestor(e,"."+C.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS,!0);if(null!=n)return t(n.parentNode).children("."+C.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS).index(n);var i=this._getFirstAncestor(e,"."+C.CSS_CLASSES._TABLE_FOOTER_CELL_CLASS,!0);return null!=i?t(i.parentNode).children("."+C.CSS_CLASSES._TABLE_FOOTER_CELL_CLASS).index(i):null},C.prototype._getElementRowIdx=function(e){var o=this._getFirstAncestor(e,"."+C.CSS_CLASSES._TABLE_DATA_ROW_CLASS,!0);if(null!=o){var n=this._getTableBodyRows(),i=t(n).index(o);return i>-1?i:null}return null},C.prototype._getFirstAncestor=function(e,o,n){var i;if(null==e)return null;if(this._isIE()&&!Element.prototype.matches?e.msMatchesSelector(o):e.matches(o))return n&&!this._isTableOwned(e)?this._getFirstAncestor(e.parentNode,o,n):e;if(i=t(e).parents(o),n){for(var l=0;l<i.length;l++)if(this._isTableOwned(i[l]))return i[l];return null}return i.length>0?i[0]:null},C.prototype._getScrollBarHeight=function(){return this._tableWidthConstrained?this._getDefaultScrollBarSize():0},C.prototype._getScrollBarWidth=function(){return this._tableHeightConstrained&&!this._isVerticalScrollBarHidden()?this._getDefaultScrollBarSize():0},C.prototype._getDefaultScrollBarSize=function(){return null==this._defaultScrollBarSize&&(this._defaultScrollBarSize=a.getDefaultScrollBarWidth(this._getScroller())),this._defaultScrollBarSize},C.prototype._isVerticalScrollBarHidden=function(){return!this._isTouchDevice()&&this._getTableContainer().classList.contains(C.MARKER_STYLE_CLASSES._HIDE_VERTICAL_SCROLLBAR)},C.prototype._getScroller=function(){return this._getTableBody()},C.prototype._getScrollLeft=function(e){var t=e.scrollLeft;"rtl"===this._GetReadingDirection()&&(t=Math.abs(t),this._isWebkit()&&(t=e.scrollWidth-e.clientWidth-t));return t},C.prototype._getTable=function(){return this.element[0]},C.prototype._getTableBody=function(){return this._getTableElementByClassName(C.CSS_CLASSES._TABLE_BODY_CLASS,!0)},C.prototype._getTableBodyCell=function(e,t,o){var n=this._getTableBodyCells(e,o);return n&&n.length>t?n[t]:null},C.prototype._getTableBodyLogicalCells=function(e,t){var o=this._getTableBodyCells(e,t);return o?this._getColspanLogicalElements(o):null},C.prototype._getTableBodyCells=function(e,t){if(t||(t=this._getTableBodyRow(e)),!t)return null;var o=this._getTableElementsByClassName(t,C.CSS_CLASSES._TABLE_DATA_CELL_CLASS);return o.length>0?o:null},C.prototype._getTableBodyMessageCell=function(){var e=this._getTableBody();if(e){var t=this._getTableElementsByClassName(e,C.CSS_CLASSES._TABLE_BODY_MESSAGE_CLASS);if(t.length>0)return t[0]}return null},C.prototype._getTableBodyMessageRow=function(){var e=this._getTableBody();if(e){var t=this._getTableElementsByClassName(e,C.CSS_CLASSES._TABLE_BODY_MESSAGE_ROW_CLASS);if(t.length>0)return t[0]}return null},C.prototype._getTableBodyRow=function(e){var t=this._getTableBodyRows();return null!=e&&t.length>e?t[e]:null},C.prototype._getTableBodyRows=function(){if(!this._cachedDomTableBodyRows){var e=this._getTableBody();this._cachedDomTableBodyRows=null!=e?this._getTableElementsByClassName(e,C.CSS_CLASSES._TABLE_DATA_ROW_CLASS):[]}return this._cachedDomTableBodyRows},C.prototype._getTableBodyRowTouchSelectionAffordanceTop=function(){var e=this._getTableContainer(),t=this._getTableElementsByClassName(e,C.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOP_CLASS);return t.length>0?t[0]:null},C.prototype._getTableBodyRowTouchSelectionAffordanceBottom=function(){var e=this._getTableContainer(),t=this._getTableElementsByClassName(e,C.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_BOTTOM_CLASS);return t.length>0?t[0]:null},C.prototype._getTableBottomSlot=function(){return this._getTableElementByClassName(C.CSS_CLASSES._TABLE_BOTTOM_SLOT_CLASS,!0)},C.prototype._getTableContainer=function(){return this._isCachedDomElement(C.CSS_CLASSES._TABLE_CONTAINER_CLASS)||this._cacheDomElement(C.CSS_CLASSES._TABLE_CONTAINER_CLASS,this.element[0].parentNode),this._getCachedDomElement(C.CSS_CLASSES._TABLE_CONTAINER_CLASS)},C.prototype._getTableFooter=function(){return this._getTableElementByClassName(C.CSS_CLASSES._TABLE_FOOTER_CLASS,!0)},C.prototype._getTableFooterCell=function(e){var t=this._getTableFooterCells();return null!=t&&t.length>e?t[e]:null},C.prototype._getTableFooterCells=function(){var e=this._getTableFooterRow(),t=null!=e?this._getTableElementsByClassName(e,C.CSS_CLASSES._TABLE_FOOTER_CELL_CLASS):null;return null!=t&&t.length>0?t:null},C.prototype._getTableFooterLogicalCells=function(){var e=this._getTableFooterCells();return e?this._getColspanLogicalElements(e):null},C.prototype._getTableFooterRow=function(){return this._getTableElementByClassName(C.CSS_CLASSES._TABLE_FOOTER_ROW_CLASS)},C.prototype._getTableHeader=function(){return this._getTableElementByClassName(C.CSS_CLASSES._TABLE_HEADER_CLASS,!0)},C.prototype._getTableHeaderColumn=function(e){var t=this._getTableHeaderColumns();return t&&t.length>e&&e>=0?t[e]:null},C.prototype._getTableHeaderColumnResizeIndicator=function(){return this._getTableElementByClassName(C.CSS_CLASSES._COLUMN_HEADER_RESIZE_INDICATOR_CLASS,!0)},C.prototype._getTableHeaderColumns=function(){var e=this._getTableHeaderRow();if(null!=e){var t=this._getTableElementsByClassName(e,C.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS);if(t.length>0)return t}return null},C.prototype._getTableHeaderLogicalColumns=function(){var e=this._getTableHeaderColumns();return e?this._getColspanLogicalElements(e):null},C.prototype._getTableHeaderRow=function(){return this._getTableElementByClassName(C.CSS_CLASSES._TABLE_HEADER_ROW_CLASS)},C.prototype._getTableId=function(){if(!this._tableId){var e=this._IsCustomElement()?this._getTableContainer():this._getTable();this._tableId=e.getAttribute(C.DOM_ATTR._ID)}return this._tableId},C.prototype._getTableStatusMessage=function(){return this._getTableElementByClassName(C.CSS_CLASSES._TABLE_STATUS_MESSAGE_CLASS,!0)},C.prototype._getTableUID=function(){if(!this._tableUID){var e=this._getTableId();null==e&&(e=(1e32*Math.random()).toString(36)),this._tableUID=e}return this._tableUID},C.prototype._hashCode=function(e){if(null==e)return 0;"string"!==t.type(e)&&(e=e.toString());var o=0;if(0===e.length)return o;for(var n=e.length,i=0;i<n;i++){o=(o<<5)-o+e.charCodeAt(i),o&=o}return o},C.prototype._insertTableBodyCell=function(e,t,o,n,i,l,s){if(this._setTableBodyCellAttributes(e,t,o,n,i),s)return l.appendChild(i),i;if(0===n)l.insertBefore(i,l.firstChild);else{var a=this._getTableElementsByClassName(l,C.CSS_CLASSES._TABLE_DATA_CELL_CLASS);if(a.length>=n){var r=a[n-1];r.parentNode.insertBefore(i,r.nextSibling)}else l.appendChild(i)}return i},C.prototype._insertTableBodyRow=function(e,t,o,n){if(this._setTableBodyRowAttributes(o,t),null==n){var i=this._getTableBody(),l=this._getTableBodyRows();if(0===e)i.insertBefore(t,i.firstChild);else if(l.length>=e){var s=l[e-1];s.parentNode.insertBefore(t,s.nextSibling)}else i.appendChild(t)}else n.appendChild(t);this._clearCachedDomRowData()},C.prototype._insertTableFooterCell=function(e,t){var o=this._getTableFooterRow(),n=this._getTableElementsByClassName(o,C.CSS_CLASSES._TABLE_FOOTER_CELL_CLASS);if(0===e)o.insertBefore(t,o.firstChild);else if(o.length>=e){var i=n[e-1];i.parentNode.insertBefore(t,i.nextSibling)}else o.appendChild(t);return t},C.prototype._insertTableHeaderColumn=function(e,o){var n=this._getTableHeaderRow(),i=this._getTableHeaderColumns();this._setTableHeaderColumnAttributes(e,o);var l=this._getTableHeaderColumn(e);if(l)t(l).replaceWith(t(o));else if(0!==e&&i&&i.length>=e){var s=i[e-1];s.parentNode.insertBefore(o,s.nextSibling)}else n.appendChild(o)},C.prototype._getTableContainerScrollableState=function(e){var t=this._getTableContainer(),o=this._getTable(),n=[];if(t.clientHeight>0){var i=o.offsetHeight+e;i>t.clientHeight?n[0]=1:t.clientHeight-i>0?n[0]=-1:n[0]=0}else n[0]=0;return t.clientWidth>0?o.offsetWidth>t.clientWidth?n[1]=1:t.clientWidth-o.offsetWidth>0?n[1]=-1:n[1]=0:n[1]=0,n},C.prototype._moveTableBodyRowTouchSelectionAffordanceTop=function(e){var o=this._getTableBodyRowTouchSelectionAffordanceTop();if(null!=o){null!=e?(t(o).data("rowIdx",e),t(o.children[0]).data("rowIdx",e)):e=t(o).data("rowIdx");var n=this._getTableBody(),i=this._getTableBodyRow(e).getBoundingClientRect(),l=this._getTouchAffordanceGlassPane().getBoundingClientRect();o.style[C.CSS_PROP._TOP]=i.top-l.top-o.clientHeight/2+C.CSS_VAL._PX,o.style[C.CSS_PROP._LEFT]=n.clientWidth/2+C.CSS_VAL._PX}},C.prototype._moveTableBodyRowTouchSelectionAffordanceBottom=function(e){var o=this._getTableBodyRowTouchSelectionAffordanceBottom();if(null!=o){null!=e?(t(o).data("rowIdx",e),t(o.children[0]).data("rowIdx",e)):e=t(o).data("rowIdx");var n=this._getTableBody(),i=this._getTableBodyRow(e).getBoundingClientRect(),l=this._getTouchAffordanceGlassPane().getBoundingClientRect();o.style[C.CSS_PROP._TOP]=i.top-l.top+i.height-o.clientHeight/2+C.CSS_VAL._PX,o.style[C.CSS_PROP._LEFT]=n.clientWidth/2+C.CSS_VAL._PX}},C.prototype._moveTableHeaderColumn=function(e,o,n){var i,l=this._getColumnDefs(),s=this._getTableHeaderColumn(e),a=this._getTableFooterCell(e),r=null,_=null,d=null,h=null,u=null,c=!1;o===l.length&&(o-=1,c=!0),null!=s&&(u=s.getAttribute(C.DOM_ATTR._COLSPAN),null==(_=this._getTableHeaderColumn(o))||null!=u&&1!==u||(c?_.parentNode.insertBefore(s,_.nextSibling):_.parentNode.insertBefore(s,_))),null!=a&&(u=a.getAttribute(C.DOM_ATTR._COLSPAN),null==(d=this._getTableFooterCell(o))||null!=u&&1!==u||(c?d.parentNode.insertBefore(a,d.nextSibling):d.parentNode.insertBefore(a,d)));var S=this._getTableBodyRows();for(i=0;i<S.length;i++)null!=(r=this._getTableBodyCell(i,e,null))&&(h=this._getTableBodyCell(i,o,null),u=r.getAttribute(C.DOM_ATTR._COLSPAN),null==h||null!=u&&1!==u||(c?h.parentNode.insertBefore(r,h.nextSibling):h.parentNode.insertBefore(r,h)));var E=[],T=this.options.columns.length;for(i=0;i<T;i++)E[i]=t.extend({},{},this.options.columns[i]);var p=e<o&&!c?o-1:o,g=E.splice(e,1);E.splice(p,0,g[0]);var f=this._columnDefArray.splice(e,1);if(this._columnDefArray.splice(p,0,f[0]),!this._columnsDestMap)for(this._columnsDestMap=[],i=0;i<E.length;i++)this._columnsDestMap[i]=i;var m=this._columnsDestMap.splice(e,1);return this._columnsDestMap.splice(p,0,m[0]),this.option("columns",E,{_context:{writeback:!0,originalEvent:n,internalSet:!0}}),this._queueTask(function(){}),this._columnsDestMap},C.prototype._refreshContextMenu=function(){var e=this._menuContainer;if(e)for(var o=e.querySelectorAll("[data-oj-command]"),n=0;n<o.length;n++){var i=t(o[n]).children(C.DOM_ELEMENT._A);if(0===i.length&&"OJ-OPTION"===o[n].tagName&&(i=t(o[n])),i.length>0){var l,s=o[n].getAttribute("data-oj-command").split("-");"sort"===(s=s[s.length-1])?l=this.getTranslatedString("labelSort"):"sortAsc"===s?l=this.getTranslatedString("labelSortAsc"):"sortDsc"===s?l=this.getTranslatedString("labelSortDsc"):"resize"===s&&(l=this.getTranslatedString("labelResize")),i.contents().filter(function(){return 3===this.nodeType})[0].nodeValue=l}}},C.prototype._removeDragOverIndicatorColumn=function(){for(var e=this._tableQuerySelectorAll(this._getTable(),"."+C.CSS_CLASSES._COLUMN_HEADER_DRAG_INDICATOR_BEFORE_CLASS+",."+C.CSS_CLASSES._COLUMN_HEADER_DRAG_INDICATOR_AFTER_CLASS),t=e.length,o=0;o<t;o++)e[o].classList.remove(C.CSS_CLASSES._COLUMN_HEADER_DRAG_INDICATOR_BEFORE_CLASS),e[o].classList.remove(C.CSS_CLASSES._COLUMN_HEADER_DRAG_INDICATOR_AFTER_CLASS)},C.prototype._removeDragOverIndicatorRow=function(){var e,o=this._getTableBody(),n=this._getTableElementsByClassName(o,C.CSS_CLASSES._TABLE_DATA_ROW_DRAG_INDICATOR_BEFORE_CLASS),i=this._getTableElementsByClassName(o,C.CSS_CLASSES._TABLE_DATA_ROW_DRAG_INDICATOR_AFTER_CLASS),l=n.length;for(e=0;e<l;e++)t(n[e]).remove();var s=i.length;for(e=0;e<s;e++)t(i[e]).remove();0===this._getTableBodyRows().length&&this._showNoDataMessage()},C.prototype._removeTableBodyRow=function(e){var o=this._getTableBodyRow(e);null!=o&&(s.subtreeDetached(o),(this._hasCellTemplate||this._hasRowTemplate)&&this._cleanTemplateNodes(o),t(o).remove(),this._clearCachedDomRowData())},C.prototype._removeAllTableBodyRows=function(){if(this._getTableBodyRows().length>0){var e=this._getTableBody();null!=e&&(s.subtreeDetached(e),(this._hasCellTemplate||this._hasRowTemplate)&&(this._cleanTemplateNodes(e),this._hasCellTemplate=!1,this._hasRowTemplate=!1,this._registerDomEventListeners()),t(e).empty()),this._clearCachedDomRowData()}},C.prototype._removeTableBodyRowTouchSelectionAffordance=function(){for(var e=this._getTableContainer(),o=this._getTableElementsByClassName(e,C.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOUCH_AREA_CLASS),n=0;n<o.length;n++)t(o[n]).remove()},C.prototype._removeTableHeaderColumnDragImage=function(){for(var e=this._getTableContainer(),o=this._getTableElementsByClassName(e,C.CSS_CLASSES._COLUMN_HEADER_DRAG_IMAGE),n=o.length,i=0;i<n;i++)t(o[i]).remove()},C.prototype._removeTableHeaderColumnResizeIndicator=function(){var e=this._getTableHeaderColumnResizeIndicator();e&&(t(e).remove(),this._clearDomCache(C.CSS_CLASSES._COLUMN_HEADER_RESIZE_INDICATOR_CLASS))},C.prototype._setScrollLeft=function(e,t){"rtl"===this._GetReadingDirection()&&(t=Math.abs(t),this._isWebkit()?t=e.scrollWidth-e.clientWidth-t:this._isFF()&&(t*=-1));e.scrollLeft!==t&&(e.scrollLeft=t)},C.prototype._setTableBodyCellAttributes=function(e,t,o,n,i){var l=i.getAttribute(C.DOM_ATTR._ID);if(!(null!=l&&l.length>0)){var s=this.options.accessibility,a=this._getColumnDefs()[n];if(null!=a){var r=null,_=this._isTableHeaderless();r=null!=s&&null!=s.rowHeader?s.rowHeader:this._getColumnDefs()[0].id;var d=null!=t?t.toString():e.toString(),h=null==o?this._hashCode(d):o,u=this._getTableId()+":"+r+"_"+h,c=this._getTableId()+":"+a.id;r===a.id?(l=u,_&&(c="")):(l=u+"_"+n,c=_?u:c+" "+u),i.setAttribute(C.DOM_ATTR._ID,l),i.getAttribute(C.DOM_ATTR._HEADERS)||i.setAttribute(C.DOM_ATTR._HEADERS,c)}}},C.prototype._setTableBodyRowAttributes=function(e,o){t(o).data("rowKey",e.key),t(o).data("rowData",e.data),t(o).data("rowMetadata",e.metadata)},C.prototype._setTableHeaderColumnAttributes=function(e,t){var o=this._getColumnDefs()[e];t.getAttribute(C.DOM_ATTR._ID)||t.setAttribute(C.DOM_ATTR._ID,this._getTableId()+":"+o.id)},C.prototype._setTableColumnCellsClass=function(e,t,o){var n,i=this._getTableBodyRows();if(i.length>0)if(null===e){var l=null,s=this._getTableBody();if(null!=(l=t?this._getTableElementsByTagName(s,C.DOM_ELEMENT._TD):this._getTableElementsByClassName(s,o))&&l.length>0){var a=l.length;for(n=0;n<a;n++)t?l[n].classList.add(o):l[n].classList.remove(o)}}else{var r=i.length;for(n=0;n<r;n++){var _=this._getTableBodyCell(n,e,null);t?_.classList.add(o):_.classList.remove(o)}}},C.prototype._setTableBodyMessage=function(e){var o=this._getTableBodyMessageCell();t(o).empty(),o.appendChild(document.createTextNode(e))},C.prototype._styleInitialTable=function(){var e=this._getTable(),t=this._getTableElementsByTagName(e,C.DOM_ELEMENT._THEAD);t=t.length>0?t[0]:null;var o=this._getTableElementsByTagName(e,C.DOM_ELEMENT._TFOOT);o=o.length>0?o[0]:null;var n=this._getTableElementsByTagName(e,C.DOM_ELEMENT._TBODY);if(n=n.length>0?n[0]:null,-1!==parseInt(this._getRootElement().getAttribute(C.DOM_ATTR._TABINDEX),10))e.setAttribute(C.DOM_ATTR._TABINDEX,"0"),this._focusable({element:e,applyHighlight:!0,setupHandlers:this._focusSetupHandlers.bind(this)});else{e.setAttribute(C.DOM_ATTR._TABINDEX,"-1");var i=function(){};this._focusSetupHandlers(i,i)}e.setAttribute(C.DOM_ATTR._ARIA_LABELLEDBY,this._getTableContainer().id),this._styleTableHeader(t),this._styleTableFooter(o),this._styleTableBody(n),this._styleTableContainer(this._getTableContainer())},C.prototype._styleTableBody=function(e){e.classList.add(C.CSS_CLASSES._TABLE_BODY_CLASS),e.setAttribute(s._OJ_CONTAINER_ATTR,this.widgetName)},C.prototype._styleTableBodyCell=function(e,o,n){var i=this._getColumnDefs()[e];!n&&o.classList.contains(C.CSS_CLASSES._TABLE_DATA_CELL_CLASS)||(o.classList.add(C.CSS_CLASSES._TABLE_DATA_CELL_CLASS),o.classList.add(C.CSS_CLASSES._TABLE_DATE_CELL_FORM_CONTROL_CLASS));var l=o.getAttribute(C.DOM_ATTR._STYLE)||{};null==i||null==i.style||!n&&l===i.style||a.applyMergedInlineStyles(o,l,i.style),null==i||null==i.className||!n&&t(o).hasClass(i.className)||t(o).addClass(i.className),!this._isVerticalGridEnabled()||!n&&o.classList.contains(C.CSS_CLASSES._TABLE_VGRID_LINES_CLASS)||o.classList.add(C.CSS_CLASSES._TABLE_VGRID_LINES_CLASS)},C.prototype._styleTableBodyRow=function(e,t){e.setAttribute(o._OJ_CONTEXT_ATTRIBUTE,""),!t&&e.classList.contains(C.CSS_CLASSES._TABLE_DATA_ROW_CLASS)||e.classList.add(C.CSS_CLASSES._TABLE_DATA_ROW_CLASS)},C.prototype._styleTableContainer=function(e){this.options.display===C._OPTION_DISPLAY._GRID?e.classList.add(C.CSS_CLASSES._TABLE_COMPACT_CLASS):e.classList.remove(C.CSS_CLASSES._TABLE_COMPACT_CLASS);var t=this.options.editMode;null!=t&&t!==C._OPTION_EDIT_MODE._NONE?e.classList.add(C.CSS_CLASSES._TABLE_EDIT_CLASS):e.classList.remove(C.CSS_CLASSES._TABLE_EDIT_CLASS),this._isHorizontalGridEnabled()?e.classList.add(C.CSS_CLASSES._TABLE_HGRID_CLASS):e.classList.remove(C.CSS_CLASSES._TABLE_HGRID_CLASS)},C.prototype._styleTableFooter=function(e){if(e){e.classList.add(C.CSS_CLASSES._TABLE_FOOTER_CLASS);var t=this._getTableElementsByTagName(e,C.DOM_ELEMENT._TR)[0];t.classList.add(C.CSS_CLASSES._TABLE_FOOTER_ROW_CLASS),t.setAttribute(o._OJ_CONTEXT_ATTRIBUTE,"")}},C.prototype._styleTableFooterCell=function(e,o){var n=this._getColumnDefs()[e],i=o.getAttribute(C.DOM_ATTR._STYLE)||{};null!=n.footerStyle&&i!==n.footerStyle&&a.applyMergedInlineStyles(o,i,n.footerStyle),o.classList.contains(C.CSS_CLASSES._TABLE_FOOTER_CELL_CLASS)||o.classList.add(C.CSS_CLASSES._TABLE_FOOTER_CELL_CLASS),this._isVerticalGridEnabled()&&!o.classList.contains(C.CSS_CLASSES._TABLE_VGRID_LINES_CLASS)&&o.classList.add(C.CSS_CLASSES._TABLE_VGRID_LINES_CLASS),n.footerClassName&&t(o).addClass(n.footerClassName)},C.prototype._styleTableHeader=function(e){if(e){e.classList.add(C.CSS_CLASSES._TABLE_HEADER_CLASS),e.style[C.CSS_PROP._DISPLAY]="table-header-group";var t=this._getTableElementsByTagName(e,C.DOM_ELEMENT._TR)[0];t.classList.add(C.CSS_CLASSES._TABLE_HEADER_ROW_CLASS),t.style[C.CSS_PROP._POSITION]=C.CSS_VAL._RELATIVE,t.setAttribute(o._OJ_CONTEXT_ATTRIBUTE,"")}},C.prototype._styleTableHeaderColumn=function(e,o,n){var i=this._getColumnDefs()[e];!n&&o.classList.contains(C.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS)||o.classList.add(C.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS),i.sortable===C._OPTION_ENABLED&&o.classList.add(C.CSS_CLASSES._TABLE_SORT_CLASS),this._isVerticalGridEnabled()&&(!n&&o.classList.contains(C.CSS_CLASSES._TABLE_VGRID_LINES_CLASS)||o.classList.add(C.CSS_CLASSES._TABLE_VGRID_LINES_CLASS));var l=o.getAttribute(C.DOM_ATTR._STYLE)||{};null==i.headerStyle||!n&&l===i.headerStyle||a.applyMergedInlineStyles(o,l,i.headerStyle),null==i.headerClassName||!n&&t(o).hasClass(i.headerClassName)||t(o).addClass(i.headerClassName)},C.prototype._getColspanLogicalElements=function(e){for(var t=0,o=[],n=e.length,i=0;i<n;i++){var l=e[i].getAttribute(C.DOM_ATTR._COLSPAN);if(null!=l){l=parseInt(l,10);for(var s=0;s<l;s++)o[t+s]=e[i];t+=l}else o[t]=e[i],t+=1}return o},C.prototype._isHorizontalGridEnabled=function(){return this.options.horizontalGridVisible===C._OPTION_ENABLED||this.options.horizontalGridVisible===C._OPTION_AUTO},C.prototype._isVerticalGridEnabled=function(){return this.options.verticalGridVisible===C._OPTION_ENABLED||this.options.verticalGridVisible===C._OPTION_AUTO&&this.options.display===C._OPTION_DISPLAY._GRID},C.prototype._isFF=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},C.prototype._isIE=function(){if(void 0===this._browserIsIE){var e=navigator.userAgent;if("Microsoft Internet Explorer"===navigator.appName){var t=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e);null!=t&&(this._browserIsIE=parseFloat(t[1]))}else e.indexOf("Trident")>=0?this._browserIsIE=11:this._browserIsIE=null}return this._browserIsIE},C.prototype._isWebkit=function(){if(void 0===this._browserIsWebkit){var e=navigator.userAgent.toLowerCase();this._browserIsWebkit=/webkit/.test(e)&&!/edge/.test(e)}return this._browserIsWebkit},C.prototype._isSizingRefreshRequired=function(e,t){if(null!=e&&null!=t)return null!=this._cacheDomDimensions?e>0&&t>0&&(e!==this._cacheDomDimensions.tableContainerWidth||t!==this._cacheDomDimensions.tableContainerHeight):e>0&&t>0;var o=this._getTableContainer();return o.offsetWidth>0&&o.offsetHeight>0},C.prototype._refreshTableDimensions=function(e,o,n){if(n||this._isSizingRefreshRequired(e,o)){var i,l=this._getTable(),s=this._getTableContainer(),a=this._getTableHeader(),r=this._getTableBody(),_=this._getTableFooter(),d=this._getTableBottomSlot(),h=null,u=null;null!=this._scrollTop&&this._scrollTop>0&&(h=this._scrollTop),null!=this._scrollLeft&&this._scrollLeft>0&&(u=this._scrollLeft),this._clearCachedDimensions(),this._removeTableDimensionsStyling(),this._styleTableContainer(s),this._setForcedColumnWidths(),i=null!=d&&d.clientHeight>0&&d.style[C.CSS_PROP._DISPLAY]!==C.CSS_VAL._NONE?d.offsetHeight:0;var c=this._getTableContainerScrollableState(i);if(1===c[0]?this._tableHeightConstrained=!0:this._tableHeightConstrained=!1,1===c[1]?this._tableWidthConstrained=!0:this._tableWidthConstrained=!1,null!=r){var S=r.offsetHeight-r.clientHeight;if(this._tableHeightConstrained||this._tableWidthConstrained){s.classList.add(C.CSS_CLASSES._TABLE_SCROLL_CLASS);var E=s.clientWidth,T=s.clientHeight,p=this._getDefaultScrollBarSize();p>0&&(this._tableWidthConstrained||this._isVerticalScrollBarHidden()?this._tableHeightConstrained||(l.style[C.CSS_PROP._HEIGHT]=T+p-i+C.CSS_VAL._PX,s.clientHeight<T+p?(T=s.clientHeight,l.style[C.CSS_PROP._HEIGHT]=T-p-i+C.CSS_VAL._PX,T-p<l.clientHeight+i&&(this._tableHeightConstrained=!0)):(T=s.clientHeight,l.style[C.CSS_PROP._HEIGHT]="")):(l.style[C.CSS_PROP._WIDTH]=E+p+C.CSS_VAL._PX,s.clientWidth<E+p?(E=s.clientWidth,l.style[C.CSS_PROP._WIDTH]=E-p+C.CSS_VAL._PX,E-p<l.clientWidth&&(this._tableWidthConstrained=!0)):(E=s.clientWidth,l.style[C.CSS_PROP._WIDTH]=""))),this._tableHeightConstrained&&this._isVerticalScrollBarHidden()&&(r.style[C.CSS_PROP._OVERFLOW_Y]="hidden");var g=this._getScrollBarWidth();if(this._setColumnWidths(g),this._tableHeightConstrained){s.classList.add(C.CSS_CLASSES._TABLE_SCROLL_VERTICAL_CLASS);var f=l.querySelector("tr."+C.CSS_CLASSES._TABLE_NO_DATA_CONTAINER_CLASS);null!=f&&f.classList.add(C.CSS_CLASSES._TABLE_NO_DATA_ROW_CLASS)}this._tableWidthConstrained&&s.classList.add(C.CSS_CLASSES._TABLE_SCROLL_HORIZONTAL_CLASS);var m=0,A=this._getTableElementsByTagName(l,"caption");if(A.length>0&&(m=(A=A[0]).offsetHeight,A.style[C.CSS_PROP._DISPLAY]=C.CSS_VAL._INLINE,null!=a)){var R=window.getComputedStyle(s);a.style[C.CSS_PROP._BORDER_TOP]=R[C.CSS_PROP._BORDER_TOP]}var b=0;null!=a&&(b=a.offsetHeight),r.style[C.CSS_PROP._WIDTH]=E+C.CSS_VAL._PX;var y=0;null!=_&&(y=_.offsetHeight,r.style[C.CSS_PROP._TOP]=-1*y+C.CSS_VAL._PX);var L=T-b-y-m-i-S;if(L>0&&(r.style[C.CSS_PROP._HEIGHT]=L+C.CSS_VAL._PX,r.style[C.CSS_PROP._MIN_HEIGHT]=L+C.CSS_VAL._PX),this._tableWidthConstrained)if(0===this._getTableBodyRows().length){var D=this._getTableBodyMessageCell();if(D){var v=D.offsetWidth;null!=a&&(v=Math.max(v,a.offsetWidth)),null!=_&&(v=Math.max(v,_.offsetWidth)),this._applyForcedColumnWidth(D,v)}}null!=a&&(a.style[C.CSS_PROP._WIDTH]=E-g+C.CSS_VAL._PX),null!=_&&(_.style[C.CSS_PROP._TOP]=L+C.CSS_VAL._PX,_.style[C.CSS_PROP._WIDTH]=E-g+C.CSS_VAL._PX)}else{if(this._isTableColumnsWidthSet()&&this._setColumnWidths(0),i>0)s.clientHeight-i!==l.offsetHeight&&(d.style[C.CSS_PROP._BOTTOM]=0,d.style[C.CSS_PROP._POSITION]=C.CSS_VAL._ABSOLUTE)}if(this._setHeaderColumnOverflowWidths(),this._isStatusMessageShown()&&this._refreshTableStatusPosition(),this._refreshTouchAffordanceGlassPanePosition(),null!=h){var O=this._getScroller().scrollHeight-this._getScroller().clientHeight;h=h>O?O:h,this._isLoadMoreOnScroll()&&O===h&&(h-=1),this._skipScrollUpdate=!0,this._getScroller().scrollTop=h,t(this._getScroller()).scroll()}null!=u&&(this._skipScrollUpdate=!0,this._setScrollLeft(this._getScroller(),u),t(this._getScroller()).scroll()),this._cacheDomDimensions.tableContainerWidth=s.offsetWidth,this._cacheDomDimensions.tableContainerHeight=s.offsetHeight,this._tableDimensionsInitialized=!0,r&&(r.style[C.CSS_PROP._VISIBILITY]=""),_&&(_.style[C.CSS_PROP._VISIBILITY]="")}}},C.prototype._refreshTouchAffordanceGlassPanePosition=function(){var e=this._getTouchAffordanceGlassPane();if(e){var t=this._getTableBody().getBoundingClientRect(),o=this._getTableContainer().getBoundingClientRect();e.style[C.CSS_PROP._TOP]=t.top-o.top+C.CSS_VAL._PX,e.style[C.CSS_PROP._BOTTOM]=t.bottom-o.bottom+C.CSS_VAL._PX,this._moveTableBodyRowTouchSelectionAffordanceTop(),this._moveTableBodyRowTouchSelectionAffordanceBottom()}},C.prototype._refreshTableStatusPosition=function(e){var t=this._getTableContainer(),o=t.clientHeight,n=this._getTableStatusMessage(),i=0,l=o,s=this._getTableHeader();if(null!=s){var a=s.offsetHeight;i=a,l-=a}var r=this._getTableFooter();null!=r&&(l-=r.offsetHeight);var _=this._getTableBottomSlot();if(null!=_&&(l-=_.offsetHeight),this._isSkeletonSupport()){var d=0,h=this._getDefaultSkeletonDimension();h.width>0&&h.height>0&&(d=Math.max(1,Math.ceil(l/h.height)));for(var u=0;u<d;u++)n.appendChild(this._createSkeletonRow());this._skeletonFadeInEndListener=function(){n.classList.remove("oj-animation-skeleton-fade-in"),n.querySelectorAll(".oj-table-skeleton-row").forEach(function(e){e.classList.add("oj-animation-skeleton")}),n.removeEventListener("animationend",this._skeletonFadeInEndListener)}.bind(this),n.addEventListener("animationend",this._skeletonFadeInEndListener),n.classList.add("oj-animation-skeleton-fade-in")}else l<=40&&(i=0,l=o);if(n.style[C.CSS_PROP._TOP]=i+C.CSS_VAL._PX,n.style[C.CSS_PROP._HEIGHT]=l+C.CSS_VAL._PX,n.style[C.CSS_PROP._WIDTH]=t.clientWidth+C.CSS_VAL._PX,e&&(n.style[C.CSS_PROP._DISPLAY]=C.CSS_VAL._INLINE,this._statusMessageShown=!0),!this._isSkeletonSupport()){var c=n.children[0];c.style[C.CSS_PROP._TOP]=(l-c.offsetHeight)/2+C.CSS_VAL._PX}},C.prototype._createSkeletonRow=function(){var e=document.createElement("div");e.className="oj-table-skeleton-row-container";var t=document.createElement("div");return t.className="oj-table-skeleton-row",e.appendChild(t),e},C.prototype._getDefaultSkeletonDimension=function(){if(null==this._defaultSkeletonDim){var e=this._getTableContainer(),t=this._createSkeletonRow();t.style.visibility="hidden",t.style.display="block",e.appendChild(t);var o={width:t.offsetWidth,height:t.offsetHeight};return e.removeChild(t),o.height>0&&o.width>0&&(this._defaultSkeletonDim=o),o}return this._defaultSkeletonDim},C.prototype._cacheDomElement=function(e,t){this._domCache||(this._domCache={}),this._domCache[e]=t},C.prototype._clearDomCache=function(e){e&&this._domCache?delete this._domCache[e]:this._domCache={},this._cacheDomDimensions={}},C.prototype._getCachedDomElement=function(e){return this._domCache?this._domCache[e]:null},C.prototype._isCachedDomElement=function(e){return this._domCache||(this._domCache={}),-1!==Object.keys(this._domCache).indexOf(e)},C.prototype._getTableElementByClassName=function(e,t){if(!this._isCachedDomElement(e)){var o=this._getTableContainer();if(o)if(this._cacheDomElement(e,null),t){if(this._cacheDomElement(e,this._getChildElementByClassName(o,e)),null==this._getCachedDomElement(e)){var n=this._getTable();this._cacheDomElement(e,this._getChildElementByClassName(n,e))}}else{var i=this._getTableElementsByClassName(o,e);i.length>0&&this._cacheDomElement(e,i[0])}}return this._getCachedDomElement(e)},C.prototype._getChildElementByClassName=function(e,t){if(null!=e.childNodes&&e.childNodes.length>0)for(var o=0;o<e.childNodes.length;o++)if(null!=e.childNodes[o].classList&&e.childNodes[o].classList.contains(t))return e.childNodes[o];return null},C.prototype._getTableElementsByClassName=function(e,t,o){var n=e.getElementsByClassName(t);return this._filterTableOwnedElements(n,o?e:null)},C.prototype._getTableElementsByTagName=function(e,t,o){var n=e.getElementsByTagName(t);return this._filterTableOwnedElements(n,o?e:null)},C.prototype._tableQuerySelectorAll=function(e,t,o){var n=e.querySelectorAll(t);return this._filterTableOwnedElements(n,o?e:null)},C.prototype._filterTableOwnedElements=function(e,t){var o,n;if(t){o=t;for(var i=t.getElementsByTagName(C.DOM_ELEMENT._TABLE),l=0;l<i.length;l++)if(i[l].parentNode===t){n=i[l];break}}else o=this._getTableContainer(),n=this._getTable();return Array.prototype.filter.call(e,function(e){return this._isTableOwned(e,o,n)}.bind(this))},C.prototype._isTableOwned=function(e,t,o){var n=t||this._getTableContainer(),i=t?o:this._getTable();if(n){if(i){var l=this._getFirstAncestor(e,i.tagName);if(l===i)return!0;if(l)return!1}var s=this._getFirstAncestor(e,"."+C.CSS_CLASSES._TABLE_CONTAINER_CLASS);if(s===n)return!0;if(s)return!1;if(!n.contains(e))return!0}return!1},C.prototype._focusSetupHandlers=function(e,t){this._setFocusInHandler(e),this._setFocusOutHandler(t)},C.prototype._removeHeaderColumnAndCellColumnWidths=function(){var e,t=this._getColumnDefs().length;for(e=0;e<t;e++){var o=this._getTableHeaderColumn(e);null!=o&&(this._applyForcedColumnWidth(o,""),this._styleTableHeaderColumn(e,o))}this._unfreezeColumnWidths();var n=this._getTableBodyRows();if(n.length>0)for(e=0;e<t;e++){var i;if(null!=this._forcedWidthColumns&&!1!==this._forcedWidthColumns[e])for(var l=0;l<n.length;l++)null!==(i=this._getTableBodyCell(l,e,null))&&(this._applyForcedColumnWidth(i,""),this._styleTableBodyCell(e,i));else null!=(i=this._getTableBodyCell(0,e,null))&&(this._applyForcedColumnWidth(i,""),this._styleTableBodyCell(e,i))}for(e=0;e<t;e++){var s=this._getTableFooterCell(e);null!=s&&(this._applyForcedColumnWidth(s,""),this._styleTableFooterCell(e,s))}var a=this._getTableBodyMessageCell();a&&this._applyForcedColumnWidth(a,"")},C.prototype._removeTableDimensionsStyling=function(){var e=this._getTable(),t=this._getTableContainer(),o=this._getTableHeader(),n=this._getTableHeaderRow(),i=this._getTableFooter(),l=this._getTableFooterRow(),s=this._getTableBody(),a=this._getTableBottomSlot();if(t.classList.remove(C.CSS_CLASSES._TABLE_SCROLL_CLASS),t.classList.remove(C.CSS_CLASSES._TABLE_SCROLL_VERTICAL_CLASS),t.classList.remove(C.CSS_CLASSES._TABLE_SCROLL_HORIZONTAL_CLASS),e.removeAttribute(C.DOM_ATTR._STYLE),null!=s&&s.removeAttribute(C.DOM_ATTR._STYLE),null!=o){o.removeAttribute(C.DOM_ATTR._STYLE),n.removeAttribute(C.DOM_ATTR._STYLE);for(var r=this._getTableElementsByClassName(n,C.CSS_CLASSES._COLUMN_HEADER_TEXT_CLASS),_=r.length,d=0;d<_;d++)r[d].style[C.CSS_PROP._WIDTH]=""}null!=i&&(i.removeAttribute(C.DOM_ATTR._STYLE),l.removeAttribute(C.DOM_ATTR._STYLE)),null!=a&&a.removeAttribute(C.DOM_ATTR._STYLE),this._removeHeaderColumnAndCellColumnWidths()},C.prototype._getBoxStyle=function(e){return{boxSizing:e[C.CSS_PROP._BOX_SIZING],borderWidth:(parseFloat(e[C.CSS_PROP._BORDER_RIGHT_WIDTH])||0)+(parseFloat(e[C.CSS_PROP._BORDER_LEFT_WIDTH])||0),paddingWidth:(parseFloat(e[C.CSS_PROP._PADDING_RIGHT])||0)+(parseFloat(e[C.CSS_PROP._PADDING_LEFT])||0)}},C.prototype._applyColumnHeaderHeight=function(e,t){var o=this._getTableElementsByClassName(e,C.CSS_CLASSES._COLUMN_HEADER_CLASS);o.length>0&&(o[0].style[C.CSS_PROP._MIN_HEIGHT]=t+C.CSS_VAL._PX)},C.prototype._getColumnWidthProperty=function(e){var t=window.getComputedStyle(e),o=this._getBoxStyle(t);return this._isIE()?parseFloat(t.width)+o.paddingWidth:parseFloat(t.width)+("border-box"===o.boxSizing?-o.borderWidth:o.paddingWidth)},C.prototype._getForcedColumnWidth=function(e,t,o){var n=this._getBoxStyle(t);return null!=o?o+("border-box"===n.boxSizing?n.borderWidth:-n.paddingWidth):this._isIE()&&"border-box"===n.boxSizing?parseFloat(t.width)+n.paddingWidth+n.borderWidth:parseFloat(t.width)},C.prototype._applyForcedColumnWidth=function(e,t){var o=e;""!==t&&(t+=C.CSS_VAL._PX),o.style[C.CSS_PROP._MIN_WIDTH]=t,o.style[C.CSS_PROP._WIDTH]=t,o.style[C.CSS_PROP._MAX_WIDTH]=t},C.prototype._setForcedColumnWidths=function(){var e,t,o,n,l,s=this._getColumnDefs(),a=s.length,r=this._getTableBodyRows();this._forcedWidthColumns=[];for(var _=0;_<a;_++){var h=s[_].width;if(h>0){var u=null,c=null;if("number"!=typeof h&&(n=C._LOGGER_MSG._ERR_WIDTH_INVALID_TYPE_SUMMARY,l=i.applyParameters(C._LOGGER_MSG._ERR_WIDTH_INVALID_TYPE_DETAIL,{width:h}),d.warn(n+"\n"+l),h=parseFloat(h)),null!=(e=this._getTableHeaderColumn(_))){var S=this._getForcedColumnWidth(e,window.getComputedStyle(e),h);this._applyForcedColumnWidth(e,S),this._forcedWidthColumns[_]=S}else this._forcedWidthColumns[_]=!0;if(null!=(t=0===this._editableRowIdx&&r.length>1?this._getTableBodyCell(1,_,null):this._getTableBodyCell(0,_,null))){this._hasRowOrCellRendererOrTemplate(_)||(u=window.getComputedStyle(t),c=this._getForcedColumnWidth(t,u,h));for(var E=0;E<r.length;E++)if(null!=(t=this._getTableBodyCell(E,_,null)))if(null==u){var T=window.getComputedStyle(t),p=this._getForcedColumnWidth(t,T,h);this._applyForcedColumnWidth(t,p)}else this._applyForcedColumnWidth(t,c)}null!=(o=this._getTableFooterCell(_))&&this._applyForcedColumnWidth(o,this._getForcedColumnWidth(o,window.getComputedStyle(o),h))}else this._forcedWidthColumns[_]=!1}},C.prototype._isTableColumnsWidthSet=function(){for(var e=this._getColumnDefs().length,t=0;t<e;t++)if(!1!==this._forcedWidthColumns[t])return!0;return!1},C.prototype._isAllTableColumnsWidthSet=function(){for(var e=this._getColumnDefs().length,t=0;t<e;t++)if(!1===this._forcedWidthColumns[t])return!1;return!0},C.prototype._unfreezeColumnWidths=function(){if(this._frozenWidthRows)for(var e=0;e<this._frozenWidthRows.length;e++)for(var t=this._getTableBodyCells(null,this._frozenWidthRows[e]),o=0;o<t.length;o++){var n=t[o];this._applyForcedColumnWidth(n,""),this._styleTableBodyCell(o,n)}this._frozenWidthRows=[]},C.prototype._freezeColumnWidths=function(e){var t,o=this._getColumnDefs().length;this._frozenWidthRows||(this._frozenWidthRows=[]);for(var n=[],i=0;i<o;i++){t=this._getTableBodyCell(0,i,null);var l=parseFloat(t.style[C.CSS_PROP._MIN_WIDTH]);isNaN(l)?n.push(null):n.push(l)}for(var s=e.childNodes,a=0;a<s.length;a++)if("TR"===s[a].nodeName){for(var r=s[a],_=this._getTableBodyCells(null,r),d=0;d<_.length;d++){var h=n[d];isNaN(h)||this._applyForcedColumnWidth(_[d],h)}this._frozenWidthRows.push(r)}},C.prototype._setColumnWidths=function(e){var t,o,n,i,l=[],s=[],a=[],r=[],_=this._getColumnDefs().length;for(t=0;t<_;t++)if(!1!==this._forcedWidthColumns[t])l[t]=null,a[t]=null,r[t]=null;else{if(null!=(o=this._getTableHeaderColumn(t))){l[t]=this._getForcedColumnWidth(o,window.getComputedStyle(o));var d=this._getTableElementsByClassName(o,C.CSS_CLASSES._COLUMN_HEADER_TEXT_CLASS);d.length>0&&(s[t]=d[0].clientHeight)}null!=(n=this._getTableBodyCell(0,t,null))&&(a[t]=this._getForcedColumnWidth(n,window.getComputedStyle(n))),null!=(i=this._getTableFooterCell(t))&&(r[t]=this._getForcedColumnWidth(i,window.getComputedStyle(i)))}for(t=0;t<_;t++)!1!==this._forcedWidthColumns[t]?null!=(o=this._getTableHeaderColumn(t))&&(this._applyColumnHeaderHeight(o,s[t]),t===_-1&&!this._tableWidthConstrained&&e>0&&this._applyForcedColumnWidth(o,this._forcedWidthColumns[t]+e)):(null!=(o=this._getTableHeaderColumn(t))&&(t===_-1&&!this._tableWidthConstrained&&e>0?this._applyForcedColumnWidth(o,l[t]+e):this._applyForcedColumnWidth(o,l[t]),this._applyColumnHeaderHeight(o,s[t])),null!=(n=this._getTableBodyCell(0,t,null))&&this._applyForcedColumnWidth(n,a[t]),null!=(i=this._getTableFooterCell(t))&&this._applyForcedColumnWidth(i,r[t]))},C.prototype._setHeaderColumnOverflowWidths=function(){for(var e=this._getColumnDefs().length,o=0;o<e;o++){var n=this._getTableHeaderColumn(o);if(null!=n){var i=this._getTableElementsByClassName(n,C.CSS_CLASSES._COLUMN_HEADER_CLASS);if(i.length>0){i=i[0];var l=this._getTableElementsByClassName(n,C.CSS_CLASSES._COLUMN_HEADER_TEXT_CLASS),s=this._getSortIconContainer(n),a=null!=s?t(s).outerWidth(!0):0;if(l.length>0&&i.clientWidth>0&&l[0].clientWidth+a>=i.clientWidth){l[0].style[C.CSS_PROP._WIDTH]="";var r=l[0].clientWidth,_=i.clientWidth;r+a>=_+1&&(l[0].style[C.CSS_PROP._WIDTH]=_-a+C.CSS_VAL._PX)}}}}},C.prototype._getSortIconContainer=function(e){return this._getTableElementsByClassName(e,C.CSS_CLASSES._TABLE_SORT_ICON_CONTAINER_CLASS)[0]},C.prototype._getSortIcon=function(e){var t=this._getSortIconContainer(e);return null!=t?t.firstChild:null},C.prototype._getTableBodySelectorCell=function(e){if(null!=e){var t=this._getTableElementsByClassName(e,C.CSS_CLASSES._TABLE_SELECTOR_CELL);if(t.length>0)return t[0]}return null},C.prototype._getTableSelectorColumn=function(){var e=this._getTableHeaderRow();if(null!=e){var t=this._getTableElementsByClassName(e,C.CSS_CLASSES._COLUMN_HEADER_SELECTOR_CELL_CLASS);if(t.length>0)return t[0]}return null},C.CSS_CLASSES={_TABLE_CONTAINER_CLASS:"oj-table-container",_TABLE_SCROLLER_CLASS:"oj-table-scroller",_TABLE_CLASS:"oj-table",_TABLE_COMPACT_CLASS:"oj-table-grid-display",_TABLE_HGRID_CLASS:"oj-table-horizontal-grid",_TABLE_EDIT_CLASS:"oj-table-editable",_TABLE_SCROLL_CLASS:"oj-table-scroll",_TABLE_SCROLL_VERTICAL_CLASS:"oj-table-scroll-vertical",_TABLE_SCROLL_HORIZONTAL_CLASS:"oj-table-scroll-horizontal",_TABLE_SORT_CLASS:"oj-table-sort",_TABLE_ELEMENT_CLASS:"oj-table-element",_TABLE_FOOTER_CLASS:"oj-table-footer",_TABLE_FOOTER_ROW_CLASS:"oj-table-footer-row",_TABLE_HEADER_CLASS:"oj-table-header",_TABLE_HEADER_ROW_CLASS:"oj-table-header-row",_TABLE_HEADER_SELECTOR_CLASS:"oj-table-header-selector",_TABLE_BOTTOM_SLOT_CLASS:"oj-table-slot-bottom",_TABLE_SORT_ICON_CONTAINER_CLASS:"oj-table-sort-icon-container",_COLUMN_HEADER_CELL_CLASS:"oj-table-column-header-cell",_COLUMN_HEADER_SELECTOR_CELL_CLASS:"oj-table-column-header-selector-cell",_COLUMN_HEADER_DROP_EMPTY_CELL_CLASS:"oj-table-column-header-drop-empty-cell",_COLUMN_HEADER_CLASS:"oj-table-column-header",_COLUMN_HEADER_TEXT_CLASS:"oj-table-column-header-text",_COLUMN_HEADER_ASC_ICON_CLASS:"oj-table-column-header-asc-icon",_COLUMN_HEADER_DSC_ICON_CLASS:"oj-table-column-header-dsc-icon",_COLUMN_HEADER_DEFAULT_SORT_ICON_CLASS:"oj-table-column-header-default-sort-icon",_COLUMN_HEADER_DRAG_INDICATOR_BEFORE_CLASS:"oj-table-column-header-drag-indicator-before",_COLUMN_HEADER_DRAG_INDICATOR_AFTER_CLASS:"oj-table-column-header-drag-indicator-after",_COLUMN_HEADER_DRAG_IMAGE:"oj-table-column-header-cell-drag-image",_COLUMN_HEADER_RESIZING_CLASS:"oj-table-column-header-resizing",_COLUMN_HEADER_RESIZE_INDICATOR_CLASS:"oj-table-column-header-resize-indicator",_TABLE_BODY_CLASS:"oj-table-body",_TABLE_DATA_ROW_CLASS:"oj-table-body-row",_TABLE_DATA_ROW_DRAG_INDICATOR_BEFORE_CLASS:"oj-table-body-row-drag-indicator-before",_TABLE_DATA_ROW_DRAG_INDICATOR_AFTER_CLASS:"oj-table-body-row-drag-indicator-after",_TABLE_TOUCH_AFFORDANCE_GLASS_PANE_CLASS:"oj-table-touch-affordance-glass-pane",_TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOP_CLASS:"oj-table-body-row-touch-selection-affordance-top",_TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_BOTTOM_CLASS:"oj-table-body-row-touch-selection-affordance-bottom",_TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOP_ICON_CLASS:"oj-table-body-row-touch-selection-affordance-top-icon",_TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_BOTTOM_ICON_CLASS:"oj-table-body-row-touch-selection-affordance-bottom-icon",_TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOUCH_AREA_CLASS:"oj-table-body-row-touch-selection-affordance-touch-area",_TABLE_DATA_ROW_EDIT_CLASS:"oj-table-body-row-edit",_TABLE_DATA_ROW_SELECTOR_CLASS:"oj-table-body-row-selector",_TABLE_SELECTOR_CELL:"oj-table-selector-cell",_TABLE_DATA_CURRENT_ROW_CLASS:"oj-table-body-current-row",_TABLE_DATA_CELL_CLASS:"oj-table-data-cell",_TABLE_DATA_CELL_EDIT_CLASS:"oj-table-data-cell-edit",_TABLE_DATE_CELL_FORM_CONTROL_CLASS:"oj-form-control-inherit",_TABLE_VGRID_LINES_CLASS:"oj-table-vgrid-lines",_TABLE_FOOTER_CELL_CLASS:"oj-table-footer-cell",_TABLE_FOOTER_DROP_EMPTY_CELL_CLASS:"oj-table-footer-drop-empty-cell",_TABLE_STATUS_ACC_NOTIFICATION_CLASS:"oj-table-status-acc-notification",_TABLE_STATUS_MESSAGE_CLASS:"oj-table-status-message",_TABLE_STATUS_MESSAGE_TEXT_CLASS:"oj-table-status-message-text",_TABLE_ACC_CONTEXT_INFO_CLASS:"oj-table-acc-context-info",_TABLE_ACC_STATE_INFO_CLASS:"oj-table-acc-state-info",_TABLE_LOADING_ICON_CLASS:"oj-table-loading-icon",_TABLE_BODY_MESSAGE_CLASS:"oj-table-body-message",_TABLE_BODY_MESSAGE_ROW_CLASS:"oj-table-body-message-row",_TABLE_NO_DATA_CONTAINER_CLASS:"oj-table-no-data-container",_TABLE_NO_DATA_ROW_CLASS:"oj-table-no-data-row",_ICON_CLASS:"oj-icon",_WIDGET_ICON_CLASS:"oj-component-icon",_HIDDEN_CONTENT_ACC_CLASS:"oj-helper-hidden-accessible",_TEXT_ALIGN_END:"oj-helper-text-align-end"},C.CSS_PROP={_DISPLAY:"display",_VISIBILITY:"visibility",_POSITION:"position",_HEIGHT:"height",_WIDTH:"width",_TOP:"top",_BOTTOM:"bottom",_LEFT:"left",_RIGHT:"right",_PADDING_TOP:"padding-top",_PADDING_LEFT:"padding-left",_PADDING_RIGHT:"padding-right",_OVERFLOW:"overflow",_OVERFLOW_X:"overflow-x",_OVERFLOW_Y:"overflow-y",_MIN_WIDTH:"min-width",_MAX_WIDTH:"max-width",_MIN_HEIGHT:"min-height",_FLOAT:"float",_BORDER_TOP:"border-top",_BORDER_BOTTOM_WIDTH:"border-bottom-width",_BORDER_LEFT_WIDTH:"border-left-width",_BORDER_RIGHT_WIDTH:"border-right-width",_BORDER_COLOR:"border-color",_MARGIN_BOTTOM:"margin-bottom",_VERTICAL_ALIGN:"vertical-align",_CURSOR:"cursor",_ZINDEX:"z-index",_BACKGROUND_COLOR:"background-color",_BOX_SIZING:"box-sizing"},C.CSS_VAL={_NONE:"none",_BLOCK:"block",_INLINE_BLOCK:"inline-block",_RELATIVE:"relative",_ABSOLUTE:"absolute",_INLINE:"inline",_AUTO:"auto",_HIDDEN:"hidden",_SCROLL:"scroll",_VISIBLE:"visible",_LEFT:"left",_PX:"px",_MIDDLE:"middle",_MOVE:"move",_FIXED:"fixed",_TRANSPARENT:"transparent",_BORDER_BOX:"border-box"},C.DOM_ATTR={_STYLE:"style",_TABINDEX:"tabindex",_TYPE:"type",_ID:"id",_TITLE:"title",_HREF:"href",_HEADERS:"headers",_COLSPAN:"colspan",_ROLE:"role",_ARIA_LABEL:"aria-label",_ARIA_LABELLEDBY:"aria-labelledby",_ARIA_HIDDEN:"aria-hidden"},C.DOM_ELEMENT={_DIV:"div",_A:"a",_TR:"tr",_TD:"td",_TH:"th",_TABLE:"table",_TBODY:"tbody",_THEAD:"thead",_TFOOT:"tfoot",_INPUT:"input",_UL:"ul",_SPAN:"span",_BUTTON:"button",_LABEL:"label"},C.MARKER_STYLE_CLASSES={_WIDGET:"oj-component",_ACTIVE:"oj-active",_CLICKABLE_ICON:"oj-clickable-icon-nocontext",_DISABLED:"oj-disabled",_ENABLED:"oj-enabled",_FOCUS:"oj-focus",_FOCUS_HIGHLIGHT:"oj-focus-highlight",_HOVER:"oj-hover",_SELECTED:"oj-selected",_DEFAULT:"oj-default",_WARNING:"oj-warning",_DRAGGABLE:"oj-draggable",_DRAG:"oj-drag",_HIDE_VERTICAL_SCROLLBAR:"oj-table-hide-vertical-scrollbar"},C.prototype._events={focusout:function(o){this._clearFocusoutTimeout();for(var n=this._getTable(),i=e.ZOrderUtils.findOpenPopups(),l=0;l<i.length;l++){var s=i[l].firstElementChild,a=e.DomUtils.getLogicalParent(t(s));if(t(n).has(a.get(0)).length>0&&e.ZOrderUtils.getStatus(s)===e.ZOrderUtils.STATUS.OPEN)return}this._setFocusoutBusyState(),this._focusoutTimeout=setTimeout(function(){this._accFirstFocus=!0,this._focusOutHandler(t(n)),this._focusOutHandler(t(this._getTableContainer())),this._clearKeyboardKeys(),this._clearFocusedHeaderColumn(),this._clearFocusedRow(!1),this._clearTableHeaderColumnsResize(),this._setTableEditable(!1,!1,0,!0,o,!0),this._focusEditCell&&(this._focusEditCell.classList.remove(C.CSS_CLASSES._TABLE_DATA_CELL_EDIT_CLASS),this._focusEditCell=null),this._setTableActionableMode(!1,!0),this._clearFocusoutBusyState()}.bind(this),100)},focus:function(e){this._checkRowOrHeaderColumnFocus(e)},focusin:function(e){this._clearFocusoutTimeout(),this._clearFocusoutBusyState();var o=this._getTable(),n=this._getTableBody(),i=this._getTableContainer();if(this._focusInHandler(t(o)),this._focusInHandler(t(i)),t(n).has(e.target).length>0){var l=this._getFocusedRowIdx(),s=this._getFocusedHeaderColumnIdx();this._isNodeEditable(e.target)||this._isNodeClickable(e.target)||this._isTableActionableMode()||this._hasEditableRow()||this._temporaryTableChildElementFocus||null!=l||null!=s||setTimeout(function(){o.focus()},0)}else this._isFF()&&e.target===n&&setTimeout(function(){o.focus()},0)},"focus .oj-table-data-cell":function(e){var t=this._getEventTargetElement(e);this._getElementRowIdx(t)===this._getEditableRowIdx()&&(this._focusEditCell&&this._focusEditCell!==t&&this._focusEditCell.classList.contains(C.CSS_CLASSES._TABLE_DATA_CELL_EDIT_CLASS)&&this._focusEditCell.classList.remove(C.CSS_CLASSES._TABLE_DATA_CELL_EDIT_CLASS),t.classList.add(C.CSS_CLASSES._TABLE_DATA_CELL_EDIT_CLASS),this._focusEditCell=t)},keydown:function(e){var o=e.key||e.keyCode;this._addKeyboardKey(o);var n=this._getKeyboardKeys()[0];if((a.isEscapeKeyEvent(n)||a.isEnterKeyEvent(n)||a.isF2KeyEvent(n)||a.isTabKeyEvent(n)||!(this._isNodeEditable(e.target)||null!=this._getTableFooter()&&t(this._getTableFooter()).has(e.target).length>0))&&(1===this._getKeyboardKeys().length||2===this._getKeyboardKeys().length&&e[C._KEYBOARD_CODES._MODIFIER_SHIFT])){(this._isKeyPressMatch(a.isArrowUpKeyEvent)||this._isKeyPressMatch(a.isArrowDownKeyEvent)||this._isKeyPressMatch(a.isHomeKeyEvent)||this._isKeyPressMatch(a.isEndKeyEvent))&&(e.preventDefault(),e.stopPropagation());var i=e[C._KEYBOARD_CODES._MODIFIER_SHIFT];this._isKeyPressMatch(a.isArrowUpKeyEvent)||this._isKeyPressMatch(a.isArrowDownKeyEvent)?this._handleKeydownUpDown(e,i&&this._getRowSelectionMode()===C._OPTION_SELECTION_MODES._MULTIPLE):this._isKeyPressMatch(a.isArrowLeftKeyEvent)||this._isKeyPressMatch(a.isArrowRightKeyEvent)?this._handleKeydownLeftRight(e,i&&this._getColumnSelectionMode()===C._OPTION_SELECTION_MODES._MULTIPLE):this._isKeyPressMatch(a.isTabKeyEvent)?this._handleKeydownTab(e):a.isF2KeyEvent(n)?this._handleKeydownF2(e):a.isSpaceBarKeyEvent(n)?this._handleKeydownSpacebar(e):a.isEnterKeyEvent(n)?this._handleKeydownEnter(e):a.isHomeKeyEvent(n)?this._handleKeydownHome(e):a.isEndKeyEvent(n)?this._handleKeydownEnd(e):a.isEscapeKeyEvent(n)&&this._handleKeydownEsc(e)}},keyup:function(e){if(1===this._getKeyboardKeys().length){var o=this._getKeyboardKeys()[0];if(this._isNodeEditable(e.target)||null!=this._getTableFooter()&&t(this._getTableFooter()).has(e.target).length>0)return void this._removeKeyboardKey(o);this._removeKeyboardKey(o)}var n=e.key||e.keyCode;this._removeKeyboardKey(n)},"mouseleave .oj-table-element":function(){this._clearTableHeaderColumnsResize()},"mousedown .oj-table-body":function(e){if(1===e.which&&(this._mouseDownRowIdx=this._getElementRowIdx(e.target),null!=this._mouseDownRowIdx)){var t=this._getTableBodyRow(this._mouseDownRowIdx);null!=t&&t.draggable&&(this._mouseDownRowIdx=null)}},"mouseup .oj-table-body":function(){this._mouseDownRowIdx=null},"mouseenter .oj-table-body-row":function(e){var t=this._getEventTargetElement(e),o=this._getElementRowIdx(t);this._isTableOwned(t)?(t.classList.add(C.MARKER_STYLE_CLASSES._HOVER),this._updateRowStateCellsClass(o,{hover:!0}),this._handleMouseEnterSelection(e.target)):(this._updateRowStateCellsClass(o,{hover:!1}),e.stopPropagation())},"mouseleave .oj-table-body-row":function(e){var t=this._getEventTargetElement(e),o=this._getElementRowIdx(t);this._isTableOwned(t)?(t.classList.remove(C.MARKER_STYLE_CLASSES._HOVER),this._updateRowStateCellsClass(o,{hover:!1})):(this._updateRowStateCellsClass(o,{hover:!0}),e.stopPropagation())},"mousedown .oj-table-column-header-cell":function(o){if(this._lastSelectedHeaderIdx=null,1===o.which){if(!this._handleHeaderColumnResizeStart(o)){var n=this._getElementColumnIdx(this._getEventTargetElement(o));o[C._KEYBOARD_CODES._MODIFIER_SHIFT]||(this._setHeaderColumnFocus(n,!0,!0),t(o.target).data(C._FOCUS_CALLED,!0))}this._isFF()&&e.DomUtils.isMetaKeyPressed(o)&&o.preventDefault()}},"mouseenter .oj-table-column-header-cell":function(e){if(!this._setResizeCursor(e)){var t=this._getEventTargetElement(e);this._handleMouseEnterColumnHeader(t)}},"mousemove .oj-table-header":function(e){this._setResizeCursor(e)},"mousemove .oj-table-column-header-cell":function(e){var t=this._getEventTargetElement(e);this._setResizeCursor(e)?this._handleMouseLeaveColumnHeader(t):this._handleMouseEnterColumnHeader(t)},"mouseleave .oj-table-column-header-cell":function(e){var t=this._getEventTargetElement(e);this._handleMouseLeaveColumnHeader(t)},"mouseup .oj-table-column-header-cell":function(e){this._handleHeaderColumnResizeEnd(e)},"mousedown .oj-table-data-cell":function(o){this._lastSelectedRowIdx=null;var n=this._getEventTargetElement(o),i=this._getElementRowIdx(n);o[C._KEYBOARD_CODES._MODIFIER_SHIFT]||(this._setRowFocus(i,!0,!0,n,o),t(o.target).data(C._FOCUS_CALLED,!0)),this._isFF()&&e.DomUtils.isMetaKeyPressed(o)&&o.preventDefault()},"mouseup .oj-table-data-cell":function(e){this._handleHeaderColumnResizeEnd(e)},"click .oj-table-sort-icon-container":function(e){var o=this._getElementColumnIdx(e.target),n=this._getTableHeaderColumn(o);n&&(t(n).data("sorted")===C._COLUMN_SORT_ORDER._ASCENDING?this._handleSortTableHeaderColumn(o,!1,e):this._handleSortTableHeaderColumn(o,!0,e),e.preventDefault(),e.stopPropagation())},"click .oj-table-body-row":function(o){var n=this._getEventTargetElement(o),i=this._getElementRowIdx(n),l=t(o.target).data(C._FOCUS_CALLED),s=o[C._KEYBOARD_CODES._MODIFIER_SHIFT];if(!l&&(!s||s&&null==this._getFocusedRowIdx())){var a=this._setRowFocus(i,!0,!0,n,o);if(t(o.target).data(C._FOCUS_CALLED,!1),!a)return}if(this._fireActionEvent(i,o),s){var r=this._getFocusedRowIdx();if(null!=r&&(window.getSelection().removeAllRanges(),this._getRowSelectionMode()===C._OPTION_SELECTION_MODES._MULTIPLE))return void this._selectRange(r,i,!0);this._handleSelectionGesture(i,!0,!1)}else if(e.DomUtils.isMetaKeyPressed(o))this._handleSelectionGesture(i,!0,!0),this._lastSelectedRowIdxArray&&this._lastSelectedRowIdxArray.indexOf(i)>-1&&(this._selectionAnchorIdx=i);else if(0===this._getKeyboardKeys().length){var _=this._isTouchDevice();this._handleSelectionGesture(i,!0,_&&this._nonContiguousSelection),this._lastSelectedRowIdxArray&&this._lastSelectedRowIdxArray.indexOf(i)>-1&&(this._selectionAnchorIdx=i);var d=this._getRowSelection(i);_&&d&&!this._nonContiguousSelection&&this._getRowSelectionMode()===C._OPTION_SELECTION_MODES._MULTIPLE&&this._createTableBodyRowTouchSelectionAffordance(i)}},"dblclick .oj-table-data-cell":function(e){var t=this._getElementColumnIdx(e.target);this._setTableEditable(!0,!1,t,!0,e)},"contextmenu .oj-table-data-cell":function(e){var t=this._getElementRowIdx(this._getEventTargetElement(e)),o=this._getRowKeyForRowIdx(t);this._setCurrentRow({rowKey:o},e,!1)},"click .oj-table-column-header-cell":function(o){var n=this._getEventTargetElement(o);if("col-resize"!==n.style.cursor){var i=this._getElementColumnIdx(n),l=t(o.target).data(C._FOCUS_CALLED),s=o[C._KEYBOARD_CODES._MODIFIER_SHIFT];if(l||s&&(!s||null!=this._getFocusedHeaderColumnIdx())||(this._setHeaderColumnFocus(i,!0,!1),t(o.target).data(C._FOCUS_CALLED,!1)),s){var a=this._getFocusedHeaderColumnIdx();null!=a&&this._getColumnSelectionMode()===C._OPTION_SELECTION_MODES._MULTIPLE?this._selectRange(a,i,!1):this._handleSelectionGesture(i,!1,!0)}else e.DomUtils.isMetaKeyPressed(o)?this._handleSelectionGesture(i,!1,!0):0===this._getKeyboardKeys().length&&(this._handleSelectionGesture(i,!1,!1),this._getTableDndContext().setTableHeaderColumnDraggable(i,!0))}},"dragstart .oj-table-column-header-cell":function(e){if("col-resize"!==this._getEventTargetElement(e).style.cursor)return this._getTableDndContext().handleColumnDragStart(e)},"dragenter .oj-table-column-header-cell":function(e){return this._getTableDndContext().handleColumnDragEnter(e)},"dragover .oj-table-column-header-cell":function(e){return this._getTableDndContext().handleColumnDragOver(e)},"dragleave .oj-table-column-header-cell":function(e){return this._getTableDndContext().handleColumnDragLeave(e)},"drop .oj-table-column-header-cell":function(e){return this._getTableDndContext().handleColumnDrop(e)},"dragend .oj-table-column-header-cell":function(e){return this._getTableDndContext().handleColumnDragEnd(e)},"dragstart .oj-table-body-row":function(e){return this._getTableDndContext().handleRowDragStart(e)},"drag .oj-table-body-row":function(e){return this._getTableDndContext().handleRowDrag(e)},"dragend .oj-table-body-row":function(e){return this._getTableDndContext().handleRowDragEnd(e)},"dragenter .oj-table-body":function(e){return this._getTableDndContext().handleRowDragEnter(e)},"dragover .oj-table-body":function(e){return this._getTableDndContext().handleRowDragOver(e)},"dragleave .oj-table-body":function(e){return this._getTableDndContext().handleRowDragLeave(e)},"drop .oj-table-body":function(e){return this._getTableDndContext().handleRowDrop(e)}},C.prototype._fireActionEvent=function(e,o){if(!this._isTableActionableMode()){var n=this._getTableBodyRow(e);null!=n&&this._trigger("rowAction",o,{context:{key:t(n).data("rowKey"),data:t(n).data("rowData"),metadata:t(n).data("rowMetadata")}})}},C.prototype._getEventTargetElement=function(e){return 0===e.type.indexOf("touch")?this._getTouchEventTargetElement(e):e.currentTarget},C.prototype._getTouchEventTargetElement=function(e){var t=e.originalEvent.changedTouches[0];return document.elementFromPoint(t.clientX,t.clientY)},C.prototype._registerCustomEvents=function(){var e=t.event.special;e.ojtablebeforecurrentrow={handle:function(e){return e.handleObj.handler.apply(this,[e,arguments[1]])}},e.ojtablesort={handle:function(e){return e.handleObj.handler.apply(this,[e,arguments[1]])}}},C.prototype._touchEventDoubleTapFunction=function(e,o){var n=t(e.target);null!=this._lastTapTime&&(new Date).getTime()-this._lastTapTime<250&&this._lastTapTarget[0]===n[0]?(this._lastTapTime=null,this._lastTapTarget=null,o()):(this._lastTapTarget=n,this._lastTapTime=(new Date).getTime())},C.prototype._registerTouchEvents=function(){const e={"touchstart .oj-table-body-row-touch-selection-affordance-touch-area":function(e){1===e.originalEvent.touches.length&&this._getRowSelectionMode()===C._OPTION_SELECTION_MODES._MULTIPLE&&(e.target.classList.contains(C.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOP_CLASS)||e.target.classList.contains(C.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOP_ICON_CLASS)?(e.preventDefault(),this._mouseDownRowIdx=t(this._getTableBodyRowTouchSelectionAffordanceBottom()).data("rowIdx")):(e.target.classList.contains(C.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_BOTTOM_CLASS)||e.target.classList.contains(C.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_BOTTOM_ICON_CLASS))&&(e.preventDefault(),this._mouseDownRowIdx=t(this._getTableBodyRowTouchSelectionAffordanceTop()).data("rowIdx")))},"touchstart .oj-table-column-header-cell":function(e){1===e.originalEvent.touches.length&&this._isTableColumnsResizable()&&this._handleHeaderColumnResizeStart(e)&&e.preventDefault()},"touchmove .oj-table-header":function(e){this._isTableColumnsResizable()&&this._setResizeCursor(e)},"touchmove .oj-table-body-row-touch-selection-affordance-touch-area":function(e){if(null!=this._mouseDownRowIdx){e.preventDefault();var t=this._getEventTargetElement(e);this._handleMouseEnterSelection(t,!0)}}},o=this._getTableContainer();if(this._on(t(o),{touchend:function(e){if(null!=this._mouseDownRowIdx){var t=this._getEventTargetElement(e);this._handleMouseEnterSelection(t,!0)}this._mouseDownRowIdx=null,this._handleHeaderColumnResizeEnd(e)&&e.preventDefault()},"touchend .oj-table-body":function(e){this._touchEventDoubleTapFunction(e,function(e){return function(){var t=this._getEventTargetElement(e),o=this._getElementColumnIdx(t);this._setTableEditable(!0,!1,o,!0,e),e.preventDefault()}.bind(this)}.bind(this)(e))},touchcancel:function(){this._mouseDownRowIdx=null,this._clearTableHeaderColumnsResize()}}),this._IsCustomElement()){const n=function(e,o){return function(n){const i=n.currentTarget,l=n.target.closest(e);l&&i.contains(l)&&o(t.Event(n,{currentTarget:l}))}},i="touchstart",l="touchmove",s=".oj-table-body-row-touch-selection-affordance-touch-area",a=".oj-table-column-header-cell",r=".oj-table-header";this._delegatedTouchStartTableBodyListener=n(s,e[`${i} ${s}`].bind(this)),this._delegatedTouchStartCellHeaderListener=n(a,e[`${i} ${a}`].bind(this)),this._delegatedTouchMoveTableHeaderListener=n(r,e[`${l} ${r}`].bind(this)),this._delegatedTouchMoveTableBodyListener=n(s,e[`${l} ${s}`].bind(this)),o.addEventListener(i,this._delegatedTouchStartTableBodyListener,{passive:!1}),o.addEventListener(i,this._delegatedTouchStartCellHeaderListener,{passive:!1}),o.addEventListener(l,this._delegatedTouchMoveTableHeaderListener,{passive:!0}),o.addEventListener(l,this._delegatedTouchMoveTableBodyListener,{passive:!1})}else this._on(t(o),e)},C.prototype._checkRowOrHeaderColumnFocus=function(e){var t=this._getFocusedRowIdx(),o=this._getFocusedHeaderColumnIdx();if(null==t&&null==o){var n=null,i=this._getCurrentRow(),l=null!=i?i.rowKey:null;if(null!=l&&(n=this._getRowIdxForRowKey(l)),null==n)if(this._isTableHeaderless())this._setRowFocus(0,!0,!0,null,e);else{var s=this._getFirstVisibleColumnIndex(0,!0);this._setHeaderColumnFocus(s,!0,!1)}else this._setRowFocus(n,!0,!0,null,e)}},C.prototype._clearFocusedRow=function(e){null!=this._getFocusedRowIdx()&&this._setRowFocus(-1,!0,e,null,null)},C.prototype._clearFocusedHeaderColumn=function(){var e=this._getFocusedHeaderColumnIdx();null!=e&&this._setHeaderColumnFocus(e,!1,!1),this._activeColumnIndex=-1},C.prototype._getFirstVisibleColumnIndex=function(e,t){var o,n=this._getColumnDefs(),i=e;if(t)for(;i<n.length;){if((o=this._getTableHeaderColumn(i))&&o.clientWidth>0)return i;i+=1}else for(;i>-1;){if((o=this._getTableHeaderColumn(i))&&o.clientWidth>0)return i;i-=1}return null},C.prototype._getNextVisibleColumnIndex=function(e,t){var o;o=t?e+1:e-1;var n=this._getFirstVisibleColumnIndex(o,t);return null!==n?n:e},C.prototype._getCurrentRow=function(){return this._getData()?this._currentRow:null},C.prototype._getFocusedRowIdx=function(){return this._getRowIdxsForElementsWithStyleClass("."+C.CSS_CLASSES._TABLE_DATA_ROW_CLASS+"."+C.MARKER_STYLE_CLASSES._FOCUS_HIGHLIGHT+",."+C.CSS_CLASSES._TABLE_DATA_ROW_CLASS+"."+C.MARKER_STYLE_CLASSES._FOCUS)[0]},C.prototype._getFocusedHeaderColumnIdx=function(){return this._getColumnIdxsForElementsWithStyleClass("."+C.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS+"."+C.MARKER_STYLE_CLASSES._FOCUS_HIGHLIGHT+",."+C.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS+"."+C.MARKER_STYLE_CLASSES._FOCUS+",."+C.CSS_CLASSES._COLUMN_HEADER_SELECTOR_CELL_CLASS+"."+C.MARKER_STYLE_CLASSES._FOCUS_HIGHLIGHT+",."+C.CSS_CLASSES._COLUMN_HEADER_SELECTOR_CELL_CLASS+"."+C.MARKER_STYLE_CLASSES._FOCUS)[0]},C.prototype._scrollRowIntoViewport=function(e){var o=this._getTableBodyRow(e),n=this._getScrollBarHeight(),i=o.getBoundingClientRect(),l=this._getScroller(),s=t(l),a=l.getBoundingClientRect(),r=a.top-i.top,_=r>=0,d=i.bottom-a.bottom+n,h=d>=0;_&&h||(h?Math.abs(r)>Math.abs(d)?s.scrollTop(s.scrollTop()+d):s.scrollTop(s.scrollTop()-r):_&&(Math.abs(d)>Math.abs(r)?s.scrollTop(s.scrollTop()-r):s.scrollTop(s.scrollTop()+d)))},C.prototype._scrollColumnIntoViewport=function(o){var n;if(n=-1===o?this._getTableSelectorColumn():this._getTableHeaderColumn(o)){var i,l,s,a,r="rtl"===this._GetReadingDirection(),_=this._getScroller(),d=t(_),h=this._getScrollBarWidth(),u=n.getBoundingClientRect(),c=_.getBoundingClientRect();if(r){l=(i=c.left-u.left+h)>=0,a=(s=u.right-c.right)>=0;var S=e.AgentUtils.getAgentInfo().browser;S!==e.AgentUtils.BROWSER.IE&&S!==e.AgentUtils.BROWSER.EDGE||(i*=-1,s*=-1)}else l=(i=c.left-u.left)>=0,a=(s=u.right-c.right+h)>=0;l&&a||(l?Math.abs(s)>Math.abs(i)?d.scrollLeft(d.scrollLeft()-i):d.scrollLeft(d.scrollLeft()+s):a&&(Math.abs(i)>Math.abs(s)?d.scrollLeft(d.scrollLeft()+s):d.scrollLeft(d.scrollLeft()-i)))}},C.prototype._setCurrentRow=function(e,t,o){var n,l,s,a,r=this._currentRow,_=null==e||null==e.rowKey&&null==e.rowIndex;if(_)s=-1,a=null!=e?e:null;else{var h=this._getData(),u=e.rowIndex,c=e.rowKey;if(null==c&&(c=this._getRowKeyForDataSourceRowIndex(u)),a={rowIndex:u=this._getDataSourceRowIndexForRowKey(c),rowKey:c},-1!==(s=this._getRowIdxForRowKey(c))&&(!h||s<-1||null===s||null===c)){if(n=C._LOGGER_MSG._ERR_CURRENTROW_UNAVAILABLE_INDEX_SUMMARY,l=i.applyParameters(C._LOGGER_MSG._ERR_CURRENTROW_UNAVAILABLE_INDEX_DETAIL,{rowIdx:s}),o)throw new Error(n+"\n"+l);return d.info(n+"\n"+l),C._CURRENT_ROW_STATUS._IGNORED}}var S=this._getFocusedRowIdx(),E=!this._compareCurrentRowValues(r,a);if(E){var T;try{T=this._trigger("beforeCurrentRow",t,{currentRow:a,previousCurrentRow:r})}catch(e){return n=C._LOGGER_MSG._ERR_PRECURRENTROW_ERROR_SUMMARY,l=i.applyParameters(C._LOGGER_MSG._ERR_PRECURRENTROW_ERROR_DETAIL,{error:e.toString()}),d.info(n+"\n"+l),C._CURRENT_ROW_STATUS._ERROR}if(!T)return C._CURRENT_ROW_STATUS._VETOED;if(this._currentRow=a,!(null==r||null==r.rowKey&&null==r.rowIndex)){var p=r.rowIndex,g=this._getRowKeyForDataSourceRowIndex(p),f=this._getRowIdxForRowKey(g);if(!1===this._setTableEditable(!1,!1,0,!0,t)){this._currentRow=r;var m=document.activeElement,A=this._getElementColumnIdx(m);return this._queueTask(function(){var e=f,t=A;null!=e&&null!=t?setTimeout(function(){this._setCellFocus(e,t)}.bind(this),0):null!=e&&setTimeout(function(){this._setRowFocus(e,!0,!1)}.bind(this),0)}.bind(this)),C._CURRENT_ROW_STATUS._IGNORED}var R=this._getTableBodyRow(f);null!=R&&R.classList.remove(C.CSS_CLASSES._TABLE_DATA_CURRENT_ROW_CLASS)}if(this.option("currentRow",this._currentRow,{_context:{writeback:!0,originalEvent:t,internalSet:!0}}),!_){var b=this._getTableBodyRow(s);null!=b&&b.classList.add(C.CSS_CLASSES._TABLE_DATA_CURRENT_ROW_CLASS)}}return!E&&S===s||null!=t||this._setRowFocus(s,!0,!1),C._CURRENT_ROW_STATUS._UPDATED},C.prototype._compareCurrentRowValues=function(t,o){if(t===o)return!0;if(null!=t&&null!=o){if(t.rowIndex===o.rowIndex&&e.KeyUtils.equals(t.rowKey,o.rowKey))return!0}else if(null==t&&null==o)return!0;return!1},C.prototype._setCellFocus=function(e,t){var o=this._getTableBodyCell(e,t);if(o){var n=a.getFocusableElementsInNode(o);if(n.length>0)return n[0].focus(),!0}return!1},C.prototype._setCellInRowFocus=function(e,t,o){if(!this._setCellFocus(e,t)){var n=this._getTableBodyCells(e);if(n)for(var i=n.length,l=0;l<i;l++){var s=l;if(o||(s=i-l-1),this._setCellFocus(e,s))return}}},C.prototype._setFocusInHandler=function(e){this._focusInHandler=e},C.prototype._setFocusOutHandler=function(e){this._focusOutHandler=e},C.prototype._setRowFocus=function(e,o,n,i,l){var s;if(-1===e)return(!n||this._setCurrentRow(null,l,!1)===C._CURRENT_ROW_STATUS._UPDATED)&&(null!=(s=this._getFocusedRowIdx())&&this._setRowFocus(s,!1,n,null,null),!0);var a=this._getTableBodyRow(e);if(!a)return!1;if(o){if(n){var r=this._getRowKeyForRowIdx(e);if(this._setCurrentRow({rowKey:r},l,!1)!==C._CURRENT_ROW_STATUS._UPDATED)return!1;null==this._accColumnIndex&&(this._accColumnIndex=0),this._updateAccStatusInfo(e,this._accColumnIndex)}null!=(s=this._getFocusedRowIdx())&&s!==e&&this._setRowFocus(s,!1,n,i,null),this._focusInHandler(t(a)),this._scrollRowIntoViewport(e),this._updateRowStateCellsClass(e,{focused:!0}),this._clearFocusedHeaderColumn(),this._setTableActionableMode(!1)}else this._focusOutHandler(t(a)),this._updateRowStateCellsClass(e,{focused:!1});return!0},C.prototype._setHeaderColumnFocus=function(e,t,o){if(null!=e){if(t){this._clearFocusedRow(!0);var n=this._getFocusedHeaderColumnIdx();null!==n&&n!==e&&this._setHeaderColumnFocus(n,!1,o),o||this._scrollColumnIntoViewport(e),this._activeColumnIndex=e,this._updateAccStatusInfo(-1,e)}this._setHeaderColumnState(e,{focused:t})}},C.prototype._setHeaderColumnState=function(e,t){var o;(o=-1===e?this._getTableSelectorColumn():this._getTableHeaderColumn(e))&&this._applyHeaderColumnState(o,e,t)},C.prototype._applyHeaderColumnState=function(e,o,n){var i=n.focused,l=n.selected;null!=l&&(e.classList.contains(C.MARKER_STYLE_CLASSES._SELECTED)!==l&&(l?e.classList.add(C.MARKER_STYLE_CLASSES._SELECTED):e.classList.remove(C.MARKER_STYLE_CLASSES._SELECTED)));null!=i&&(i?(this._focusInHandler(t(e)),o>-1&&this._showTableHeaderColumnSortIcon(o)):(this._focusOutHandler(t(e)),o>-1&&this._hideTableHeaderColumnSortIcon(o))),o>-1&&this._updateHeaderColumnStateCellsClass(o)},C.prototype._updateHeaderColumnStateCellsClass=function(e){for(var t=this._getHeaderColumnSelection(e),o=this._getSelectedRowIdxs(),n=this._getTableBodyRows(),i=0;i<n.length;i++){var l=this._getTableBodyCell(i,e);if(l)if(t)l.classList.add(C.MARKER_STYLE_CLASSES._SELECTED);else{for(var s=!1,a=o.length,r=0;r<a;r++)if(i===o[r]){s=!0;break}s||l.classList.remove(C.MARKER_STYLE_CLASSES._SELECTED)}}},C.prototype._updateRowStateCellsClass=function(e,o){var n=this._getTableBodyCells(e);if(n){if(this._isDefaultSelectorEnabled()){var i=this._getTableBodyRow(e),l=this._getTableBodySelectorCell(i);n.unshift(l)}var s,a=o.focused,r=o.selected,_=o.hover,d=n.length;if(null!=_)for(s=0;s<d;s++)_?n[s].classList.add(C.MARKER_STYLE_CLASSES._HOVER):n[s].classList.remove(C.MARKER_STYLE_CLASSES._HOVER);if(null!=a)for(s=0;s<d;s++)a?this._focusInHandler(t(n[s])):this._focusOutHandler(t(n[s]));if(null!=r)for(s=0;s<d;s++)r?n[s].classList.add(C.MARKER_STYLE_CLASSES._SELECTED):n[s].classList.remove(C.MARKER_STYLE_CLASSES._SELECTED)}},C.prototype._adjustScrollPositionOnRefresh=function(){var e=null==this.options.scrollPosition?{}:this.options.scrollPosition;if(!isNaN(e.rowIndex)&&void 0!==e.rowKey){var t=this._getSelectedRowIdxs();null!=t&&t.length>0&&this._isRowSelectionEnabled()?(!isNaN(this._selectionAnchorIdx)&&t.indexOf(this._selectionAnchorIdx)>-1?e.rowKey=this._getRowKeyForRowIdx(this._selectionAnchorIdx):e.rowKey=this._getRowKeyForRowIdx(t[0]),delete e.rowIndex):(e.y=0,e.rowIndex=0,delete e.rowKey),e.x=0,e.columnKey=null,e.columnIndex=0,e.offsetX=0,e.offsetY=0,this.option("scrollPosition",e,{_context:{internalSet:!0},changed:!1})}},C.prototype._isScrollPositionAdjusted=function(){var e=this.options.scrollPosition;return null!=e&&(void 0===e.rowIndex&&null!=e.rowKey)},C.prototype._findRowElementByKey=function(o){for(var n=this._getTableBodyRows(),i=0;i<n.length;i++)if(e.KeyUtils.equals(t(n[i]).data("rowKey"),o))return n[i];return null},C.prototype._validateKeys=function(e){for(var t=0;t<e.length;t++)if(null!=this._findRowElementByKey(e[t]))return Promise.resolve(!0);var o=this._getData();return o&&o.containsKeys?new Promise(function(t){o.containsKeys({keys:new Set(e)}).then(function(e){t(e.results.size>0)},function(){t(!1)})}):null},C.prototype._syncScrollPosition=function(e,t){if(!this._IsCustomElement()||this._noDataMessageShown||!this._isScrollableX()&&!this._isScrollableY())return!0;if(null!=this._scrollPosition?e=this._scrollPosition:void 0===e&&(e=this.options.scrollPosition),!t&&null!=e.rowKey){var o=this._validateKeys([e.rowKey]);if(o){var n=this._createComponentBusyState("is validating scroll position rowKey.");return o.then(function(t){t||delete e.rowKey,this._clearComponentBusyState(n),this._syncScrollPosition(e,!0)}.bind(this)),!1}}var i=this._getScrollCoordinates(e),l=i.x,s=i.y;if(isNaN(l)&&isNaN(s))return null!=this._scrollPosition&&(this.option("scrollPosition",this._getCurrentScrollPosition(),{_context:{originalEvent:null,internalSet:!0}}),this._scrollPosition=null),this._editRowCallback=null,!0;var a=isNaN(this._scrollTop)?0:this._scrollTop,r=isNaN(this._scrollLeft)?0:this._scrollLeft;if(!isNaN(l)&&isNaN(s)||!isNaN(l)&&s===a&&l!==r){if(!this._isScrollableX())return!0;this._setScrollX(l);var _=this.options.scrollPosition,d=this._getCurrentHorizontalScrollPosition(l);d.y=_.y,d.rowIndex=_.rowIndex,d.rowKey=_.rowKey,d.offsetY=_.offsetY,this.option("scrollPosition",d,{_context:{originalEvent:null,internalSet:!0}})}else if(s!==a){if(!this._isScrollableY())return!(!isNaN(l)&&l!==r)||(delete e.y,this._syncScrollPosition(e,t));var h=this._setScrollY(s);if(isNaN(l)||l===r||this._setScrollX(l),-1===s)return this._scrollPosition=e,h;this.option("scrollPosition",this._getCurrentScrollPosition(l,s),{_context:{originalEvent:null,internalSet:!0}})}else e&&(null==e.rowKey||isNaN(e.rowIndex))&&this.option("scrollPosition",this._getCurrentScrollPosition(l,s),{_context:{originalEvent:null,internalSet:!0}});return null!=this._scrollPosition&&(this._scrollPosition=null),this._editRowCallback&&(this._editRowCallback(),this._editRowCallback=null),!0},C.prototype._isScrollableX=function(){return Math.abs(this._getScrollWidth()-this._getClientWidth())>1},C.prototype._isScrollableY=function(){return Math.abs(this._getScrollHeight()-this._getClientHeight())>1},C.prototype._getScrollWidth=function(){return null==this._scrollWidth&&(this._scrollWidth=this._getScroller().scrollWidth),this._scrollWidth},C.prototype._getScrollHeight=function(){return null==this._scrollHeight&&(this._scrollHeight=this._getScroller().scrollHeight),this._scrollHeight},C.prototype._getClientWidth=function(){return null==this._clientWidth&&(this._clientWidth=this._getScroller().clientWidth),this._clientWidth},C.prototype._getClientHeight=function(){return null==this._clientHeight&&(this._clientHeight=this._getScroller().clientHeight),this._clientHeight},C.prototype._setScrollX=function(t){var o=this._getScroller();this._skipScrollUpdate=!0,e.DomUtils.setScrollLeft(o,t)},C.prototype._setScrollY=function(e){var t=this._getScroller();this._skipScrollUpdate=!0;var o=t.scrollTop;return t.scrollTop=-1===e?this._getScrollHeight()-this._getClientHeight():e,o!==t.scrollTop&&(this._setScrollPosBusyState(),!0)},C.prototype._getScrollTopByIndex=function(e){if(0===e)return 0;if(!(this._isLoadMoreOnScroll()&&e>this.options.scrollPolicyOptions.maxCount)){var t=this._getTableBodyRows()[e];return null!=t?t.offsetTop:this._hasMoreToFetch()?-1:void 0}},C.prototype._getScrollTopByKey=function(e){var t=this._findRowElementByKey(e);if(null!=t){var o=this._getTableBodyRows();return o.length>0?Math.max(0,t.offsetTop-o[0].offsetTop):void 0}if(this._hasMoreToFetch())return-1},C.prototype._getScrollLeftByIndex=function(e){if(0===e)return 0;var t=this._getTableHeaderColumn(e);return null!=t?t.offsetLeft:void 0},C.prototype._getScrollLeftByKey=function(e){var t=this._getColumnIdxForColumnKey(e);return this._getScrollLeftByIndex(t)},C.prototype._getScrollCoordinates=function(e){var t,o,n=e.rowKey;isNaN(t)&&null!=n&&(t=this._getScrollTopByKey(n));var i=e.columnKey;isNaN(o)&&null!=i&&(o=this._getScrollLeftByKey(i));var l=e.rowIndex;isNaN(t)&&!isNaN(l)&&(t=this._getScrollTopByIndex(l));var s=e.columnIndex;isNaN(o)&&!isNaN(s)&&(o=this._getScrollLeftByIndex(s));var a=e.offsetX;!isNaN(o)&&!isNaN(a)&&o>=0&&(o+=a);var r=e.offsetY;return!isNaN(t)&&!isNaN(r)&&t>=0&&(t+=r),isNaN(o)&&!isNaN(e.x)&&(o=Math.max(0,e.x)),isNaN(t)&&!isNaN(e.y)&&(t=e.y>this._getScrollHeight()?this._hasMoreToFetch()?-1:this._getScrollHeight()-this._getClientHeight():Math.max(0,e.y)),{x:o,y:t}},C.prototype._getCurrentHorizontalScrollPosition=function(e){var t={};t.x=void 0===e?this._scrollLeft:e;var o=this.option("scrollPosition"),n=Math.abs(o.x-t.x);if(n<1&&null!=o.columnKey&&!isNaN(o.columnIndex))return t.columnKey=o.columnKey,t.columnIndex=o.columnIndex,t.offsetX=o.offsetX+n,t;var i=this._getColumnLocations();if(i&&i.length>0){var l,s=i.length-1;for(l=0;l<i.length-1;l++)if(t.x>=i[l]&&t.x<i[l+1]){s=l;break}t.columnKey=this._getColumnDefs()[s].id,t.columnIndex=s,t.offsetX=t.x-i[s]}return t},C.prototype._getCurrentVerticalScrollPosition=function(e){var t={};t.y=void 0===e?this._scrollTop:e;var o=this._getTableBody();if(isNaN(this._rowHeight)&&o.rows.length>1&&(this._rowHeight=o.rows[1].offsetHeight),!isNaN(this._rowHeight)&&this._rowHeight>0){var n=this._findClosestElementToTop(t,e);null!=n&&(t.rowIndex=n.index,t.rowKey=this._getRowKeyForRowIdx(n.index),t.offsetY=n.offset)}return t},C.prototype._getCurrentScrollPosition=function(e,t){var o=this._getCurrentHorizontalScrollPosition(e),n=this._getCurrentVerticalScrollPosition(t);return Object.keys(n).forEach(function(e){o[e]=n[e]}),o},C.prototype._getColumnLocations=function(){if(null==this._columnOffsets){this._columnOffsets=[];var e=this._getTableHeaderColumns();if(e&&e.length>0){var t;t=e[0].offsetLeft,this._columnOffsets.push(0);for(var o=1;o<e.length;o++)this._columnOffsets.push(e[o].offsetLeft-t)}}return this._columnOffsets},C.prototype._findClosestElementToTop=function(e,t){var o,n=this._getTableBodyRows();if(0===n.length)return null;var i,l=this.option("scrollPosition");Math.abs(l.y-t)<this._rowHeight&&null!=l.rowKey&&!isNaN(l.rowIndex)&&(o=l.rowIndex),isNaN(o)&&(o=Math.floor(e.y/this._rowHeight));var s=n[o=Math.min(Math.max(o,0),n.length-1)];i=0===o?0:s.offsetTop-n[0].offsetTop;var a=e.y,r=a-i,_={index:o,elem:s,offsetTop:i,offset:r};if(Math.abs(r)<1)return _;var d=r>0;d?o+=1:o-=1;for(var h=!1;!h&&o>=0&&o<n.length;){var u=i;if(i=(s=n[o]).offsetTop,h=(r=Math.abs(a-i))<1||(d?a<=i:a>=i)){_=r<1||!d?{index:o,elem:s,offsetTop:i,offset:r}:{index:o-1,elem:n[o-1],offsetTop:u,offset:a-u};break}d?o+=1:o-=1}return _},C.prototype._handleScrollerScrollLeft=function(t){this._scrollLeft=t;var o=this._getTableHeaderRow();o&&e.DomUtils.setScrollLeft(o.parentNode,t);var n=this._getTableFooterRow();n&&e.DomUtils.setScrollLeft(n.parentNode,t)},C.prototype._handleScrollerScrollTop=function(e){this._domScroller||this._clearScrollPosBusyState(),e<0&&(e=0),this._scrollTop=e,this._scrollY=this._skipScrollUpdate?e:null,this._moveTableBodyRowTouchSelectionAffordanceTop(),this._moveTableBodyRowTouchSelectionAffordanceBottom()},C.prototype._registerDomEventListeners=function(){var e=this._getScroller();null!=e&&(null==this._scrollEventListener&&(this._scrollEventListener=function(e){var t=this._getScrollLeft(e.target),o=e.target.scrollTop;t===this._scrollLeft&&o===this._scrollTop||(this._handleScrollerScrollLeft(t),this._handleScrollerScrollTop(o),this._isScrollPositionAdjusted()||(this._skipScrollUpdate||this._ticking||(window.requestAnimationFrame(function(){this._isScrollPositionAdjusted()||this._skipScrollUpdate||this.option("scrollPosition",this._getCurrentScrollPosition(),{_context:{originalEvent:e,internalSet:!0}}),this._ticking=!1}.bind(this)),this._ticking=!0),this._skipScrollUpdate=!1))}.bind(this)),e.removeEventListener("scroll",this._scrollEventListener),e.addEventListener("scroll",this._scrollEventListener,!1));var t=this._getTableHeaderRow();if(null!=t){var o=t.parentNode;null==this._headerScrollEventListener&&(this._headerScrollEventListener=function(e){var t=this._getScrollLeft(e.target);this._scrollLeft!==t&&this._setScrollX(t)}.bind(this)),o.removeEventListener("scroll",this._headerScrollEventListener),o.addEventListener("scroll",this._headerScrollEventListener,!1)}},C.prototype._isTableActionableMode=function(){return this._tableActionableMode},C.prototype._isTableEditMode=function(){return this.options.editMode===C._OPTION_EDIT_MODE._ROW_EDIT},C.prototype._toggleTableActionableMode=function(){this._isTableActionableMode()?this._setTableActionableMode(!1):this._setTableActionableMode(!0)},C.prototype._setTableActionableMode=function(e,o){if(!(null!=this._tableActionableMode&&this._tableActionableMode===e||null==this._tableActionableMode&&!1===e))if(e){var n=null,i=null,l=this._getFocusedRowIdx();if(null!=l&&(i=n=this._getTableBodyRow(l)),null==n){var s=this._getFocusedHeaderColumnIdx();null!=s&&(n=this._getTableHeaderColumn(s),i=this._getTableHeaderRow())}if(null!=n){a.enableAllFocusableElements(i);var r=this._getTabbableElements(n);null!=r&&r.length>0&&(this._tableActionableMode=e,this._tableActionableElement=n,this._tableActionableBoundaryElement=i,this._focusOutHandler(t(n)),r[0].focus())}}else{this._tableActionableMode=!1;var _=t.contains(this._getTableBody(),document.activeElement);null!=this._tableActionableElement&&a.disableAllFocusableElements(this._tableActionableBoundaryElement),_&&!o&&(this._getTable().focus(),this._focusInHandler(t(this._tableActionableElement))),this._tableActionableElement=null,this._tableActionableBoundaryElement=null}},C.prototype._getEditableRowIdx=function(){if(null!=this._getEditableRowKey()){var e=this._getRowIdxForRowKey(this._getEditableRowKey());if(null!==e)return e}return this._editableRowIdx},C.prototype._getEditableRowKey=function(){return this._editableRowKey},C.prototype._hasEditableRow=function(){return!!this._isTableEditMode()&&null!==this._getEditableRowIdx()},C.prototype._setEditRow=function(e){if(this._isTableEditMode()){var t=e.rowKey,o=e.rowIndex;if(null!=t||o>-1){var n=this._setCurrentRow({rowKey:t,rowIndex:o},null,!1);if(n===C._CURRENT_ROW_STATUS._UPDATED)this._setTableEditable(!0,!1,0,!0,null);else if(n===C._CURRENT_ROW_STATUS._IGNORED){var i=this._scrollTop;this._syncScrollPosition({rowKey:t,rowIndex:o})||(this._editRowCallback=function(){this._scrollTop!==i&&this._setEditRow(e)}.bind(this))}}else this._setTableEditable(!1,!1,0,!0,null)}},C.prototype._setEditableRowIdx=function(e){this._editableRowKey=this._getRowKeyForRowIdx(e),this._editableRowIdx=e},C.prototype._setNextRowEditable=function(e,t){var o=this._getTableBodyRows().length,n=this._getEditableRowIdx();n>=0&&n<o-1?!1===this._setTableEditable(!1,!1,e,!0,t)?this._queueTask(function(){setTimeout(function(){this._setCellFocus(n,e)}.bind(this),0)}.bind(this)):(this._setCurrentRow({rowIndex:n+1},t,!1),this._setTableEditable(!0,!1,e,!0,t)):n===o-1&&(this._setTableEditable(!1,!1,e,!0,t),this._getTable().focus())},C.prototype._setPreviousRowEditable=function(e,t){var o=this._getEditableRowIdx();o>=1?!1===this._setTableEditable(!1,!1,e,!1,t)?this._queueTask(function(){setTimeout(function(){this._setCellFocus(o,e)}.bind(this),0)}.bind(this)):(this._setCurrentRow({rowIndex:o-1},t,!1),this._setTableEditable(!0,!1,e,!1,t)):0===o&&(this._setTableEditable(!1,!1,e,!1,t),this._getTable().focus())},C.prototype._fireEditRowChangeEvent=function(e,t){this._queueTask(function(){this.option("editRow",e,{_context:{originalEvent:t,internalSet:!0,writeback:!0}})}.bind(this))},C.prototype._setTableEditable=function(e,t,o,n,i,l){if(this._isTableEditMode()){var s=this._getCurrentRow();if(null!=s){var a,r,_,d,h=s.rowKey,u=this._getRowIdxForRowKey(h);try{if(e&&!this._hasEditableRow())a=this._getTableBodyRow(u),r=this._getRendererContextObject(a,{row:{key:h,index:s.rowIndex},isCurrentRow:!0}),(_=this._trigger("beforeRowEdit",i,{rowContext:r}))&&(d={rowKey:h,rowIndex:u});else{if(e||!this._hasEditableRow())return;a=this._getTableBodyRow(this._getEditableRowIdx()),h=this._getRowKeyForRowIdx(this._getEditableRowIdx()),r=this._getRendererContextObject(a,{row:{key:h,index:this._getDataSourceRowIndexForRowKey(h)},isCurrentRow:!0}),(_=this._trigger("beforeRowEditEnd",i,{rowContext:r,cancelEdit:t}))&&(d={rowKey:null,rowIndex:-1})}}catch(e){return!1}if(!_)return!1;d&&this._fireEditRowChangeEvent(d,i);var c=this._getEditableRowIdx();if(e?(this._setEditableRowIdx(u),this._getTable().setAttribute(C.DOM_ATTR._ARIA_LABELLEDBY,""),this._accStatus.setAttribute(C.DOM_ATTR._ARIA_LABELLEDBY,""),this._queueTask(function(){this._refreshRow(u,!0).then(function(){this._setRowFocus(u,!0,!1),this._setCellInRowFocus(u,o,n)}.bind(this))}.bind(this))):(this._focusEditCell=null,this._setEditableRowIdx(null),l||this._getTable().focus()),null!=c)null!=this._getTableBodyRow(c)&&this._refreshRow(c,!1)}}},C._KEYBOARD_CODES={_MODIFIER_SHIFT:"shiftKey"},C.prototype._getKeyboardKeys=function(){return this._keyboardKeys||(this._keyboardKeys=[]),this._keyboardKeys.reverse()},C.prototype._addKeyboardKey=function(e){var t,o=!1,n=Object.keys(a.KEYBOARD_KEYS);for(t=0;t<n.length;t++){var i=n[t];if(a.KEYBOARD_KEYS[i]===e){o=!0;break}}if(o){var l=this._getKeyboardKeys(),s=!1,r=l.length;for(t=0;t<r;t++)if(l[t]===e){s=!0;break}s||l.push(e)}},C.prototype._isKeyPressMatch=function(e){for(var t=this._getKeyboardKeys(),o=0;o<t.length;o++)if(e(t[o]))return!0;return!1},C.prototype._removeKeyboardKey=function(e){for(var t=this._getKeyboardKeys(),o=t.length,n=0;n<o;n++)t[n]===e&&t.splice(n,1)},C.prototype._clearKeyboardKeys=function(){this._keyboardKeys=[]},C.prototype._handleKeydownLeftRight=function(e,t){if(!this._isTableActionableMode()&&!this._hasEditableRow()){var o,n,i="rtl"===this._GetReadingDirection(),l=this._isKeyPressMatch(a.isArrowLeftKeyEvent),s=i&&l||!i&&!l,r=this._getFocusedHeaderColumnIdx();null!=r?(o=!t||this._isNavigate||null==this._lastSelectedHeaderIdx?r:this._lastSelectedHeaderIdx,n=this._getNextVisibleColumnIndex(o,s),t?(this._isNavigate=!1,this._selectRange(r,n,!1),this._scrollColumnIntoViewport(n)):(this._isNavigate=!0,0===o&&!1===s&&this._isDefaultSelectorEnabled()&&(n=-1),n!==r&&this._setHeaderColumnFocus(n,!0,!1))):(o=this._accColumnIndex,n=this._getNextVisibleColumnIndex(o,s),this._updateAccStatusInfo(this._accRowIndex,n))}},C.prototype._handleKeydownUpDown=function(e,t){if(!this._isTableActionableMode()&&!this._hasEditableRow()){var o=this._getFocusedRowIdx();if(null!=o){var n,i,l=this._getTableBodyRows().length;if(n=!t||this._isNavigate||null==this._lastSelectedRowIdx?o:this._lastSelectedRowIdx,this._isKeyPressMatch(a.isArrowUpKeyEvent)?i=n>0?n-1:n:this._isKeyPressMatch(a.isArrowDownKeyEvent)&&(i=n<l-1?n+1:n),t)this._isNavigate=!1,this._selectRange(o,i,!0),this._scrollRowIntoViewport(i);else if(this._isNavigate=!0,i!==o){if(!this._setRowFocus(i,!0,!0,null,e))return;this._getTable().focus()}else if(0===i&&this._isKeyPressMatch(a.isArrowUpKeyEvent)){var s=this._getFirstVisibleColumnIndex(0,!0);this._setHeaderColumnFocus(s,!0,!1)}}else if(this._isKeyPressMatch(a.isArrowDownKeyEvent)){null!=this._getFocusedHeaderColumnIdx()&&this._setRowFocus(0,!0,!0,null,e)}}},C.prototype._getTabbableElements=function(e,o){var n=null;return null!=(n=o?t(e).find(":tabbable"):t(e).find(":tabbable").not(".oj-helper-hidden-accessible"))&&n.length>0?n.toArray():null},C.prototype._handleKeydownTab=function(e){var o,n,i=!1,l=this._getFocusedRowIdx(),s=this._getFocusedHeaderColumnIdx();if(this._isTableActionableMode()||this._hasEditableRow()){var a=document.activeElement,r=this._getTableBody(),_=this._getTableHeader();if(null!=l&&this._getEditableRowIdx()===l){var d=this._getTableBodyRow(l),h=this._getTabbableElements(d),u=null!=h?h.length:0,c=t(h).index(a);if(c===u-1&&!e[C._KEYBOARD_CODES._MODIFIER_SHIFT])return this._setNextRowEditable(0,e),e.preventDefault(),void e.stopPropagation();if(0!==c||!e[C._KEYBOARD_CODES._MODIFIER_SHIFT])return;var S=this._getTableHeaderColumns();if(S){var E=S.length;return this._setPreviousRowEditable(E-1,e),e.preventDefault(),void e.stopPropagation()}}else if(this._tableActionableBoundaryElement){var T;if(n=this._tableActionableBoundaryElement,(o=this._getTabbableElements(n)).length>1){if(e[C._KEYBOARD_CODES._MODIFIER_SHIFT]){if(a===o[0])t(o[o.length-1]).focus(),e.preventDefault(),e.stopPropagation();else for(T=0;T<o.length;T++)if(a===o[T]){o[T-1].focus(),e.preventDefault(),e.stopPropagation();break}}else if(a===o[o.length-1])t(o[0]).focus(),e.preventDefault(),e.stopPropagation();else for(T=0;T<o.length;T++)if(a===o[T]){o[T+1].focus(),e.preventDefault(),e.stopPropagation();break}}else e.preventDefault(),e.stopPropagation();return}if((null!=l&&!this._hasEditableRow()||null!=s)&&!e[C._KEYBOARD_CODES._MODIFIER_SHIFT]){if(i=!0,n=null,null!=l?n=this._getTableBodyRow(l):null!=s&&(n=this._getTableHeaderColumn(s)),null!=(o=this._getTabbableElements(n)))t(o[0]).focus();else if(null!=l){var p=this._getTabbableElements(r);t(p[0]).focus()}else if(null!=s){var g=this._getTabbableElements(_);t(g[0]).focus()}e.preventDefault(),e.stopPropagation()}}if(!i){var f=this._getTable(),m=this._getTabbableElements(f,!0),A=null!=m?m.length:0,R=f;return e[C._KEYBOARD_CODES._MODIFIER_SHIFT]||(this._isFF()?((R=document.createElement(C.DOM_ELEMENT._A)).setAttribute(C.DOM_ATTR._TABINDEX,"0"),R.setAttribute(C.DOM_ATTR._HREF,"#"),R.classList.add(C.CSS_CLASSES._HIDDEN_CONTENT_ACC_CLASS),f.insertAdjacentElement("afterend",R),this._temporaryFocusForFF=R):A>0&&(R=m[A-1])),this._temporaryTableChildElementFocus=!0,R.focus(),void setTimeout(function(){this._temporaryTableChildElementFocus=!1,this._temporaryFocusForFF&&(t(this._temporaryFocusForFF).remove(),this._temporaryFocusForFF=null)}.bind(this),0)}var b=e.key||e.keyCode;this._removeKeyboardKey(b)},C.prototype._handleKeydownEnter=function(e){if(!this._isTableActionableMode()){var o=this._getFocusedHeaderColumnIdx();if(null!=o&&this._getColumnDefs()[o].sortable===C._OPTION_ENABLED){var n=this._getTableHeaderColumn(o),i=t(n).data("sorted");null==i||i===C._COLUMN_SORT_ORDER._DESCENDING?this._handleSortTableHeaderColumn(o,!0,e):this._handleSortTableHeaderColumn(o,!1,e)}else{var l=this._getCurrentRow(),s=(l=l||{}).rowIndex;if(s>=0)if(this._isTableEditMode()){if(!this._hasEditableRow())return void this._setTableEditable(!0,!1,0,!0,e);var a=this._getElementColumnIdx(e.target);e[C._KEYBOARD_CODES._MODIFIER_SHIFT]?this._setPreviousRowEditable(a,e):this._setNextRowEditable(a,e)}else this._fireActionEvent(s,e),this._setTableActionableMode(!0)}}},C.prototype._handleKeydownSpacebar=function(e){if(!this._isTableActionableMode()&&!this._hasEditableRow()){e.preventDefault(),e.stopPropagation();var t=this._getFocusedRowIdx();if(null!=t)this._handleSelectionGesture(t,!0,!0);else{var o=this._getFocusedHeaderColumnIdx();null!=o&&this._handleSelectionGesture(o,!1,!0)}}},C.prototype._handleKeydownF2=function(e){e.preventDefault(),e.stopPropagation(),this._isTableEditMode()?this._hasEditableRow()?this._setTableEditable(!1,!1,0,!0,e):(this._setTableEditable(!0,!1,0,!0,e),this._hasEditableRow()||this._toggleTableActionableMode()):this._toggleTableActionableMode()},C.prototype._handleKeydownEsc=function(e){this._hasEditableRow()?(e.preventDefault(),e.stopPropagation(),this._setTableEditable(!1,!0,0,!0,e),this._getTable().focus()):this._isTableActionableMode()&&(e.preventDefault(),e.stopPropagation(),this._setTableActionableMode(!1),this._getTable().focus()),this._clearTableHeaderColumnsResize()},C.prototype._handleKeydownHome=function(e){if(!this._isTableActionableMode()&&!this._hasEditableRow()){var t=this._getFocusedHeaderColumnIdx();if(null!=t&&0!==t){var o=this._getFirstVisibleColumnIndex(0,!0);this._setHeaderColumnFocus(o,!0,!1)}else{var n=this._getFocusedRowIdx();null!=n&&0!==n&&this._setRowFocus(0,!0,!0,null,e)}}},C.prototype._handleKeydownEnd=function(e){if(!this._isTableActionableMode()&&!this._hasEditableRow()){var t=this._getFocusedHeaderColumnIdx();if(null!=t&&t!==this._getColumnDefs().length-1){var o=this._getFirstVisibleColumnIndex(this._getColumnDefs().length-1,!1);this._setHeaderColumnFocus(o,!0,!1)}else{var n=this._getFocusedRowIdx();if(null!=n){var i=this._getTableBodyRows().length;n!==i-1&&i>0&&this._setRowFocus(i-1,!0,!0,null,e)}}}},C.prototype._columnHeaderDefaultRenderer=function(e,o){var n=e.headerContext.parentElement,i=document.createElement(C.DOM_ELEMENT._DIV);i.classList.add(C.CSS_CLASSES._COLUMN_HEADER_CLASS),t(n).empty(),n.appendChild(i);var l=document.createElement(C.DOM_ELEMENT._DIV);l.classList.add(C.CSS_CLASSES._COLUMN_HEADER_TEXT_CLASS),i.insertBefore(l,i.firstChild),null!=o?o(t(l)):this._columnHeaderDefaultTextRenderer(l,e)},C.prototype._columnHeaderSortableIconRenderer=function(e,o){var n=e.headerContext.parentElement,i=document.createElement(C.DOM_ELEMENT._DIV);i.classList.add(C.CSS_CLASSES._COLUMN_HEADER_CLASS),t(n).empty(),n.appendChild(i);var l=document.createElement(C.DOM_ELEMENT._DIV);l.classList.add(C.CSS_CLASSES._TABLE_SORT_ICON_CONTAINER_CLASS),this._AddHoverable(t(l)),i.appendChild(l);var s=document.createElement(C.DOM_ELEMENT._DIV);s.classList.add(C.CSS_CLASSES._WIDGET_ICON_CLASS),s.classList.add(C.CSS_CLASSES._COLUMN_HEADER_DEFAULT_SORT_ICON_CLASS),s.classList.add(C.MARKER_STYLE_CLASSES._DISABLED),s.classList.add(C.MARKER_STYLE_CLASSES._CLICKABLE_ICON),this._AddHoverable(t(s)),l.appendChild(s);var a=document.createElement(C.DOM_ELEMENT._DIV);a.classList.add(C.CSS_CLASSES._COLUMN_HEADER_TEXT_CLASS),i.insertBefore(a,i.firstChild),null!=o?o(t(a)):this._columnHeaderDefaultTextRenderer(a,e)},C.prototype._columnHeaderDefaultTextRenderer=function(e,t){var o=t.columnIndex,n=this._getColumnDefs()[o],i=null==n.headerText?"":n.headerText;e.appendChild(document.createTextNode(i))},C.prototype._tableBodyRowDefaultRenderer=function(e,t,o){var n=o.rowContext.parentElement,i=this._hashCode(t.key),l=this._getColumnDefs();this._setTableBodyRowAttributes(t,n);for(var s=l.length,a=0;a<s;a++)this._tableBodyCellDefaultRenderer(e,a,t,i,o)},C.prototype._tableBodyCellDefaultRenderer=function(e,o,n,i,l){var s=l.rowContext.parentElement,a=this._getColumnDefs()[o],r=this._createTableBodyCell();this._styleTableBodyCell(o,r,!0),this._insertTableBodyCell(e,n.key,i,o,r,s,!0);var _=null;null!=a.field&&(_=this._getObjectPath(n.data,a.field));var d=this._getColumnRenderer(o,"cell"),h=this._getSlotTemplate(a.template);if(null==h&&this._isDefaultCellTemplateSlotValid()&&(h=this._getSlotTemplate("cellTemplate")),d||h){var u=this._getRendererContextObject(r,{row:n}),c={cellContext:u,columnIndex:o,data:_,row:n.data,componentElement:u.componentElement,parentElement:u.parentElement};if(d){var S=d(c);null!=S?t(r).append(S):(r=this._isDefaultSelectorEnabled()?t(s).children()[o+1]:t(s).children()[o],this._setTableBodyCellAttributes(e,n.key,i,o,r),this._styleTableBodyCell(o,r,!1))}else{var C=this._getRootElement(),E=this._getTemplateEngine();if(null!=E){var T=this._getCellSlotTemplateContextObject(c),p=E.execute(C,h,T,this.options.as);p instanceof Array||(p=[p]),p.map(function(e){r.appendChild(e)}),this._hasCellTemplate=!0}}}else{var g=null==(_=this._getVal(_))?"":_;r.appendChild(document.createTextNode(g))}},C.prototype._getRendererContextObject=function(t,o){var n={};n.component=s.__GetWidgetConstructor(this.element,"ojTable");var i=this.options.data;if(e.PagingTableDataSource&&i instanceof e.PagingTableDataSource&&(i=i.getWrappedDataSource()),n.datasource=i,n.parentElement=t,null!=o.row){var l=o.row,a=l.key;if(n.status=this._getRendererStatusObject(l),this._hasEditableRow()){var r=this._getEditableRowKey();e.Object.compareValues(a,r)?n.mode="edit":n.mode="navigation"}else n.mode="navigation";this._copyMetadata(n,l,i)}return this._FixRendererContext(n)},C.prototype._getRendererStatusObject=function(e){return{rowIndex:e.index,rowKey:e.key,currentRow:t.extend({},this._getCurrentRow())}},C.prototype._getCellSlotTemplateContextObject=function(e){var t=this._getSlotTemplateContextObject(),o=e.cellContext.status.rowIndex,n=e.cellContext.status.rowKey,i=e.columnIndex;return t[C._CONST_DATA]=e.data,t.row=e.row,t[C._CONST_INDEX]=o,t.columnIndex=i,t.mode=e.cellContext.mode,t[C._CONST_KEY]=n,t},C.prototype._getRowSlotTemplateContextObject=function(e){var t=this._getSlotTemplateContextObject();return t[C._CONST_DATA]=e.data,t[C._CONST_INDEX]=e.rowContext.status.rowIndex,t.rowContext=e.rowContext,t.mode=e.rowContext.mode,t[C._CONST_KEY]=e.rowContext.status.rowKey,t},C.prototype._getHeaderSlotTemplateContextObject=function(e,t){var o=this._getSlotTemplateContextObject();return o[C._CONST_DATA]=e,o.columnIndex=t,o},C.prototype._getSlotTemplateContextObject=function(){return{componentElement:this._getRootElement()}},C.prototype._copyMetadata=function(e,t,o){var n=t.metadata;if(o._getMetadata&&(n=o._getMetadata(t.index)),n)for(var i=Object.keys(n),l=0;l<i.length;l++){var s=i[l];e[s]=n[s]}},C.prototype._getObjectPath=function(e,t){if(null!=e&&("string"==typeof t||t instanceof String)&&(-1!==t.indexOf(".")||-1!==t.indexOf("[")&&-1!==t.indexOf("]"))){var o=e,n=!1;if(t.split(".").map(function(e){if(null!=o&&-1!==e.indexOf("[")&&-1!==e.indexOf("]")){var t=e.substr(0,e.indexOf("[")),i=parseInt(e.substr(e.indexOf("[")+1,e.indexOf("]")-e.indexOf("[")-1),10);o=o[t][i],n=!0}else null!==o&&void 0!==o[e]&&(o=o[e],n=!0)}),n)return o}else if(null==e)return null;return e[t]},C.prototype._getVal=function(e){return"function"==typeof e?e():e},C.RESIZE_OFFSET=10,C.prototype._setResizeCursor=function(e){var t=this._getEventTargetElement(e),o=this._getElementColumnIdx(t);if(null==o)return!1;if(this._getColumnDefs()[o].resizable===C._OPTION_DISABLED&&this._resizeStartColumnIdx!==o-1&&this._resizeStartColumnIdx!==o+1)return!1;if(null==this._resizeStartColumnIdx)return null!==this._isHeaderColumnResizeStart(e)?(t.style.cursor="col-resize",!0):(t.style.cursor="",!1);if(!this._getTableHeaderColumns())return!1;if(o===this._resizeStartColumnIdx||this._resizeColumnStart&&o===this._resizeStartColumnIdx-1||!this._resizeColumnStart&&o===this._resizeStartColumnIdx+1){var n=this._getTableHeaderColumnResizeIndicator();if(null!=n){var i=this._getTable().getBoundingClientRect();return n.style.left=this._getPageX(e)-i.left+"px",!0}}return!1},C.prototype._handleHeaderColumnResizeStart=function(e){var t=this._getEventTargetElement(e),o=this._getElementColumnIdx(t);if(null!=o){var n=this._getColumnDefs()[o];if(this._resizeColumnStart=this._isHeaderColumnResizeStart(e),n.resizable===C._OPTION_ENABLED&&null!==this._resizeColumnStart)return this._resizeStartColumnIdx=o,this._resizeStartPageX=this._getPageX(e),this._setTableHeaderColumnsResizeStyling(),this._setTableHeaderColumnResizeIndicator(o),!0}return this._resizeStartColumnIdx=null,this._resizeStartPageX=null,!1},C.prototype._handleHeaderColumnResizeEnd=function(e){var o=this.options.columns.length,n=this._getEventTargetElement(e),i=this._getElementColumnIdx(n);if(null!==i&&i===this._resizeStartColumnIdx||this._resizeColumnStart&&i===this._resizeStartColumnIdx-1||!this._resizeColumnStart&&i===this._resizeStartColumnIdx+1){var l=this._getTableHeaderColumn(this._resizeStartColumnIdx);if(null!=l){var s,a=l.getBoundingClientRect().width;if(this._resizeStartColumnIdx===o-1&&this._tableHeightConstrained&&(a-=this._getScrollBarWidth()),s="rtl"===this._GetReadingDirection()&&this._resizeColumnStart||"ltr"===this._GetReadingDirection()&&!this._resizeColumnStart?this._getPageX(e)-this._resizeStartPageX:this._resizeStartPageX-this._getPageX(e),Math.abs(s)>2){for(var r=a+s,_=[],d=0;d<o;d++)_[d]=t.extend({},{},this.options.columns[d]);_[this._resizeStartColumnIdx].width=r;var h=this._resizeColumnStart?this._resizeStartColumnIdx-1:this._resizeStartColumnIdx+1;h===o-1&&this._tableHeightConstrained&&(s+=this._getScrollBarWidth());var u=this._getTableHeaderColumn(h);if(u){var c=u.getBoundingClientRect().width;_[h].width=c-s}return this.option("columns",_,{_context:{writeback:!0,internalSet:!0}}),this._clearCachedMetadata(),this._queueTask(function(){setTimeout(function(){this._clearTableHeaderColumnsResize()}.bind(this),0)}.bind(this)),!0}}}return this._clearTableHeaderColumnsResize(),!1},C.prototype._clearTableHeaderColumnsResize=function(){this._resizeStartColumnIdx=null,this._resizeColumnStart=null,this._resizeStartPageX=null,this._clearTableHeaderColumnsResizeStyling(),this._removeTableHeaderColumnResizeIndicator()},C.prototype._getPageX=function(e){return void 0!==e.pageX?e.pageX:void 0!==e.changedTouches?e.changedTouches[0].pageX:0},C.prototype._isHeaderColumnResizeStart=function(e){var t=null,o=this.options.columns.length,n=this._getElementColumnIdx(e.target),i=this._getTableHeaderColumn(n);if(null!==i){var l=this._GetReadingDirection(),s=i.getBoundingClientRect(),a=Math.abs(this._getPageX(e)-s.left),r=Math.abs(this._getPageX(e)-s.right);a<=C.RESIZE_OFFSET?"rtl"===l&&n!==o-1?t=!1:"ltr"===l&&0!==n&&(t=!0):r<=C.RESIZE_OFFSET&&("ltr"===l&&n!==o-1?t=!1:"rtl"===l&&0!==n&&(t=!0))}return t},C.prototype._setTableHeaderColumnResizeIndicator=function(e){var t=this._getTableHeaderColumnResizeIndicator();null==t&&(t=this._createTableHeaderColumnResizeIndicator());var o=this._getTable().getBoundingClientRect(),n=this._getTableHeaderColumn(e).getBoundingClientRect();t.style.height=o.height+"px",this._resizeColumnStart?("rtl"===this._GetReadingDirection()?t.style.left=n.left+n.width-o.left+"px":t.style.left=n.left-o.left+"px",t.style.borderLeftWidth="2px",t.style.borderRightWidth="0"):("rtl"===this._GetReadingDirection()?t.style.left=n.left-o.left+"px":t.style.left=n.left+n.width-o.left+"px",t.style.borderRightWidth="2px",t.style.borderLeftWidth="0")},C.prototype._setTableHeaderColumnsResizeStyling=function(){this._getTable().classList.add(C.CSS_CLASSES._COLUMN_HEADER_RESIZING_CLASS)},C.prototype._clearTableHeaderColumnsResizeStyling=function(){var e=this._getTableHeaderColumns();if(e)for(var t=0;t<e.length;t++)e[t].style.cursor="";this._getTable().classList.remove(C.CSS_CLASSES._COLUMN_HEADER_RESIZING_CLASS)},C.prototype._getRowSelectionMode=function(){return null==this.options.selectionMode?null:this.options.selectionMode[C._CONST_ROW]},C.prototype._isRowSelectionEnabled=function(){var e=this._getRowSelectionMode();return e===C._OPTION_SELECTION_MODES._SINGLE||e===C._OPTION_SELECTION_MODES._MULTIPLE},C.prototype._getColumnSelectionMode=function(){return null==this.options.selectionMode?null:this.options.selectionMode[C._CONST_COLUMN]},C.prototype._isColumnSelectionEnabled=function(){var e=this._getColumnSelectionMode();return e===C._OPTION_SELECTION_MODES._SINGLE||e===C._OPTION_SELECTION_MODES._MULTIPLE},C.prototype._syncSelectionState=function(){var e=this.option("selected"),t=this.option("selection");this._selectionSet&&(e=this._getSelectedEquivalent(t),this._syncRangeSelection()),this._isSelectionRequiredSatisfied(e)?this._setSelected(e,this._selectionSet):this._selectFirstRowOrColumn()},C.prototype._updateSelectionStateFromEventDetailRemove=function(e,t){var o=this.option("selected"),n=o.row;n&&(e[C._CONST_KEYS].forEach(function(e){null!=t&&t[C._CONST_KEYS].has(e)||(n.isAddAll()?n.has(e)||(n=n.add([e])):n=n.delete([e]))}),o.row!==n&&(o={row:n,column:o.column},this._isSelectionRequiredSatisfied(o)?this._setSelected(o):this._selectFirstRowOrColumn()))},C.prototype._validateInitialSelectionState=function(e){var t,o,n=this.option("selection"),i=this.option("selected"),l=i.row,s=i.column;if(this._validatedSelectedRowKeyData=null,(this._selectionSet||!e&&null!=n&&0!==n.length&&l===l.clear()&&s===s.clear())&&(i=this._getSelectedEquivalent(n),t=!0),this._isSelectionRequired())if((o=this._validateSelected(i)).isLocal)this._enforceSelectionRequired(i,o.result,t);else{var a=this._createComponentBusyState("is validating selection-required keys.");o.result.then(function(e){this._enforceSelectionRequired(i,e,t),this._clearComponentBusyState(a)}.bind(this))}else t&&this._syncRangeSelection(),this._setSelected(i,t);this._initialSelectionStateValidated=!0},C.prototype._isSelectionRequired=function(){return"true"===String(this.options.selectionRequired).toLowerCase()},C.prototype._hasSelected=function(e){null==e&&(e=this.option("selected"));var t=e.row,o=e.column;return t.isAddAll()||t.values().size>0||o.isAddAll()||o.values().size>0},C.prototype._isSelectionRequiredSatisfied=function(e){return!this._isSelectionRequired()||this._hasSelected(e)},C.prototype._enforceSelectionRequired=function(e,t,o){o?this._hasSelected(t)?t.row===e.row&&t.column===e.column?(this._syncRangeSelection(),this._setSelected(t,!0)):this._setSelected(t):this._selectFirstRowOrColumn():this._hasSelected(t)?this._setSelected(t):this._selectFirstRowOrColumn()},C.prototype._selectFirstRowOrColumn=function(){var t,o;if(this._isRowSelectionEnabled()&&null!=(o=this._getRowKeyForRowIdx(0)))return t=new e.KeySetImpl([o]),void this._setSelected({row:t,column:new e.KeySetImpl});this._isColumnSelectionEnabled()&&null!=(o=this._getColumnKeyForColumnIdx(0))&&(t=new e.KeySetImpl([o]),this._setSelected({row:new e.KeySetImpl,column:t}))},C.prototype._validateSelected=function(e){var t=e.column,o=t;if(!t.isAddAll()){var n=this._getColumnKeys(),i=[];t.values().forEach(function(e){-1===n.indexOf(e)&&i.push(e)}),i.length>0&&(o=o.delete(i))}var l=e.row,s=l;if(!l.isAddAll()){var a=this._getLocalRowKeys(),r=[];if(l.values().forEach(function(e){-1===a.indexOf(e)&&r.push(e)}),r.length>0){var _=this._fetchValidRowKeyData(r);if(_)return{isLocal:!1,result:_.then(function(e){return this._validatedSelectedRowKeyData=e,e.forEach(function(e){r.splice(r.indexOf(e.key),1)}),{row:s=s.delete(r),column:o}}.bind(this))};s=s.delete(r)}}return{isLocal:!0,result:{row:s,column:o}}},C.prototype._fetchValidRowKeyData=function(e){var t=this._getData();if(t&&t.getCapability){var o=t.getCapability("fetchByKeys");if(o&&"lookup"===o.implementation)return new Promise(function(o){t.fetchByKeys({keys:new Set(e),scope:"global"}).then(function(e){var t=[];e.results.forEach(function(e,o){t.push({key:o,data:e.data})}),o(t)},function(){o([])})})}return null},C.prototype._syncRangeSelection=function(e){if(void 0===e&&(e=this.option("selection")),null!=e)for(var t=e.length,o=0;o<t;o++){var n,i,l,s,a=e[o];null!=a.startKey&&null!=a.startKey[C._CONST_ROW]?(n=a.startKey[C._CONST_ROW],i=this._getDataSourceRowIndexForRowKey(n),a.startIndex={},a.startIndex[C._CONST_ROW]=i):null!=a.startIndex&&null!=a.startIndex[C._CONST_ROW]&&(i=a.startIndex[C._CONST_ROW],null!=(n=this._getRowKeyForDataSourceRowIndex(i))&&(a.startKey={},a.startKey[C._CONST_ROW]=n)),null!=a.endKey&&null!=a.endKey[C._CONST_ROW]?(l=a.endKey[C._CONST_ROW],s=this._getDataSourceRowIndexForRowKey(l),a.endIndex={},a.endIndex[C._CONST_ROW]=s):null!=a.endIndex&&null!=a.endIndex[C._CONST_ROW]&&(s=a.endIndex[C._CONST_ROW],null!=(l=this._getRowKeyForDataSourceRowIndex(s))&&(a.endKey={},a.endKey[C._CONST_ROW]=l))}},C.prototype._processRowRangeSelection=function(e,t,o){var n,i,l,s,a,r,_=!0;if(null!=e.startKey&&null!=e.startKey[C._CONST_ROW]?(a=e.startKey[C._CONST_ROW],n=this._getDataSourceRowIndexForRowKey(a),isNaN(n)&&(_=void 0)):null!=e.startIndex&&null!=e.startIndex[C._CONST_ROW]&&(n=e.startIndex[C._CONST_ROW]),null!=e.endKey&&null!=e.endKey[C._CONST_ROW])r=e.endKey[C._CONST_ROW],null===(i=this._getDataSourceRowIndexForRowKey(r))&&this._isLoadMoreOnScroll()&&(i=this._getDataSourceLastFetchedRowIndex(),_=void 0);else if(null!=e.endIndex&&null!=e.endIndex[C._CONST_ROW]){i=e.endIndex[C._CONST_ROW];var h=this._getDataSourceLastFetchedRowIndex();this._isLoadMoreOnScroll()&&i>h&&(i=h,_=void 0)}if(void 0===n&&void 0===i)_=!1;else if(null!=n&&null!=i&&n<=i){a=this._getRowKeyForDataSourceRowIndex(n),r=this._getRowKeyForDataSourceRowIndex(i),l=this._getRowIdxForRowKey(a),s=this._getRowIdxForRowKey(r);for(var u=l;u<=s;u++){var c=this._getRowKeyForRowIdx(u);t=t.add([c])}o=o.clear()}else d.warn("Error: Cannot resolve row range in selection - \n start row key: "+a+"\n end row key: "+r+"\n start row index: "+n+"\n end row index: "+i),null!=a&&null!=r&&(t=(t=t.add([a])).add([r]),o=o.clear());return{status:_,rowKeySet:t,columnKeySet:o}},C.prototype._getDataSourceLastFetchedRowIndex=function(){var e=this._getTableBodyRows();if(e.length>0){var t=this._getData(),o=0;return this._isPagingModelDataProvider()&&(o=t.getStartItemIndex()),e.length+o-1}return 0},C.prototype._processColumnRangeSelection=function(e,t,o){var n,i,l,s,a=!0;if(null!=e.startKey&&null!=e.startKey[C._CONST_COLUMN]?(n=e.startKey[C._CONST_COLUMN],l=this._getColumnIdxForColumnKey(n)):null!=e.startIndex&&null!=e.startIndex[C._CONST_COLUMN]&&(l=e.startIndex[C._CONST_COLUMN]),null!=e.endKey&&null!=e.endKey[C._CONST_COLUMN]?(i=e.endKey[C._CONST_COLUMN],s=this._getColumnIdxForColumnKey(i)):null!=e.endIndex&&null!=e.endIndex[C._CONST_COLUMN]&&(s=e.endIndex[C._CONST_COLUMN]),void 0===l&&void 0===s)a=!1;else if(null!=l&&null!=s&&!isNaN(l)&&!isNaN(s)&&l<=s){for(var r=l;r<=s;r++){var _=this._getColumnKeyForColumnIdx(r);o=o.add([_])}t=t.clear()}else d.error("Error: Cannot resolve column range in selection - \n start column key: "+n+"\n end column key: "+i+"\n start column index: "+l+"\n end column index: "+s);return{status:a,rowKeySet:t,columnKeySet:o}},C.prototype._invalidateRangeSelection=function(){var e=this.option("selection");if(null!=e)for(var t=0;t<e.length;t++){var o,n,i=e[t];if(null!=i.startKey&&(o=i.startKey[C._CONST_ROW]),null!=i.endKey&&(n=i.endKey[C._CONST_ROW]),o!==n||void 0===o){var l=this.option("selected.row"),s=this._getRowSelectionFromKeySet(l);this.option("selection",s,{_context:{writeback:!0,internalSet:!0}});break}}},C.prototype._setSelected=function(e,t){if(this._selectionSet=t,null!=e){var o,n=this.option("selected");if(this._selectionSet?a.areKeySetsEqual(n.row,e.row)&&a.areKeySetsEqual(n.column,e.column)||(o=!0):n.row===e.row&&n.column===e.column||(o=!0),o&&(this.option("selected",e,{_context:{writeback:!0,internalSet:!0}}),this._isSelectionRequired()&&this._validatedSelectedRowKeyData))for(var i=this._validatedSelectedRowKeyData.length-1;i>=0;i--){var l=this._validatedSelectedRowKeyData[i];e.row.has(l.key)||this._validatedSelectedRowKeyData.splice(i,1)}this._isDefaultSelectorEnabled()&&this._updateSelector(e.row),this._applySelected(e);var s=null,r=this._getRowSelectionFromKeySet(e.row);if(null!=r&&r.length>0){var _=r[0];null!=_.startKey&&(s=_.startKey[C._CONST_ROW])}if(this._setFirstSelectedRow(s),!t){var d=this._getSelectionEquivalent(e);this.option("selection",d,{_context:{writeback:!0,internalSet:!0}})}}},C.prototype._setFirstSelectedRow=function(t){var o=this.option("firstSelectedRow");if(!e.KeyUtils.equals(t,o.key)){var n=null;if(null!=t){var i=this.getDataForVisibleRow(this._getRowIdxForRowKey(t));if(null!=i)n=i[C._CONST_DATA];else if(this._validatedSelectedRowKeyData)for(var l=0;l<this._validatedSelectedRowKeyData.length;l++){var s=this._validatedSelectedRowKeyData[l];if(e.KeyUtils.equals(t,s.key)){n=s.data;break}}}this.option("firstSelectedRow",{key:t,data:n},{_context:{writeback:!0,internalSet:!0}})}},C.prototype._getSelectedEquivalent=function(t){var o;if(null!=t){for(var n=(o={row:new e.KeySetImpl,column:new e.KeySetImpl}).row,i=o.column,l=t.length,s=0;s<l;s++){var a=t[s];if(null==a.startKey&&null==a[C._CONST_STARTINDEX]||null==a.endKey&&null==a[C._CONST_ENDINDEX])d.error("Error: Invalid range object in selection. Both start and end objects must be specified");else{var r=this._processRowRangeSelection(a,n,i);n=r.rowKeySet,i=r.columnKeySet,!1===r.status&&(!1===(r=this._processColumnRangeSelection(a,n,i)).status&&d.error("Error: Invalid range object"),n=r.rowKeySet,i=r.columnKeySet)}}o.row===n&&o.column===i||(o={row:n,column:i})}else o={row:new e.KeySetImpl,column:new e.KeySetImpl};return o},C.prototype._getSelectionEquivalent=function(e){var t=this._getRowSelectionFromKeySet(e.row);return t.length>0||t.inverted?t:(t=this._getColumnSelectionFromKeySet(e.column)).length>0||t.inverted?t:[]},C.prototype._getRowSelectionFromKeySet=function(e){var t=[];return(e.isAddAll()?e.deletedValues():e.values()).forEach(function(e){var o={startKey:{row:e},endKey:{row:e}},n=this._getDataSourceRowIndexForRowKey(e);!isNaN(n)&&n>=0&&(o.startIndex={row:n},o.endIndex={row:n}),t.push(o)},this),t.inverted=e.isAddAll(),t},C.prototype._getColumnSelectionFromKeySet=function(e){var t=[];return(e.isAddAll()?e.deletedValues():e.values()).forEach(function(e){var o={startKey:{column:e},endKey:{column:e}},n=this._getColumnIdxForColumnKey(e);n>=0&&(o.startIndex={column:n},o.endIndex={column:n}),t.push(o)},this),t.inverted=e.isAddAll(),t},C.prototype._applySelected=function(e){var t=e.row,o=e.column;if(this._getSelectedRowIdxs().forEach(function(e){var o=this._getTableBodyRow(e);t.has(this._getRowKey(o))||(this._applyRowSelection(e,o,!1),this._setLastRowSelection(e,!1))},this),this._isRowSelectionEnabled())if(t.isAddAll()){var n=this._getTableBodyRows();n.forEach(function(e,o){t.has(this._getRowKey(e))&&this._applyRowSelection(o,e,!0)},this);var i=n.length-1,l=this._getRowKeyForRowIdx(i);this._setLastRowSelection(i,t.has(l))}else t.values().forEach(function(e){var t=this._getRowIdxForRowKey(e);null!=t&&t>=0&&(this._applyRowSelection(t,this._getTableBodyRow(t),!0),this._setLastRowSelection(t,!0))},this);if(0===this._getSelectedRowIdxs().length&&this._removeTableBodyRowTouchSelectionAffordance(),this._getSelectedHeaderColumnIdxs().forEach(function(e){o.has(this._getColumnKeyForColumnIdx(e))||this._applyColumnSelection(e,!1)},this),this._isColumnSelectionEnabled())if(o.isAddAll()){var s=this._getTableHeaderColumns();s.forEach(function(e,t){o.has(this._getColumnKeyForColumnIdx(t))&&this._applyColumnSelection(t,!0)},this);var a=s.length-1,r=this._getColumnKeyForColumnIdx(a);this._setLastHeaderColumnSelection(a,o.has(r))}else o.values().forEach(function(e){var t=this._getColumnIdxForColumnKey(e);null!=t&&t>=0&&this._applyColumnSelection(t,!0)},this)},C.prototype._applyRowSelection=function(e,t,o){if(t.classList.contains(C.MARKER_STYLE_CLASSES._SELECTED)!==o){o?t.classList.add(C.MARKER_STYLE_CLASSES._SELECTED):t.classList.remove(C.MARKER_STYLE_CLASSES._SELECTED);var n=this.options.dnd.drag;n&&("rows"===n||n.rows)&&(t.draggable=o)}o?this._updateRowStateCellsClass(e,{hover:!1,focused:!1,selected:!0}):this._updateRowStateCellsClass(e,{selected:!1})},C.prototype._applyColumnSelection=function(e,t){this._setHeaderColumnState(e,{selected:t})},C.prototype._setLastRowSelection=function(e,t){this._lastSelectedRowIdxArray||(this._lastSelectedRowIdxArray=[]);for(var o=this._lastSelectedRowIdxArray.length,n=0;n<o;n++)if(this._lastSelectedRowIdxArray[n]===e){this._lastSelectedRowIdxArray.splice(n,1);break}t&&this._lastSelectedRowIdxArray.push(e)},C.prototype._setLastHeaderColumnSelection=function(e,t){this._lastSelectedColumnIdxArray||(this._lastSelectedColumnIdxArray=[]);for(var o=this._lastSelectedColumnIdxArray.length,n=0;n<o;n++)if(this._lastSelectedColumnIdxArray[n]===e){this._lastSelectedColumnIdxArray.splice(n,1);break}t&&this._lastSelectedColumnIdxArray.push(e)},C.prototype._handleSelectionGesture=function(t,o,n){var i=this.option("selected"),l=i.row,s=i.column;if(o){if(s=s.clear(),this._isRowSelectionEnabled()){var a=this._getRowSelectionMode(),r=this._getRowKeyForRowIdx(t);l=l.has(r)?!n&&this._getSelectedRowIdxs().length>1&&a===C._OPTION_SELECTION_MODES._MULTIPLE?new e.KeySetImpl([r]):l.delete([r]):n&&a===C._OPTION_SELECTION_MODES._MULTIPLE?l.add([r]):new e.KeySetImpl([r])}}else if(this._isColumnSelectionEnabled()){l=l.clear();var _=this._getColumnSelectionMode();if(t>-1){var d=this._getColumnKeyForColumnIdx(t);s=s.has(d)?!n&&this._getSelectedHeaderColumnIdxs().length>1&&_===C._OPTION_SELECTION_MODES._MULTIPLE?new e.KeySetImpl([d]):s.delete([d]):n&&_===C._OPTION_SELECTION_MODES._MULTIPLE?s.add([d]):new e.KeySetImpl([d])}}i.row===l&&i.column===s||(i={row:l,column:s},this._isSelectionRequiredSatisfied(i)&&this._setSelected(i))},C.prototype._handleMouseEnterSelection=function(e,t){if(this._isRowSelectionEnabled()){var o=this._getElementRowIdx(e);null!=this._mouseDownRowIdx&&null!=o&&this._mouseDownRowIdx!==o?(this._getRowSelectionMode()===C._OPTION_SELECTION_MODES._MULTIPLE?this._selectRange(this._mouseDownRowIdx,o,!0):this._selectRange(o,o,!0),o<this._mouseDownRowIdx?this._moveTableBodyRowTouchSelectionAffordanceTop(o):this._moveTableBodyRowTouchSelectionAffordanceBottom(o)):null!=o&&o===this._mouseDownRowIdx&&(t?(this._selectRange(o,o,!0),this._moveTableBodyRowTouchSelectionAffordanceTop(o),this._moveTableBodyRowTouchSelectionAffordanceBottom(o)):this._clearSelectedRows())}},C.prototype._selectRange=function(e,t,o){var n,i=this.option("selected"),l=i.row,s=i.column;if(o){if(s=s.clear(),this._isRowSelectionEnabled()){if(l=l.clear(),e<=t)for(n=e;n<=t;n++)l=l.add([this._getRowKeyForRowIdx(n)]);else for(n=e;n>=t;n--)l=l.add([this._getRowKeyForRowIdx(n)]);this._lastSelectedRowIdx=t}}else if(l=l.clear(),this._isColumnSelectionEnabled()){if(s=s.clear(),e<=t)for(n=e;n<=t;n++)s=s.add([this._getColumnKeyForColumnIdx(n)]);else for(n=e;n>=t;n--)s=s.add([this._getColumnKeyForColumnIdx(n)]);this._lastSelectedHeaderIdx=t}i.row===l&&i.column===s||(i={row:l,column:s},this._isSelectionRequiredSatisfied(i)&&this._setSelected(i))},C.prototype._getRowSelection=function(e){return this._getTableBodyRow(e).classList.contains(C.MARKER_STYLE_CLASSES._SELECTED)},C.prototype._getHeaderColumnSelection=function(e){return this._getTableHeaderColumn(e).classList.contains(C.MARKER_STYLE_CLASSES._SELECTED)},C.prototype._getSelectedRowIdxs=function(){return this._getRowIdxsForElementsWithStyleClass("."+C.CSS_CLASSES._TABLE_DATA_ROW_CLASS+"."+C.MARKER_STYLE_CLASSES._SELECTED)},C.prototype._getSelectedHeaderColumnIdxs=function(){return this._getColumnIdxsForElementsWithStyleClass("."+C.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS+"."+C.MARKER_STYLE_CLASSES._SELECTED)},C.prototype._clearSelectedRows=function(){this._selectionAnchorIdx=null,this._lastSelectedRowIdx=null;var e=this.option("selected.row"),t=e.clear();if(t!==e){var o={row:t,column:this.option("selected.column")};this._setSelected(o)}},C.prototype._clearSelectionState=function(){if(this._selectionAnchorIdx=null,this._lastSelectedRowIdx=null,this._lastSelectedHeaderIdx=null,this._hasSelected()){var t={row:new e.KeySetImpl,column:new e.KeySetImpl};this._setSelected(t)}},C.prototype._updateSelector=function(e){for(var t=this._getTable(),o=t.getElementsByClassName(C.CSS_CLASSES._TABLE_DATA_ROW_SELECTOR_CLASS),n=0;n<o.length;n++)o[n].selectedKeys=e;t.getElementsByClassName(C.CSS_CLASSES._TABLE_HEADER_SELECTOR_CLASS)[0].selectedKeys=e},C.prototype.version="1.0.0",C.prototype.defaultElement="<table>",C.prototype.widgetEventPrefix="oj",C.prototype.options={accessibility:null,animateStart:null,animateEnd:null,as:"",currentRow:null,data:null,display:"list",dnd:{drag:null,drop:null,reorder:{columns:"disabled"}},editMode:"none",editRow:{rowKey:null,rowIndex:-1},emptyText:null,horizontalGridVisible:"auto",rowRenderer:null,scrollPolicy:"auto",scrollPolicyOptions:{fetchSize:25,maxCount:500},scrollPosition:{x:0,y:0},firstSelectedRow:{key:null,data:null},selection:[],selected:{row:new e.KeySetImpl,column:new e.KeySetImpl},selectionMode:null,selectionRequired:!1,verticalGridVisible:"auto",columns:[{renderer:null,className:null,field:null,footerClassName:null,footerRenderer:null,footerStyle:null,footerTemplate:null,headerClassName:null,headerRenderer:null,headerStyle:null,headerTemplate:null,headerText:null,id:null,resizable:"disabled",sortable:"auto",sortProperty:null,style:null,template:null,width:null}],columnsDefault:{renderer:null,className:null,field:null,footerClassName:null,footerRenderer:null,footerStyle:null,footerTemplate:null,headerClassName:null,headerRenderer:null,headerStyle:null,headerTemplate:null,headerText:null,resizable:"disabled",sortable:"auto",sortProperty:null,style:null,template:null,width:null},beforeCurrentRow:null,beforeRowEdit:null,beforeRowEditEnd:null,ready:null,rowAction:null,sort:null},C.prototype.getContextByNode=function(e){var t=this.getSubIdByNode(e,!0);if(t&&"oj-table-cell"===t.subId){var o=t.rowIndex,n=this._getRowKeyForRowIdx(o);t.key=n}return t},C.prototype.getDataForVisibleRow=function(e){var o=this._getTableBodyRow(e);return null!=o?{key:t(o).data("rowKey"),data:t(o).data("rowData"),index:e}:null},C.prototype.getNodeBySubId=function(e){if(null==e)return this.element?this.element[0]:null;var t,o=e.subId;if("oj-table-cell"===o){var n=parseInt(e.rowIndex,10);return t=parseInt(e.columnIndex,10),this._getTableBodyLogicalCells(n)[t]}if("oj-table-header"===o||"oj-table-sort-ascending"===o||"oj-table-sort-descending"===o){t=e.index;var i=this._getTableHeaderLogicalColumns()[t];if(null!=i){if("oj-table-header"===o)return i;if("oj-table-sort-ascending"===o){var l=this._getTableElementsByClassName(i,C.CSS_CLASSES._COLUMN_HEADER_ASC_ICON_CLASS);if(l.length>0)return l[0]}else{var s=this._getTableElementsByClassName(i,C.CSS_CLASSES._COLUMN_HEADER_DSC_ICON_CLASS);if(s.length>0)return s[0]}}}else if("oj-table-footer"===o){t=e.index;var a=this._getTableFooterLogicalCells()[t];if(null!=a)return a}return null},C.prototype.getSubIdByNode=function(e,t){var o=this._getFirstAncestor(e,"."+C.CSS_CLASSES._TABLE_DATA_CELL_CLASS,!0);if(null!=o)return{subId:"oj-table-cell",rowIndex:this._getElementRowIdx(o),columnIndex:this._getElementColumnIdx(o)};var n=this._getFirstAncestor(e,"."+C.CSS_CLASSES._COLUMN_HEADER_ASC_ICON_CLASS,!0);if(null!=n)return{subId:t?"oj-table-header":"oj-table-sort-ascending",index:this._getElementColumnIdx(n)};var i=this._getFirstAncestor(e,"."+C.CSS_CLASSES._COLUMN_HEADER_DSC_ICON_CLASS,!0);if(null!=i)return{subId:t?"oj-table-header":"oj-table-sort-descending",index:this._getElementColumnIdx(i)};var l=this._getFirstAncestor(e,"."+C.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS,!0);if(null!=l)return{subId:"oj-table-header",index:this._getElementColumnIdx(l)};var s=this._getFirstAncestor(e,"."+C.CSS_CLASSES._TABLE_FOOTER_CELL_CLASS,!0);return null!=s?{subId:"oj-table-footer",index:this._getElementColumnIdx(s)}:null},C.prototype.refresh=function(){this._super(),this._refresh()},C.prototype.refreshRow=function(e){return this._refreshRow(e,!0)},C.prototype.widget=function(){var e=this._getTableContainer();return null!=e?t(e):this.element},C.prototype._ComponentCreate=function(){this._super(),this._initTemplateEngine(),this._draw(),this._registerCustomEvents(),this._on(this._events),this._isTouchDevice()&&this._registerTouchEvents(),this._registerDomEventListeners(),this._cachedOptions=t.extend(!0,{},this.options),this._setEditableRowIdx(null),a.disableDefaultBrowserStyling(this.element[0])},C.prototype._AfterCreate=function(){this._super(),this._createContextMenu(this._handleContextMenuSelect.bind(this)),this._isInitFetch=!0},C.prototype._SetupResources=function(){this._super(),this._registerResizeListener(),this._registerDataSourceEventListeners(),this._isInitFetch?(this._initFetch(),this._isInitFetch=!1):this._queueTask(function(){return this._invokeDataFetchRows()}.bind(this))},C.prototype._ReleaseResources=function(){this._super(),this._cleanComponent()},C.prototype._destroy=function(){this._cleanComponent(!0)},C.prototype._NotifyAttached=function(){this._super();var e=this._getTableContainer();this._refreshTableDimensions(e.offsetWidth,e.offsetHeight)},C.prototype._NotifyShown=function(){this._super();var e=this._getTableContainer();this._refreshTableDimensions(e.offsetWidth,e.offsetHeight)},C.prototype._VerifyConnectedForSetup=function(){return!0},C.prototype._GetDefaultContextMenu=function(){return this._defaultContextMenu},C.prototype._NotifyContextMenuGesture=function(e,t,o){var n={};if(this._contextMenuEvent=t.originalEvent,!(this._isNodeEditable(this._contextMenuEvent.target)||this._isNodeClickable(this._contextMenuEvent.target)||"touch"===o&&this._isNodeDraggable(this._contextMenuEvent.target))){var i,l=this._getFirstAncestor(this._contextMenuEvent.target,"."+C.CSS_CLASSES._TABLE_DATA_CELL_CLASS,!0);if(null!=l){var s=this._getElementColumnIdx(l);i=this._getTableHeaderColumn(s)}else i=this._getFirstAncestor(this._contextMenuEvent.target,"."+C.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS,!0);if("keydown"===this._contextMenuEvent.type){var a=this._getTable();if(null==i&&(i=this._getTableHeaderColumn(this._activeColumnIndex)),this._contextMenuEvent.target===a)if(null!=i)n.position={my:"start top",at:"start bottom",of:i};else{var r=this._getFocusedRowIdx();if(r>=0){var _=this._getTableBodyRow(r);n.position={my:"start top",at:"start bottom",of:_}}else n.position={my:"start top",at:"start bottom",of:this._contextMenuEvent.target}}else n.position={my:"start top",at:"start bottom",of:this._contextMenuEvent.target}}else{var d=this._getFirstAncestor(this._contextMenuEvent.target,"."+C.CSS_CLASSES._TABLE_FOOTER_CELL_CLASS,!0);if(null==i&&null==l&&null==d)return}this._contextMenuEventHeaderColumn=i;var h=e.element?e.element[0]:e,u=h.querySelectorAll("[data-oj-command=oj-table-sortAsc]");u.length>0&&(u=u[0],i&&i.getAttribute("data-oj-sortable")===C._OPTION_ENABLED?"OJ-OPTION"===u.nodeName?u.removeAttribute("disabled"):u.classList.remove("oj-disabled"):"OJ-OPTION"===u.nodeName?u.setAttribute("disabled","true"):u.classList.add("oj-disabled"));var c=h.querySelectorAll("[data-oj-command=oj-table-sortDsc]");c.length>0&&(c=c[0],i&&i.getAttribute("data-oj-sortable")===C._OPTION_ENABLED?"OJ-OPTION"===c.nodeName?c.removeAttribute("disabled"):c.classList.remove("oj-disabled"):"OJ-OPTION"===c.nodeName?c.setAttribute("disabled","true"):c.classList.add("oj-disabled"));var S=h.querySelectorAll("[data-oj-command=oj-table-resize]");S.length>0&&(S=S[0],i&&i.getAttribute("data-oj-resizable")===C._OPTION_ENABLED?"OJ-OPTION"===S.nodeName?S.removeAttribute("disabled"):S.classList.remove("oj-disabled"):"OJ-OPTION"===S.nodeName?S.setAttribute("disabled","true"):S.classList.add("oj-disabled")),this._OpenContextMenu(t,o,n)}},C.prototype._setOption=function(e,t){if("selection"===e)this._selectionSet=!0,this._syncRangeSelection(t),this._superApply(arguments),this._validateInitialSelectionState(!0);else if("selected"===e)this._selectionSet=!1,this._superApply(arguments),this._validateInitialSelectionState(!0);else if("currentRow"===e){this._setCurrentRow(t,null,!0)===C._CURRENT_ROW_STATUS._UPDATED&&this._superApply(arguments)}else if("scrollPosition"===e)this._syncScrollPosition(t);else if("editRow"===e)this._setEditRow(t);else{this._superApply(arguments),this._isTableRefreshNeeded(e,t)&&("columns"===e||"selectionMode"===e&&void 0!==t.row?(this._clearCachedMetadata(),this._refreshTableHeader()):"data"===e&&this._beforeDataRefresh(),this._refresh())}},C.prototype._CompareOptionValues=function(t,o,n){switch(t){case"columns":case"currentRow":return e.Object.compareValues(o,n);case"selection":return o&&void 0===o.inverted&&(o.inverted=!1),n&&void 0===n.inverted&&(n.inverted=!1),(!o||!n||o.inverted===n.inverted)&&e.Object.compareValues(o,n);case"selected":return a.areKeySetsEqual(o.row,n.row)&&a.areKeySetsEqual(o.column,n.column);default:return this._super(t,o,n)}},C.prototype._getTableDndContext=function(){return this._tableDndContext||(this._tableDndContext=new e.TableDndContext(this)),this._tableDndContext},e.__registerWidget("oj.ojTable",t.oj.baseComponent,new C),s.setDefaultOptions({ojTable:{display:s.createDynamicPropertyGetter(function(){return(l.parseJSONFromFontFamily("oj-table-option-defaults")||{}).display})}}),e.TableDndContext=function(e){this.component=e,this.Init()},e.Object.createSubclass(e.TableDndContext,e.Object,"oj.TableDndContext"),e.TableDndContext.prototype.Init=function(){e.TableDndContext.superclass.Init.call(this)},e.TableDndContext.prototype._addDragMarkerClass=function(e){this.component._getTableHeaderColumn(e).classList.add(C.MARKER_STYLE_CLASSES._DRAG),this.component._setTableColumnCellsClass(e,!0,C.MARKER_STYLE_CLASSES._DRAG)},e.TableDndContext.prototype._removeDragMarkerClass=function(){var e=this.component._getTableElementsByClassName(this.component._getTableHeader(),C.MARKER_STYLE_CLASSES._DRAG);if(null!=e&&e.length>0)for(var t=e.length,o=0;o<t;o++)e[o].classList.remove(C.MARKER_STYLE_CLASSES._DRAG);this.component._setTableColumnCellsClass(null,!1,C.MARKER_STYLE_CLASSES._DRAG)},e.TableDndContext.prototype._cloneTableContainer=function(e){var o,n=this.component._getTableElementsByTagName(e,C.DOM_ELEMENT._TBODY)[0],i=t(n).scrollLeft();o=e.cloneNode(!0);var l=this.component._getTableElementsByTagName(o,C.DOM_ELEMENT._TBODY,!0)[0];if(this.component._isDefaultSelectorEnabled()){var s=this.component._getTableElementsByClassName(o,C.CSS_CLASSES._TABLE_HEADER_SELECTOR_CLASS,!0)[0];s.selectedKeys=this.component.options.selected.row,s.selectionMode="all",this.component._getTableElementsByClassName(o,C.CSS_CLASSES._TABLE_DATA_ROW_SELECTOR_CLASS,!0).forEach(function(e){e.selectedKeys=this.component.options.selected.row}.bind(this))}if(o.style[C.CSS_PROP._BACKGROUND_COLOR]=C.CSS_VAL._TRANSPARENT,o.style[C.CSS_PROP._BORDER_COLOR]=C.CSS_VAL._TRANSPARENT,o.style[C.CSS_PROP._POSITION]=C.CSS_VAL._ABSOLUTE,this.component._isTableHeaderless())o.style[C.CSS_PROP._HEIGHT]=n.scrollHeight+C.CSS_VAL._PX;else{var a=this.component._getTableElementsByTagName(e,C.DOM_ELEMENT._THEAD)[0];o.style[C.CSS_PROP._HEIGHT]=n.scrollHeight+a.offsetHeight+C.CSS_VAL._PX}return o.style[C.CSS_PROP._TOP]=-1e4+C.CSS_VAL._PX,l.style[C.CSS_PROP._OVERFLOW]=C.CSS_VAL._HIDDEN,l.style[C.CSS_PROP._OVERFLOW_X]=C.CSS_VAL._HIDDEN,l.style[C.CSS_PROP._OVERFLOW_Y]=C.CSS_VAL._HIDDEN,l.style[C.CSS_PROP._BACKGROUND_COLOR]=C.CSS_VAL._TRANSPARENT,l.style[C.CSS_PROP._BORDER_COLOR]=C.CSS_VAL._TRANSPARENT,l.style[C.CSS_PROP._WIDTH]=t(n).width()+C.CSS_VAL._PX,l.style[C.CSS_PROP._HEIGHT]=n.scrollHeight+C.CSS_VAL._PX,document.body.appendChild(o),t(l).scrollLeft(1*i),o},e.TableDndContext.prototype._destroyDragImage=function(){this._dragImage&&(t(this._dragImage).remove(),this._dragImage=null)},e.TableDndContext.prototype._getEventColumnIndex=function(e){return this.component._getElementColumnIdx(e.currentTarget)},e.TableDndContext.prototype._getOverRowIndex=function(e){var o,n=this.component._getFirstAncestor(e.target,C.DOM_ELEMENT._TR,!0),i=this.component._getFirstAncestor(e.target,"."+C.CSS_CLASSES._TABLE_DATA_CELL_CLASS,!0);if(null!=i){var l=this.component._getFirstAncestor(i,"."+C.CSS_CLASSES._TABLE_DATA_ROW_CLASS,!0);null!=l&&(o=t(l).index())}else if(t(n).hasClass(C.CSS_CLASSES._TABLE_DATA_ROW_DRAG_INDICATOR_BEFORE_CLASS))o=this._dropRowIndex;else{o=this.component._getTableBodyRows().length}return o},e.TableDndContext.prototype.handleColumnDragStart=function(e){if(this._isColumnReorderEnabled()){var t=this._getEventColumnIndex(e);return this._dragStartColumnIdx=t,this._setReorderColumnsDataTransfer(e,t),this.component._clearSelectionState(),setTimeout(function(){window.getSelection().removeAllRanges()},0),this._addDragMarkerClass(t),!0}},e.TableDndContext.prototype.handleColumnDragEnd=function(e){this._isColumnReorderEnabled()&&(this.setTableHeaderColumnDraggable(null,!1),this._dragStartColumnIdx=null,this.component._removeDragOverIndicatorColumn(),this.component._removeTableHeaderColumnDragImage(),this._removeDragMarkerClass())},e.TableDndContext.prototype.handleColumnDragEnter=function(e){if(!this._isColumnReordering()){var t=this._getEventColumnIndex(e);return this._invokeDropCallback("columns","dragEnter",e,{columnIndex:t})}},e.TableDndContext.prototype.handleColumnReorderDragOver=function(e){var t=this._getEventColumnIndex(e),o=this._dragStartColumnIdx;null!=o&&o!==t&&(this._currentDropColumnBefore=this._isDragOverBeforeColumn(e),this._currentDropColumnBefore&&o===t-1||!this._currentDropColumnBefore&&o===t+1||this.component._displayDragOverIndicatorColumn(t,this._currentDropColumnBefore),e.preventDefault())},e.TableDndContext.prototype.handleColumnDragOver=function(e){if(this._isColumnReordering())return this.handleColumnReorderDragOver(e);var t=this._getEventColumnIndex(e);this._currentDropColumnBefore=this._isDragOverBeforeColumn(e);var o=this._invokeDropCallback("columns","dragOver",e,{columnIndex:t});return(!1===o||e.isDefaultPrevented())&&this.component._displayDragOverIndicatorColumn(t,this._isDragOverBeforeColumn(e)),o},e.TableDndContext.prototype.handleColumnDragLeave=function(e){if(!this._isColumnReordering()){this.component._removeDragOverIndicatorColumn();var t=this._getEventColumnIndex(e);return this._invokeDndCallback("drop","columns","dragLeave",e,{columnIndex:t})}},e.TableDndContext.prototype.handleColumnReorderDrop=function(e){this.component._removeDragOverIndicatorColumn();var t=this._getEventColumnIndex(e);this._currentDropColumnBefore||(t+=1),this.component._columnsDestMap=this.component._moveTableHeaderColumn(this._dragStartColumnIdx,t,e),e.preventDefault()},e.TableDndContext.prototype.handleColumnDrop=function(e){if(this._isColumnReordering())return this.handleColumnReorderDrop(e);this.component._removeDragOverIndicatorColumn();var t=this._getEventColumnIndex(e);return this._currentDropColumnBefore||(t+=1),this._invokeDropCallback("columns","drop",e,{columnIndex:t})},e.TableDndContext.prototype.handleRowDragStart=function(e){var t=this.component.options.dnd.drag;if(t&&t.rows){var o=this._setDragRowsDataTransfer(e,t.rows.dataTypes,this.component._getSelectedRowIdxs());return!!o&&this._invokeDndCallback("drag","rows","dragStart",e,o)}},e.TableDndContext.prototype.handleRowDrag=function(e){return this._invokeDndCallback("drag","rows","drag",e)},e.TableDndContext.prototype.handleRowDragEnd=function(e){return this._destroyDragImage(),this.component._removeDragOverIndicatorRow(),this._invokeDndCallback("drag","rows","dragEnd",e)},e.TableDndContext.prototype.handleRowDragEnter=function(e){var t=this._getOverRowIndex(e),o=this._invokeDropCallback("rows","dragEnter",e,{rowIndex:t});return(!1===o||e.isDefaultPrevented())&&this._updateDragRowsState(e,t),o},e.TableDndContext.prototype.handleRowDragOver=function(e){return this._invokeDropCallback("rows","dragOver",e,{rowIndex:this._dropRowIndex})},e.TableDndContext.prototype.handleRowDragLeave=function(e){var t=this._invokeDndCallback("drop","rows","dragLeave",e,{rowIndex:this._dropRowIndex});return this._isDndEventInElement(e,e.currentTarget)||(this.component._removeDragOverIndicatorRow(),this._dropRowIndex=null),t},e.TableDndContext.prototype.handleRowDrop=function(e){var t=this._dropRowIndex;return this._destroyDragImage(),this.component._removeDragOverIndicatorRow(),this._dropRowIndex=null,this._invokeDropCallback("rows","drop",e,{rowIndex:t})},e.TableDndContext.prototype._hideUnselectedRows=function(e,t,o){var n,i,l=null,s=this.component._getTableElementsByClassName(e,C.CSS_CLASSES._TABLE_DATA_ROW_CLASS,!0);for(n=s.length-1;n>=0;n--){var a=s[n],r=t.indexOf(n);if(-1===r){a.style[C.CSS_PROP._VISIBILITY]=C.CSS_VAL._HIDDEN,a.style[C.CSS_PROP._BORDER_COLOR]=C.CSS_VAL._TRANSPARENT;var _=this.component._getTableElementsByClassName(a,C.CSS_CLASSES._TABLE_DATA_CELL_CLASS,!0);for(i=0;i<_.length;i++)_[i].style[C.CSS_PROP._BORDER_COLOR]=C.CSS_VAL._TRANSPARENT}else{if(l=n,this.component._isDefaultSelectorEnabled())a.querySelectorAll("."+C.CSS_CLASSES._TABLE_DATA_ROW_SELECTOR_CLASS)[0].rowKey=o[r].key}}var d=this.component._getTableElementsByTagName(e,C.DOM_ELEMENT._THEAD,!0);if(null!=d&&d.length>0){d[0].style[C.CSS_PROP._VISIBILITY]=C.CSS_VAL._HIDDEN,d[0].style[C.CSS_PROP._BORDER_COLOR]=C.CSS_VAL._TRANSPARENT;var h=this.component._getTableElementsByClassName(d[0],C.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS,!0);for(n=0;n<h.length;n++)h[n].style[C.CSS_PROP._BORDER_COLOR]=C.CSS_VAL._TRANSPARENT}var u=this.component._getTableElementsByTagName(e,C.DOM_ELEMENT._TFOOT,!0);return null!=u&&u.length>0&&(u[0].style[C.CSS_PROP._VISIBILITY]=C.CSS_VAL._HIDDEN),l},e.TableDndContext.prototype._invokeDndCallback=function(e,t,o,n,i){var l,s=this.component.options.dnd[e];if(s&&s[t]){var a=s[t][o];if(a&&"function"==typeof a)try{this.component._IsCustomElement()?a(n.originalEvent,i):(n.dataTransfer=n.originalEvent.dataTransfer,l=a(n,i))}catch(e){d.error("Error: "+e)}}return l},e.TableDndContext.prototype._invokeDropCallback=function(e,t,o,n){var i=this._invokeDndCallback("drop",e,t,o,n);return void 0===i&&this._matchDragDataType(o,e)&&o.preventDefault(),i},e.TableDndContext.prototype._isColumnReorderEnabled=function(){var e=this.component.options.dnd;return e&&e.reorder&&e.reorder.columns===C._OPTION_ENABLED},e.TableDndContext.prototype._isColumnReordering=function(){return null!=this._dragStartColumnIdx},e.TableDndContext.prototype._isDndEventInElement=function(e,t){var o=t.getBoundingClientRect(),n=e.originalEvent;return n.clientX>=Math.ceil(o.left)&&n.clientX<Math.floor(o.right)&&n.clientY>=Math.ceil(o.top)&&n.clientY<Math.floor(o.bottom)},e.TableDndContext.prototype._isDragOverBeforeColumn=function(t){var o=t.currentTarget.getBoundingClientRect();if(null!=t.originalEvent.clientX){var n=o.right-t.originalEvent.clientX<(o.right-o.left)/2;return"rtl"===e.DomUtils.getReadingDirection()?n:!n}return!1},e.TableDndContext.prototype._matchDragDataType=function(e,t){var o=e.originalEvent.dataTransfer.types,n=this.component.options.dnd.drop;if(n&&n[t]&&n[t].dataTypes)for(var i=n[t].dataTypes,l="string"==typeof i?[i]:i,s=0;s<o.length;s++)if(l.indexOf(o[s])>=0)return!0;return!1},e.TableDndContext.prototype._setHeaderColumnDraggable=function(e,t){e.draggable=t,t&&(e.style[C.CSS_PROP._CURSOR]=C.CSS_VAL._MOVE,e.classList.add(C.MARKER_STYLE_CLASSES._DRAGGABLE))},e.TableDndContext.prototype._clearHeaderColumnDraggable=function(e){e.draggable="",e.style[C.CSS_PROP._CURSOR]=C.CSS_VAL._AUTO,e.classList.remove(C.MARKER_STYLE_CLASSES._DRAGGABLE)},e.TableDndContext.prototype._setDragRowsData=function(e,t,o){if(t){var n=e.dataTransfer,i=JSON.stringify(o);if("string"==typeof t)n.setData(t,i);else for(var l=0;l<t.length;l++)n.setData(t[l],i)}},e.TableDndContext.prototype._setDragRowsDataTransfer=function(e,o,n){for(var i=[],l=0;l<n.length;l++){var s=this.component.getDataForVisibleRow(n[l]);s&&i.push(s)}return i.length?(this._setDragRowsData(e.originalEvent,o,i),this._destroyDragImage(),this._dragImage=this._setDragRowsImage(e.originalEvent,t(this.component._getFirstAncestor(e.currentTarget,C.DOM_ELEMENT._TABLE,!0)).parent()[0],n,i),{rows:i}):null},e.TableDndContext.prototype._setDragRowsImage=function(e,o,n,i){var l=this._cloneTableContainer(o);this._hideUnselectedRows(l,n,i);var s=o.getBoundingClientRect(),a=this.component._getTableElementsByTagName(o,C.DOM_ELEMENT._TBODY)[0],r=t(a).scrollLeft(),_=t(a).scrollTop(),d=e.clientX-s.left+r,h=e.clientY-s.top+_;return e.dataTransfer.setDragImage(l,d,h),l},e.TableDndContext.prototype._setReorderColumnsDataTransfer=function(e,t){var o=e.originalEvent.dataTransfer,n=this.component._hashCode(this.component._getTableUID());o.setData("Text",C._DND_REORDER_TABLE_ID_DATA_KEY+":"+n+":"+t);var i=this.component._createTableHeaderColumnDragImage(t);try{o.setDragImage(i,0,0)}catch(e){}},e.TableDndContext.prototype.setTableHeaderColumnDraggable=function(e,t){if(this._isColumnReorderEnabled()){var o,n=this.component._getTableHeaderColumns();if(null!=n&&n.length>0)for(o=0;o<n.length;o++){var i=n[o];null!=e&&o===e?this._setHeaderColumnDraggable(i,t):this._clearHeaderColumnDraggable(i)}}},e.TableDndContext.prototype._updateDragRowsState=function(e,t){if(this._dropRowIndex!==t){var o=this.component._getFirstAncestor(e.target,C.DOM_ELEMENT._TR,!0);this._dropRowIndex=t,this.component._displayDragOverIndicatorRow(this._dropRowIndex,!0,o)}},S.extension._WIDGET_NAME="ojTable",S.extension._INNER_ELEM="table",e.CustomElementBridge.register("oj-table",{metadata:S})});